var catchUpActivity=(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[8],{1409:function(t,e,n){var i=n(1410),r=n(862);"string"==typeof i&&(i=[[t.i,i]]);for(var a=0;a<i.length;a++)r.loadStyles(i[a][1],!1);i.locals&&(t.exports=i.locals)},1410:function(t,e,n){(e=n(861)(!1)).push([t.i,"svg > path.OfficeIconColors_m20 { fill : rgba(250, 250, 250, 1.000); }\r\nsvg > path.OfficeIconColors_m21 { fill : rgba(200, 198, 196, 1.000); }\r\nsvg > path.OfficeIconColors_m22 { fill : rgba(58, 58, 56, 1.000); }\r\nsvg > path.OfficeIconColors_m23 { fill : rgba(121, 119, 116, 1.000); }\r\nsvg > path.OfficeIconColors_m24 { fill : rgba(30, 139, 205, 1.000); }\r\nsvg > path.OfficeIconColors_m25 { fill : rgba(0, 99, 177, 1.000); }\r\nsvg > path.OfficeIconColors_m26 { fill : rgba(131, 190, 236, 1.000); }\r\nsvg > path.OfficeIconColors_m27 { fill : rgba(55, 158, 78, 1.000); }\r\nsvg > path.OfficeIconColors_m28 { fill : rgba(48, 144, 72, 1.000); }\r\nsvg > path.OfficeIconColors_m29 { fill : rgba(161, 221, 170, 1.000); }\r\nsvg > path.OfficeIconColors_m210 { fill : rgba(222, 108, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m211 { fill : rgba(222, 108, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m212 { fill : rgba(248, 219, 143, 1.000); }\r\nsvg > path.OfficeIconColors_m213 { fill : rgba(237, 61, 59, 1.000); }\r\nsvg > path.OfficeIconColors_m214 { fill : rgba(212, 35, 20, 1.000); }\r\nsvg > path.OfficeIconColors_m215 { fill : rgba(255, 145, 152, 1.000); }\r\nsvg > path.OfficeIconColors_m216 { fill : rgba(255, 103, 45, 1.000); }\r\nsvg > path.OfficeIconColors_m217 { fill : rgba(232, 75, 18, 1.000); }\r\nsvg > path.OfficeIconColors_m218 { fill : rgba(255, 178, 85, 1.000); }\r\nsvg > path.OfficeIconColors_m219 { fill : rgba(168, 70, 178, 1.000); }\r\nsvg > path.OfficeIconColors_m220 { fill : rgba(146, 46, 155, 1.000); }\r\nsvg > path.OfficeIconColors_m221 { fill : rgba(212, 146, 216, 1.000); }\r\nsvg > path.OfficeIconColors_m222 { fill : rgba(255, 255, 255, 0.400); }\r\nsvg > path.OfficeIconColors_m223 { fill : rgba(131, 190, 236, 1.000); }\r\nsvg > path.OfficeIconColors_m224 { fill : rgba(0, 99, 177, 1.000); }\r\nsvg > path.OfficeIconColors_m225 { fill : rgba(234, 222, 204, 1.000); }\r\nsvg > path.OfficeIconColors_m226 { fill : rgba(112, 95, 83, 1.000); }\r\nsvg > path.OfficeIconColors_m227 { fill : rgba(255, 255, 255, 1.000); }\r\nsvg > path.OfficeIconColors_m228 { fill : rgba(0, 126, 229, 1.000); }\r\nsvg > path.OfficeIconColors_m229 { fill : rgba(216, 59, 1, 1.000); }\r\nsvg > path.OfficeIconColors_m230 { fill : rgba(8, 73, 177, 1.000); }\r\nsvg > path.OfficeIconColors_m231 { fill : rgba(0, 120, 215, 1.000); }\r\nsvg > path.OfficeIconColors_m232 { fill : rgba(125, 163, 198, 1.000); }\r\nsvg > path.OfficeIconColors_m233 { fill : rgba(43, 87, 154, 1.000); }\r\nsvg > path.OfficeIconColors_m234 { fill : rgba(183, 71, 42, 1.000); }\r\nsvg > path.OfficeIconColors_m235 { fill : rgba(237, 149, 131, 1.000); }\r\nsvg > path.OfficeIconColors_m236 { fill : rgba(33, 115, 70, 1.000); }\r\nsvg > path.OfficeIconColors_m237 { fill : rgba(110, 179, 138, 1.000); }\r\nsvg > path.OfficeIconColors_m238 { fill : rgba(119, 25, 170, 1.000); }\r\nsvg > path.OfficeIconColors_m239 { fill : rgba(221, 197, 236, 1.000); }\r\nsvg > path.OfficeIconColors_m240 { fill : rgba(255, 0, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m241 { fill : rgba(255, 255, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m242 { fill : rgba(0, 255, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m243 { fill : rgba(0, 255, 255, 1.000); }\r\nsvg > path.OfficeIconColors_m244 { fill : rgba(255, 0, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m245 { fill : rgba(255, 128, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m246 { fill : rgba(87, 210, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m247 { fill : rgba(49, 101, 187, 1.000); }\r\nsvg > path.OfficeIconColors_m248 { fill : rgba(150, 150, 150, 1.000); }\r\nsvg > path.OfficeIconColors_m249 { fill : rgba(121, 121, 121, 1.000); }\r\nsvg > path.OfficeIconColors_m250 { fill : rgba(179, 179, 179, 1.000); }\r\nsvg > path.OfficeIconColors_m251 { fill : rgba(255, 0, 255, 1.000); }\r\nsvg > path.OfficeIconColors_m252 { fill : rgba(0, 0, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m253 { fill : rgba(159, 205, 179, 1.000); }\r\nsvg > path.OfficeIconColors_m254 { fill : rgba(2, 132, 132, 1.000); }\r\nsvg > path.OfficeIconColors_m255 { fill : rgba(59, 89, 152, 1.000); }\r\nsvg > path.OfficeIconColors_m256 { fill : rgba(29, 161, 242, 1.000); }\r\nsvg > path.OfficeIconColors_m257 { fill : rgba(221, 75, 57, 1.000); }\r\nsvg > path.OfficeIconColors_m258 { fill : rgba(53, 70, 93, 1.000); }\r\nsvg > path.OfficeIconColors_m259 { fill : rgba(70, 67, 66, 1.000); }\r\nsvg > path.OfficeIconColors_m260 { fill : rgba(189, 8, 28, 1.000); }\r\nsvg > path.OfficeIconColors_m261 { fill : rgba(0, 119, 181, 1.000); }\r\nsvg > path.OfficeIconColors_m262 { fill : rgba(255, 69, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m263 { fill : rgba(0, 131, 114, 1.000); }\r\nsvg > path.OfficeIconColors_m264 { fill : rgba(0, 120, 215, 1.000); }\r\nsvg > path.OfficeIconColors_m265 { fill : rgba(0, 99, 219, 1.000); }\r\nsvg > path.OfficeIconColors_m266 { fill : rgba(255, 0, 132, 1.000); }\r\nsvg > path.OfficeIconColors_m267 { fill : rgba(205, 32, 31, 1.000); }\r\nsvg > path.OfficeIconColors_m268 { fill : rgba(255, 0, 170, 1.000); }\r\nsvg > path.OfficeIconColors_m269 { fill : rgba(245, 125, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m270 { fill : rgba(0, 191, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m271 { fill : rgba(230, 230, 230, 1.000); }\r\nsvg > path.OfficeIconColors_m272 { fill : rgba(90, 90, 90, 1.000); }\r\nsvg > path.OfficeIconColors_m273 { fill : rgba(244, 132, 11, 1.000); }\r\nsvg > path.OfficeIconColors_m274 { fill : rgba(255, 22, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m275 { fill : rgba(147, 61, 193, 1.000); }\r\nsvg > path.OfficeIconColors_m276 { fill : rgba(0, 191, 255, 1.000); }\r\nsvg > path.OfficeIconColors_m277 { fill : rgba(181, 216, 42, 1.000); }\r\nsvg > path.OfficeIconColors_m278 { fill : rgba(242, 216, 13, 1.000); }\r\nsvg > path.OfficeIconColors_m279 { fill : rgba(212, 0, 120, 1.000); }\r\nsvg > path.OfficeIconColors_m280 { fill : rgba(250, 189, 20, 1.000); }\r\nsvg > path.OfficeIconColors_m281 { fill : rgba(15, 137, 62, 1.000); }\r\nsvg > path.OfficeIconColors_m282 { fill : rgba(0, 78, 140, 1.000); }\r\nsvg > path.OfficeIconColors_m283 { fill : rgba(172, 0, 140, 1.000); }\r\nsvg > path.OfficeIconColors_m284 { fill : rgba(247, 99, 13, 1.000); }\r\nsvg > path.OfficeIconColors_m285 { fill : rgba(232, 17, 35, 1.000); }\r\nsvg > path.OfficeIconColors_m286 { fill : rgba(0, 182, 193, 1.000); }\r\nsvg > path.OfficeIconColors_m287 { fill : rgba(0, 99, 175, 1.000); }\r\nsvg > path.OfficeIconColors_m288 { fill : rgba(91, 45, 144, 1.000); }\r\nsvg > path.OfficeIconColors_m289 { fill : rgba(198, 164, 119, 1.000); }\r\nsvg > path.OfficeIconColors_m290 { fill : rgba(126, 197, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m291 { fill : rgba(0, 172, 86, 1.000); }\r\nsvg > path.OfficeIconColors_m292 { fill : rgba(0, 153, 187, 1.000); }\r\nsvg > path.OfficeIconColors_m293 { fill : rgba(193, 0, 81, 1.000); }\r\nsvg > path.OfficeIconColors_m294 { fill : rgba(132, 147, 154, 1.000); }\r\nsvg > path.OfficeIconColors_m295 { fill : rgba(16, 110, 190, 1.000); }\r\nsvg > path.OfficeIconColors_m296 { fill : rgba(238, 49, 36, 1.000); }\r\nsvg > path.OfficeIconColors_m297 { fill : rgba(220, 234, 245, 1.000); }\r\nsvg > path.OfficeIconColors_m298 { fill : rgba(198, 223, 243, 1.000); }\r\nsvg > path.OfficeIconColors_m299 { fill : rgba(176, 212, 241, 1.000); }\r\nsvg > path.OfficeIconColors_m2100 { fill : rgba(154, 201, 238, 1.000); }\r\nsvg > path.OfficeIconColors_m2101 { fill : rgba(131, 190, 236, 1.000); }\r\nsvg > path.OfficeIconColors_m2102 { fill : rgba(96, 172, 225, 1.000); }\r\nsvg > path.OfficeIconColors_m2103 { fill : rgba(61, 155, 214, 1.000); }\r\nsvg > path.OfficeIconColors_m2104 { fill : rgba(27, 134, 202, 1.000); }\r\nsvg > path.OfficeIconColors_m2105 { fill : rgba(26, 110, 189, 1.000); }\r\nsvg > path.OfficeIconColors_m2106 { fill : rgba(255, 255, 255, 1.000); }\r\nsvg > path.OfficeIconColors_m2107 { fill : rgba(0, 164, 255, 1.000); }\r\nsvg > path.OfficeIconColors_m2108 { fill : rgba(0, 0, 0, 0.498); }\r\nsvg > path.OfficeIconColors_m2109 { fill : rgba(255, 255, 255, 0.400); }\r\nsvg > path.OfficeIconColors_m2110 { fill : rgba(255, 255, 255, 0.298); }\r\nsvg > path.OfficeIconColors_m2111 { fill : rgba(255, 255, 255, 0.498); }\r\nsvg > path.OfficeIconColors_m2112 { fill : rgba(0, 0, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m2113 { fill : rgba(164, 55, 58, 1.000); }\r\nsvg > path.OfficeIconColors_m2114 { fill : rgba(49, 117, 47, 1.000); }\r\nsvg > path.OfficeIconColors_m2115 { fill : rgba(7, 117, 104, 1.000); }\r\nsvg > path.OfficeIconColors_m2116 { fill : rgba(57, 85, 163, 1.000); }\r\nsvg > path.OfficeIconColors_m2117 { fill : rgba(142, 166, 221, 1.000); }\r\nsvg > path.OfficeIconColors_m2118 { fill : rgba(0, 161, 224, 1.000); }\r\nsvg > path.OfficeIconColors_m2119 { fill : rgba(0, 32, 80, 1.000); }\r\nsvg > path.OfficeIconColors_m2120 { fill : rgba(255, 239, 156, 1.000); }\r\nsvg > path.OfficeIconColors_m2121 { fill : rgba(99, 138, 198, 1.000); }\r\nsvg > path.OfficeIconColors_m2122 { fill : rgba(99, 138, 198, 0.247); }\r\nsvg > path.OfficeIconColors_m2123 { fill : rgba(99, 190, 123, 1.000); }\r\nsvg > path.OfficeIconColors_m2124 { fill : rgba(99, 190, 123, 0.247); }\r\nsvg > path.OfficeIconColors_m2125 { fill : rgba(255, 85, 90, 1.000); }\r\nsvg > path.OfficeIconColors_m2126 { fill : rgba(255, 85, 90, 0.247); }\r\nsvg > path.OfficeIconColors_m2127 { fill : rgba(255, 182, 40, 1.000); }\r\nsvg > path.OfficeIconColors_m2128 { fill : rgba(0, 138, 239, 1.000); }\r\nsvg > path.OfficeIconColors_m2129 { fill : rgba(214, 0, 123, 1.000); }\r\nsvg > path.OfficeIconColors_m2130 { fill : rgba(237, 125, 49, 1.000); }\r\nsvg > path.OfficeIconColors_m2131 { fill : rgba(16, 124, 16, 1.000); }\r\nsvg > path.OfficeIconColors_m2132 { fill : rgba(195, 0, 82, 1.000); }\r\nsvg > path.OfficeIconColors_m2133 { fill : rgba(156, 0, 65, 1.000); }\r\nsvg > path.OfficeIconColors_m2134 { fill : rgba(247, 191, 160, 1.000); }\r\nsvg > path.OfficeIconColors_m2135 { fill : rgba(162, 211, 160, 1.000); }\r\nsvg > path.OfficeIconColors_m2136 { fill : rgba(159, 205, 199, 1.000); }\r\nsvg > path.OfficeIconColors_m2137 { fill : rgba(212, 146, 216, 0.298); }\r\nsvg > path.OfficeIconColors_m2138 { fill : rgba(0, 174, 205, 1.000); }\r\nsvg > path.OfficeIconColors_m2139 { fill : rgba(66, 133, 241, 1.000); }\r\nsvg > path.OfficeIconColors_m2140 { fill : rgba(50, 166, 81, 1.000); }\r\nsvg > path.OfficeIconColors_m2141 { fill : rgba(251, 190, 5, 1.000); }\r\nsvg > path.OfficeIconColors_m2142 { fill : rgba(234, 66, 53, 1.000); }\r\nsvg > path.OfficeIconColors_m2143 { fill : rgba(212, 146, 216, 0.600); }\r\nsvg > path.OfficeIconColors_m2144 { fill : rgba(1, 130, 188, 1.000); }\r\nsvg > path.OfficeIconColors_m2145 { fill : rgba(49, 47, 98, 1.000); }\r\nsvg > path.OfficeIconColors_m2146 { fill : rgba(124, 188, 49, 1.000); }\r\nsvg > path.OfficeIconColors_m2147 { fill : rgba(250, 250, 250, 1.000); }\r\nsvg > path.OfficeIconColors_m2148 { fill : rgba(58, 58, 56, 1.000); }\r\nsvg > path.OfficeIconColors_m2149 { fill : rgba(121, 119, 116, 1.000); }\r\nsvg > path.OfficeIconColors_m2150 { fill : rgba(240, 125, 136, 1.000); }\r\nsvg > path.OfficeIconColors_m2151 { fill : rgba(85, 171, 229, 1.000); }\r\nsvg > path.OfficeIconColors_m2152 { fill : rgba(95, 190, 125, 1.000); }\r\nsvg > path.OfficeIconColors_m2153 { fill : rgba(185, 192, 203, 1.000); }\r\nsvg > path.OfficeIconColors_m2154 { fill : rgba(255, 140, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m2155 { fill : rgba(51, 186, 177, 1.000); }\r\nsvg > path.OfficeIconColors_m2156 { fill : rgba(163, 179, 103, 1.000); }\r\nsvg > path.OfficeIconColors_m2157 { fill : rgba(168, 149, 226, 1.000); }\r\nsvg > path.OfficeIconColors_m2158 { fill : rgba(2, 104, 2, 1.000); }\r\nsvg > path.OfficeIconColors_m2159 { fill : rgba(255, 241, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m2160 { fill : rgba(85, 88, 175, 1.000); }\r\nsvg > path.OfficeIconColors_m2161 { fill : rgba(128, 0, 128, 1.000); }\r\nsvg > path.OfficeIconColors_m2162 { fill : rgba(255, 145, 152, 0.247); }\r\nsvg > path.OfficeIconColors_m2163 { fill : rgba(104, 33, 122, 1.000); }\r\nsvg > path.OfficeIconColors_m2164 { fill : rgba(43, 44, 51, 1.000); }\r\nsvg > path.OfficeIconColors_m2165 { fill : rgba(0, 167, 233, 1.000); }\r\nsvg > path.OfficeIconColors_m2166 { fill : rgba(0, 151, 157, 1.000); }\r\nsvg > path.OfficeIconColors_m2167 { fill : rgba(251, 209, 21, 1.000); }\r\nsvg > path.OfficeIconColors_m2168 { fill : rgba(0, 107, 255, 1.000); }\r\nsvg > path.OfficeIconColors_m2169 { fill : rgba(35, 24, 64, 1.000); }\r\nsvg > path.OfficeIconColors_m2170 { fill : rgba(158, 139, 252, 1.000); }\r\nsvg > path.OfficeIconColors_m2171 { fill : rgba(243, 233, 255, 1.000); }\r\nsvg > path.OfficeIconColors_m2172 { fill : rgba(255, 255, 255, 0.298); }\r\nsvg > path.OfficeIconColors_m2173 { fill : rgba(58, 58, 56, 1.000); }\r\nsvg > path.OfficeIconColors_m2174 { fill : rgba(121, 119, 116, 1.000); }\r\nsvg > path.OfficeIconColors_m2175 { fill : rgba(0, 0, 0, 0.349); }\r\nsvg > path.OfficeIconColors_m2176 { fill : rgba(255, 255, 255, 0.498); }\r\nsvg > path.OfficeIconColors_m2177 { fill : rgba(167, 220, 213, 1.000); }\r\nsvg > path.OfficeIconColors_m2178 { fill : rgba(50, 148, 148, 1.000); }\r\nsvg > path.OfficeIconColors_m2179 { fill : rgba(0, 128, 133, 1.000); }\r\nsvg > path.OfficeIconColors_m2180 { fill : rgba(144, 227, 227, 1.000); }\r\nsvg > path.OfficeIconColors_m2181 { fill : rgba(255, 255, 255, 1.000); }\r\nsvg > path.OfficeIconColors_m2182 { fill : rgba(0, 0, 0, 0.047); }\r\nsvg > path.OfficeIconColors_m2183 { fill : rgba(0, 0, 0, 0.098); }\r\nsvg > path.OfficeIconColors_m2184 { fill : rgba(0, 0, 0, 0.200); }\r\nsvg > path.OfficeIconColors_m2185 { fill : rgba(0, 0, 0, 0.498); }\r\nsvg > path.OfficeIconColors_m2186 { fill : rgba(0, 0, 0, 0.753); }\r\nsvg > path.OfficeIconColors_m2187 { fill : rgba(65, 165, 238, 1.000); }\r\nsvg > path.OfficeIconColors_m2188 { fill : rgba(43, 124, 211, 1.000); }\r\nsvg > path.OfficeIconColors_m2189 { fill : rgba(24, 90, 189, 1.000); }\r\nsvg > path.OfficeIconColors_m2190 { fill : rgba(16, 63, 145, 1.000); }\r\nsvg > path.OfficeIconColors_m2191 { fill : rgba(22, 56, 112, 1.000); }\r\nsvg > path.OfficeIconColors_m2192 { fill : rgba(51, 196, 129, 1.000); }\r\nsvg > path.OfficeIconColors_m2193 { fill : rgba(33, 163, 102, 1.000); }\r\nsvg > path.OfficeIconColors_m2194 { fill : rgba(16, 124, 65, 1.000); }\r\nsvg > path.OfficeIconColors_m2195 { fill : rgba(24, 92, 55, 1.000); }\r\nsvg > path.OfficeIconColors_m2196 { fill : rgba(19, 74, 44, 1.000); }\r\nsvg > path.OfficeIconColors_m2197 { fill : rgba(255, 143, 107, 1.000); }\r\nsvg > path.OfficeIconColors_m2198 { fill : rgba(237, 108, 71, 1.000); }\r\nsvg > path.OfficeIconColors_m2199 { fill : rgba(211, 82, 48, 1.000); }\r\nsvg > path.OfficeIconColors_m2200 { fill : rgba(196, 62, 28, 1.000); }\r\nsvg > path.OfficeIconColors_m2201 { fill : rgba(153, 49, 23, 1.000); }\r\nsvg > path.OfficeIconColors_m2202 { fill : rgba(202, 100, 234, 1.000); }\r\nsvg > path.OfficeIconColors_m2203 { fill : rgba(174, 75, 213, 1.000); }\r\nsvg > path.OfficeIconColors_m2204 { fill : rgba(147, 50, 191, 1.000); }\r\nsvg > path.OfficeIconColors_m2205 { fill : rgba(119, 25, 170, 1.000); }\r\nsvg > path.OfficeIconColors_m2206 { fill : rgba(81, 21, 117, 1.000); }\r\nsvg > path.OfficeIconColors_m2207 { fill : rgba(80, 217, 255, 1.000); }\r\nsvg > path.OfficeIconColors_m2208 { fill : rgba(40, 168, 234, 1.000); }\r\nsvg > path.OfficeIconColors_m2209 { fill : rgba(20, 144, 223, 1.000); }\r\nsvg > path.OfficeIconColors_m2210 { fill : rgba(0, 120, 212, 1.000); }\r\nsvg > path.OfficeIconColors_m2211 { fill : rgba(3, 100, 184, 1.000); }\r\nsvg > path.OfficeIconColors_m2212 { fill : rgba(3, 88, 167, 1.000); }\r\nsvg > path.OfficeIconColors_m2213 { fill : rgba(6, 80, 155, 1.000); }\r\nsvg > path.OfficeIconColors_m2214 { fill : rgba(6, 74, 140, 1.000); }\r\nsvg > path.OfficeIconColors_m2215 { fill : rgba(10, 39, 103, 1.000); }\r\nsvg > path.OfficeIconColors_m2216 { fill : rgba(10, 39, 103, 0.498); }\r\nsvg > path.OfficeIconColors_m2217 { fill : rgba(123, 131, 235, 1.000); }\r\nsvg > path.OfficeIconColors_m2218 { fill : rgba(80, 89, 201, 1.000); }\r\nsvg > path.OfficeIconColors_m2219 { fill : rgba(75, 83, 188, 1.000); }\r\nsvg > path.OfficeIconColors_m2220 { fill : rgba(54, 58, 126, 1.000); }\r\nsvg > path.OfficeIconColors_m2221 { fill : rgba(55, 198, 208, 1.000); }\r\nsvg > path.OfficeIconColors_m2222 { fill : rgba(26, 155, 161, 1.000); }\r\nsvg > path.OfficeIconColors_m2223 { fill : rgba(3, 131, 135, 1.000); }\r\nsvg > path.OfficeIconColors_m2224 { fill : rgba(3, 108, 112, 1.000); }\r\nsvg > path.OfficeIconColors_m2225 { fill : rgba(14, 79, 81, 1.000); }\r\nsvg > path.OfficeIconColors_m2226 { fill : rgba(222, 108, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m2227 { fill : rgba(255, 255, 255, 0.000); }\r\nsvg > path.OfficeIconColors_m2228 { fill : rgba(58, 58, 56, 1.000); }\r\nsvg > path.OfficeIconColors_m2229 { fill : rgba(255, 255, 255, 0.000); }\r\nsvg > path.OfficeIconColors_m2230 { fill : rgba(30, 139, 205, 1.000); }\r\nsvg > path.OfficeIconColors_m2231 { fill : rgba(255, 255, 255, 0.000); }\r\nsvg > path.OfficeIconColors_m2232 { fill : rgba(102, 194, 181, 1.000); }\r\nsvg > path.OfficeIconColors_m2233 { fill : rgba(250, 201, 20, 1.000); }\r\nsvg > path.OfficeIconColors_m2234 { fill : rgba(233, 0, 27, 1.000); }\r\nsvg > path.OfficeIconColors_m2235 { fill : rgba(168, 196, 207, 1.000); }\r\nsvg > path.OfficeIconColors_m2236 { fill : rgba(110, 176, 5, 1.000); }\r\nsvg > path.OfficeIconColors_m2237 { fill : rgba(180, 0, 158, 1.000); }\r\nsvg > path.OfficeIconColors_m2238 { fill : rgba(200, 198, 196, 1.000); }\r\nsvg > path.OfficeIconColors_m2239 { fill : rgba(102, 110, 218, 1.000); }\r\nsvg > path.OfficeIconColors_m2240 { fill : rgba(65, 71, 157, 1.000); }\r\nsvg > path.OfficeIconColors_m2241 { fill : rgba(224, 128, 149, 1.000); }\r\nsvg > path.OfficeIconColors_m2242 { fill : rgba(201, 79, 96, 1.000); }\r\nsvg > path.OfficeIconColors_m2243 { fill : rgba(175, 32, 49, 1.000); }\r\nsvg > path.OfficeIconColors_m2244 { fill : rgba(136, 20, 33, 1.000); }\r\nsvg > path.OfficeIconColors_m2245 { fill : rgba(102, 18, 28, 1.000); }\r\nsvg > path.OfficeIconColors_m2246 { fill : rgba(232, 70, 124, 1.000); }\r\nsvg > path.OfficeIconColors_m2247 { fill : rgba(210, 48, 98, 1.000); }\r\nsvg > path.OfficeIconColors_m2248 { fill : rgba(188, 25, 72, 1.000); }\r\nsvg > path.OfficeIconColors_m2249 { fill : rgba(140, 25, 63, 1.000); }\r\nsvg > path.OfficeIconColors_m2250 { fill : rgba(123, 25, 59, 1.000); }\r\nsvg > path.OfficeIconColors_m2251 { fill : rgba(0, 0, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m2252 { fill : rgba(200, 198, 196, 1.000); }\r\nsvg > path.OfficeIconColors_m2253 { fill : rgba(134, 242, 242, 1.000); }\r\nsvg > path.OfficeIconColors_m2254 { fill : rgba(242, 158, 0, 1.000); }\r\nsvg > path.OfficeIconColors_m2255 { fill : rgba(216, 59, 1, 1.000); }\r\nsvg > path.OfficeIconColors_m2256 { fill : rgba(216, 59, 1, 0.247); }\r\nsvg > path.OfficeIconColors_m2257 { fill : rgba(213, 85, 156, 1.000); }\r\nsvg > path.OfficeIconColors_m2258 { fill : rgba(194, 31, 36, 1.000); }\r\nsvg > path.OfficeIconColors_m2259 { fill : rgba(194, 31, 36, 0.247); }\r\nsvg > path.OfficeIconColors_m2260 { fill : rgba(243, 41, 64, 1.000); }\r\nsvg > path.OfficeIconColors_m2261 { fill : rgba(94, 5, 0, 0.149); }\r\nsvg > path.OfficeIconColors_m2262 { fill : rgba(24, 90, 189, 1.000); }\r\nsvg > path.OfficeIconColors_m2263 { fill : rgba(16, 124, 65, 1.000); }\r\nsvg > path.OfficeIconColors_m2264 { fill : rgba(196, 62, 28, 1.000); }\r\nsvg > path.OfficeIconColors_m2265 { fill : rgba(119, 25, 170, 1.000); }\r\nsvg > path.OfficeIconColors_m2266 { fill : rgba(0, 120, 212, 1.000); }\r\nsvg > path.OfficeIconColors_m2267 { fill : rgba(75, 83, 188, 1.000); }\r\nsvg > path.OfficeIconColors_m2268 { fill : rgba(3, 131, 135, 1.000); }\r\nsvg > path.OfficeIconColors_m2269 { fill : rgba(175, 32, 49, 1.000); }\r\nsvg > path.OfficeIconColors_m2270 { fill : rgba(188, 25, 72, 1.000); }\r\nsvg > path.OfficeIconColors_m2271 { fill : rgba(248, 222, 109, 1.000); }\r\nsvg > path.OfficeIconColors_m2272 { fill : rgba(233, 192, 17, 1.000); }\r\nsvg > path.OfficeIconColors_m2273 { fill : rgba(230, 173, 16, 1.000); }\r\nsvg > path.OfficeIconColors_m2274 { fill : rgba(215, 150, 15, 1.000); }\r\nsvg > path.OfficeIconColors_m2275 { fill : rgba(208, 138, 15, 1.000); }\r\nsvg > path.OfficeIconColors_m2276 { fill : rgba(200, 126, 14, 1.000); }\r\nsvg > path.OfficeIconColors_DynamicColor { fill : inherit; }\r\n\nsvg > path.OfficeIconColors_mWord0001 {\r\n  fill: rgba(180, 180, 180, 1);\r\n}\r\nsvg > path.OfficeIconColors_mWord0002 {\r\n  fill: #333333;\r\n}\r\nsvg > path.OfficeIconColors_mWord0003 {\r\n  fill: #107c10;\r\n}\r\nsvg > path.OfficeIconColors_mWord0004 {\r\n  fill: #a4262c;\r\n}\r\nsvg > path.OfficeIconColors_mMSLogoGrey {\r\n  fill: #737373;\r\n}\r\nsvg > path.OfficeIconColors_MSLogoOrange {\r\n  fill: #f25022;\r\n}\r\nsvg > path.OfficeIconColors_MSLogoGreen {\r\n  fill: #7fba00;\r\n}\r\nsvg > path.OfficeIconColors_MSLogoBlue {\r\n  fill: #00a4ef;\r\n}\r\nsvg > path.OfficeIconColors_MSLogoYellow {\r\n  fill: #ffb900;\r\n}\r\nsvg > path.OfficeIconColors_Transparent {\r\n  fill: transparent;\r\n}\r\nsvg > path.OfficeIconColors_HighContrast:not([class*='OfficeIconColors_m']) {\r\n  fill: transparent;\r\n}\r\n\r\n/* Shell header API requires an icon font. Currently it is containing a single icon */\r\n@font-face {\r\n  font-family: 'header-icon-font';\r\n  src: url(data:application/x-font-woff;charset=utf-8;base64,d09GRgABAAAAAAS4AAsAAAAABGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAABCAAAAGAAAABgDxIFKmNtYXAAAAFoAAAAVAAAAFQXVtKHZ2FzcAAAAbwAAAAIAAAACAAAABBnbHlmAAABxAAAALAAAACwj/lT52hlYWQAAAJ0AAAANgAAADYV29+GaGhlYQAAAqwAAAAkAAAAJAePA8ZobXR4AAAC0AAAABQAAAAUCgAAM2xvY2EAAALkAAAADAAAAAwAKABsbWF4cAAAAvAAAAAgAAAAIAANABxuYW1lAAADEAAAAYYAAAGGmUoJ+3Bvc3QAAASYAAAAIAAAACAAAwAAAAMDAAGQAAUAAAKZAswAAACPApkCzAAAAesAMwEJAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAQAAA6QADwP/AAEADwABAAAAAAQAAAAAAAAAAAAAAIAAAAAAAAwAAAAMAAAAcAAEAAwAAABwAAwABAAAAHAAEADgAAAAKAAgAAgACAAEAIOkA//3//wAAAAAAIOkA//3//wAB/+MXBAADAAEAAAAAAAAAAAAAAAEAAf//AA8AAQAAAAAAAAAAAAIAADc5AQAAAAABAAAAAAAAAAAAAgAANzkBAAAAAAEAAAAAAAAAAAACAAA3OQEAAAAABwAzADsDzQONAAQACAAMABAAEwAWABkAAAkDIQcXMycjByEnBTM3IxMDIwETIRMBIwPN/jP+MwEIAYpaULO/4lEBCFH+X7NQRFxmvQF2hP741gEkvAJz/cgCOAEaM83MzMzMzP2ZAWf+MwHN/pkBZwAAAAABAAAAAAAAT5fqk18PPPUACwQAAAAAANl4zX4AAAAA2XjNfgAAAAADzQONAAAACAACAAAAAAAAAAEAAAPA/8AAAAQAAAAAAAPNAAEAAAAAAAAAAAAAAAAAAAAFBAAAAAAAAAAAAAAAAgAAAAQAADMAAAAAAAoAFAAeAFgAAQAAAAUAGgAHAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAA4ArgABAAAAAAABAAcAAAABAAAAAAACAAcAYAABAAAAAAADAAcANgABAAAAAAAEAAcAdQABAAAAAAAFAAsAFQABAAAAAAAGAAcASwABAAAAAAAKABoAigADAAEECQABAA4ABwADAAEECQACAA4AZwADAAEECQADAA4APQADAAEECQAEAA4AfAADAAEECQAFABYAIAADAAEECQAGAA4AUgADAAEECQAKADQApGljb21vb24AaQBjAG8AbQBvAG8AblZlcnNpb24gMS4wAFYAZQByAHMAaQBvAG4AIAAxAC4AMGljb21vb24AaQBjAG8AbQBvAG8Abmljb21vb24AaQBjAG8AbQBvAG8AblJlZ3VsYXIAUgBlAGcAdQBsAGEAcmljb21vb24AaQBjAG8AbQBvAG8AbkZvbnQgZ2VuZXJhdGVkIGJ5IEljb01vb24uAEYAbwBuAHQAIABnAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAEkAYwBvAE0AbwBvAG4ALgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=)\r\n    format('woff');\r\n  font-weight: normal;\r\n  font-style: normal;\r\n}\r\n[class^='header-icon-'],\r\n[class*=' header-icon-'] {\r\n  font-family: 'header-icon-font' !important;\r\n  font-style: normal;\r\n  font-weight: normal;\r\n  font-variant: normal;\r\n  text-transform: none;\r\n  line-height: 1;\r\n  -webkit-font-smoothing: antialiased;\r\n  -moz-osx-font-smoothing: grayscale;\r\n}\r\n.header-icon-upgradeproductglyph:before {\r\n  content: '\\e900';\r\n}\r\n\r\n@media screen and (-ms-high-contrast: active), (forced-colors: active) {\r\n  svg > path[class*='OfficeIconColors_m']:not(.OfficeIconColors_HighContrast) {\r\n    fill: transparent;\r\n  }\r\n  svg > path.OfficeIconColors_HighContrast,\r\n  svg > path.OfficeIconColors_HighContrast:not([class*='OfficeIconColors_m']) {\r\n    fill: ButtonText;\r\n  }\r\n\r\n  a[aria-disabled='true'] svg > path.OfficeIconColors_HighContrast,\r\n  [aria-disabled='true'] a svg > path.OfficeIconColors_HighContrast {\r\n    fill: grayText;\r\n  }\r\n  a[aria-disabled='false'] svg > path.OfficeIconColors_HighContrast,\r\n  [aria-disabled='false'] a svg > path.OfficeIconColors_HighContrast {\r\n    fill: linkText;\r\n  }\r\n\r\n  button:hover svg > path.OfficeIconColors_HighContrast,\r\n  button:focus svg > path.OfficeIconColors_HighContrast,\r\n  button[aria-pressed='true'] svg > path.OfficeIconColors_HighContrast,\r\n  button[aria-selected='true'] svg > path.OfficeIconColors_HighContrast,\r\n  button[aria-expanded='true'] svg > path.OfficeIconColors_HighContrast,\r\n  button[aria-checked='true'] svg > path.OfficeIconColors_HighContrast {\r\n    fill: highlightText;\r\n  }\r\n\r\n  button:hover[aria-disabled='true'] svg > path.OfficeIconColors_HighContrast,\r\n  [aria-disabled='true'] button:hover svg > path.OfficeIconColors_HighContrast,\r\n  button:hover:disabled svg > path.OfficeIconColors_HighContrast,\r\n  button:focus[aria-disabled='true'] svg > path.OfficeIconColors_HighContrast,\r\n  [aria-disabled='true'] button:focus svg > path.OfficeIconColors_HighContrast,\r\n  button:focus:disabled svg > path.OfficeIconColors_HighContrast,\r\n  button:hover:focus[aria-disabled='true'] svg > path.OfficeIconColors_HighContrast,\r\n  [aria-disabled='true'] button:hover:focus svg > path.OfficeIconColors_HighContrast,\r\n  button:hover:focus:disabled svg > path.OfficeIconColors_HighContrast,\r\n  button[aria-disabled='true'] svg > path.OfficeIconColors_HighContrast,\r\n  [aria-disabled='true'] button svg > path.OfficeIconColors_HighContrast,\r\n  button:disabled svg > path.OfficeIconColors_HighContrast,\r\n  button[aria-pressed='true'][aria-disabled='true'] svg > path.OfficeIconColors_HighContrast,\r\n  [aria-disabled='true'] button[aria-pressed='true'] svg > path.OfficeIconColors_HighContrast,\r\n  button[aria-pressed='true']:disabled svg > path.OfficeIconColors_HighContrast,\r\n  button[aria-selected='true'][aria-disabled='true'] svg > path.OfficeIconColors_HighContrast,\r\n  [aria-disabled='true'] button[aria-selected='true'] svg > path.OfficeIconColors_HighContrast,\r\n  button[aria-selected='true']:disabled svg > path.OfficeIconColors_HighContrast,\r\n  button[aria-expanded='true'][aria-disabled='true'] svg > path.OfficeIconColors_HighContrast,\r\n  [aria-disabled='true'] button[aria-expanded='true'] svg > path.OfficeIconColors_HighContrast,\r\n  button[aria-expanded='true']:disabled svg > path.OfficeIconColors_HighContrast,\r\n  button[aria-checked='true'][aria-disabled='true'] svg > path.OfficeIconColors_HighContrast,\r\n  [aria-disabled='true'] button[aria-checked='true'] svg > path.OfficeIconColors_HighContrast,\r\n  button[aria-checked='true']:disabled svg > path.OfficeIconColors_HighContrast {\r\n    fill: grayText;\r\n  }\r\n\r\n  /* For the checkbox, we need to check for an input with a label nearby */\r\n  input:hover[type='checkbox'][aria-checked='true'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  input:focus[type='checkbox'][aria-checked='true'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  input[type='checkbox'][aria-checked='true'] ~ label svg > path.OfficeIconColors_HighContrast {\r\n    fill: highlightText;\r\n  }\r\n\r\n  input:hover[type='checkbox'][aria-checked='true'][aria-disabled='true']\r\n    ~ label\r\n    svg\r\n    > path.OfficeIconColors_HighContrast,\r\n  [aria-disabled='true']\r\n    input:hover[type='checkbox'][aria-checked='true']\r\n    ~ label\r\n    svg\r\n    > path.OfficeIconColors_HighContrast,\r\n  input:hover:disabled[type='checkbox'][aria-checked='true'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  input:focus[type='checkbox'][aria-checked='true'][aria-disabled='true']\r\n    ~ label\r\n    svg\r\n    > path.OfficeIconColors_HighContrast,\r\n  [aria-disabled='true']\r\n    input:focus[type='checkbox'][aria-checked='true']\r\n    ~ label\r\n    svg\r\n    > path.OfficeIconColors_HighContrast,\r\n  input:focus:disabled[type='checkbox'][aria-checked='true'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  input:hover:focus[type='checkbox'][aria-checked='true'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  input:hover:focus:disabled[type='checkbox'][aria-checked='true'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  input[type='checkbox'][aria-checked='true'][aria-disabled='true'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  [aria-disabled='true'] input[type='checkbox'][aria-checked='true'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  input:disabled[type='checkbox'][aria-checked='true'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  input[type='checkbox'][aria-checked='true'][aria-disabled='true'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  [aria-disabled='true'] input[type='checkbox'][aria-checked='true'] ~ label svg > path.OfficeIconColors_HighContrast {\r\n    fill: grayText;\r\n  }\r\n\r\n  input:hover:checked[type='checkbox'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  input:focus:checked[type='checkbox'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  input:checked[type='checkbox'] ~ label svg > path.OfficeIconColors_HighContrast {\r\n    fill: highlightText;\r\n  }\r\n\r\n  input:hover:checked[type='checkbox'][aria-disabled='true'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  [aria-disabled='true'] input:hover:checked[type='checkbox'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  input:hover:disabled:checked[type='checkbox'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  input:focus:checked[type='checkbox'][aria-disabled='true'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  [aria-disabled='true'] input:focus:checked[type='checkbox'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  input:focus:disabled:checked[type='checkbox'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  input:hover:focus[type='checkbox'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  input:hover:focus:disabled:checked[type='checkbox'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  input:checked[type='checkbox'][aria-disabled='true'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  [aria-disabled='true'] input:checked[type='checkbox'] ~ label svg > path.OfficeIconColors_HighContrast,\r\n  input:disabled:checked[type='checkbox'] ~ label svg > path.OfficeIconColors_HighContrast {\r\n    fill: grayText;\r\n  }\r\n}\r\n",""]),t.exports=e},1608:function(t,e,n){"use strict";n.r(e);var i=n(1),r=window.hasOwnProperty("catchUpTestPerformance")?catchUpTestPerformance:performance,a=n(55),o=n(61),c=n(196),s=void 0;function l(t){s=t}function u(){return s}var g,f=new(function(){function t(){}return t.prototype.setLogger=function(t){this._externalLogger=t},t.prototype.logTrace=function(t,e){if(void 0===n&&(n=!1),null!==(r=null===(i=u())||void 0===i?void 0:i.isFeatureGateEnabled("Microsoft.Office.CatchUpCore.CatchUpLoggerEnabled",n))&&void 0!==r&&r){var n,i,r;if(!this._externalLogger)throw new Error("No ICatchUpLogger defined");this._externalLogger.logTrace(t,e)}else{var s=t;if(!s.tag||!s.level||!s.message)return void a.a.sendTraceTag(556363852,o.a.msoulscat_Wac_CatchUpFlyout,c.a.Error,"Undefined tag and/or level and/or message in tryLogEvent: "+s);s.category||(s.category=o.a.msoulscat_Wac_CatchUpFlyout);var l=0;switch(s.level){case"Error":l=c.a.Error;break;case"Warning":l=c.a.Warning;break;case"Info":l=c.a.Info;break;case"Verbose":l=c.a.Verbose;break;case"Spam":l=c.a.Spam}a.a.sendTraceTag(s.tag,s.category,l,s.message)}},t}());!function(t){t.CatchUpActivityValidationPropMissingError="CatchUpActivityValidationPropMissingError",t.CatchUpFeaturedActivityGroupClicked="CatchUpFeaturedActivityGroupClicked",t.CatchUpFlyoutActivitiesProcessed="CatchUpFlyoutActivitiesProcessed",t.CatchUpFlyoutContainerInitError="CatchUpFlyoutContainerInitError",t.CatchUpFlyoutDismissedCalled="CatchUpFlyoutDismissedCalled",t.CatchUpFlyoutRenderCalled="CatchUpFlyoutRenderCalled",t.CatchUpFlyoutTriageIconsNullActivityError="CatchUpFlyoutTriageIconsNullActivityError",t.CatchUpInitTimeline="CatchUpInitTimeline",t.CatchUpInvalidActivityTypeForItemString="CatchUpInvalidActivityTypeForItemString",t.CatchUpInvalidChangeIndices="CatchUpInvalidChangeIndices",t.CatchUpMissingActorsToCheckMentionee="CatchUpMissingActorsToCheckMentionee",t.CatchUpMissingDisplayNameError="CatchUpMissingDisplayNameError",t.CatchUpMissingDisplayTimestamp="CatchUpMissingDisplayTimestamp",t.CatchUpMissingNoChangesItemStringError="CatchUpMissingNoChangesItemStringError",t.CatchUpMissingSummaryItemStringError="CatchUpMissingSummaryItemStringError",t.CatchUpNavToItemFailed="CatchUpNavToItemFailed",t.CatchUpNoActivityForFeaturedGroupError="CatchUpNoActivityForFeaturedGroupError",t.CatchUpNoActivityForItemClickError="CatchUpNoActivityForItemClickError",t.CatchUpNoActivityOrActivityTypeError="CatchUpNoActivityOrActivityTypeError",t.CatchUpNoActorInFeedItemError="CatchUpNoActorInFeedItemError",t.CatchUpNoActorsForActivityError="CatchUpNoActorsForActivityError",t.CatchUpNoAuthorsForAuthorLayoutString="CatchUpNoAuthorsForAuthorLayoutString",t.CatchUpNoCreatorAttributionError="CatchUpNoCreatorAttributionError",t.CatchUpNoDataInFeedItemError="CatchUpNoDataInFeedItemError",t.CatchUpNoFeedItemPayloadError="CatchUpNoFeedItemPayloadError",t.CatchUpNoFeedItemTypeError="CatchUpNoFeedItemTypeError",t.CatchupNoPriorityIdError="CatchupNoPriorityIdError",t.CatchUpNoReasonsInActivityGroup="CatchUpNoReasonsInActivityGroup",t.CatchUpNoTimestampInFeedItemError="CatchUpNoTimestampInFeedItemError",t.CatchUpOverlappingContentChanges="CatchUpOverlappingContentChanges",t.CatchUpRelevantToMeItemClicked="CatchUpRelevantToMeItemClicked",t.CatchUpSummaryTextClicked="CatchUpSummaryTextClicked",t.CatchUpUnhandledTaskReopenCase="CatchUpUnhandledTaskReopenCase",t.CatchUpUnknownActivityTypeError="CatchUpUnknownActivityTypeError"}(g||(g={}));var p=!1;function h(t){p||r.mark("CatchUpInit."+t)}function v(){if(!p){var t=r.getEntriesByType("mark"),e=function(t){for(var e=-1,n=t.length-1;n>=0;n-=1)if("CatchUpInit.Begin"===t[n].name){e=n;break}return e}(t);if(-1!==e){var n=function(t){for(var e=new Array,n=t[0],i=1;i<t.length;i+=1){var r=t[i];0===r.name.indexOf("CatchUpInit.")&&(e.push({start:n.name.split(".")[1],end:r.name.split(".")[1],duration:Math.round(r.startTime-n.startTime)}),n=r)}return e}(t.slice(e));f.logTrace({tag:592717845,level:"Info",message:JSON.stringify(n),eventCategory:"Generic",eventName:g.CatchUpInitTimeline}),p=!0}}}function d(t){return Object(i.__assign)(Object(i.__assign)({},t),{isClicked:!1})}var m,A,C,y,b,_,I,O=n(221);!function(t){t[t.Sheet=100]="Sheet",t[t.Cell=101]="Cell",t[t.Range=102]="Range",t[t.Row=103]="Row",t[t.Column=104]="Column",t[t.SingleRangeOrObject=105]="SingleRangeOrObject",t[t.DiscontinuousRange=106]="DiscontinuousRange",t[t.MultiObjects=107]="MultiObjects",t[t.Grouped=108]="Grouped",t[t.Slide=200]="Slide",t[t.Page=300]="Page"}(m||(m={})),function(t){t[t.None=1]="None",t[t.New=2]="New",t[t.Outstanding=3]="Outstanding"}(A||(A={})),function(t){t[t.Success=1]="Success",t[t.DeletedItem=2]="DeletedItem",t[t.UnknownError=3]="UnknownError",t[t.EmptyNavigationId=4]="EmptyNavigationId",t[t.DecodeNavIdFailed=5]="DecodeNavIdFailed",t[t.AppNavigationFailure=6]="AppNavigationFailure",t[t.UnsupportedActivityType=7]="UnsupportedActivityType"}(C||(C={})),function(t){t[t.None=0]="None",t[t.Edit=1]="Edit",t[t.Comment=2]="Comment",t[t.Reply=3]="Reply",t[t.AtMention=4]="AtMention",t[t.Restore=5]="Restore",t[t.TaskAssign=6]="TaskAssign",t[t.TaskReassign=7]="TaskReassign",t[t.TaskReopen=8]="TaskReopen",t[t.TaskComplete=9]="TaskComplete",t[t.TaskReply=10]="TaskReply"}(y||(y={})),function(t){t[t.NewAssignee=1]="NewAssignee",t[t.ExistingAssignee=2]="ExistingAssignee",t[t.TaskCreator=3]="TaskCreator"}(b||(b={})),function(t){t[t.TopLeftEdge=1]="TopLeftEdge",t[t.TopCenter=2]="TopCenter",t[t.TopRightEdge=3]="TopRightEdge",t[t.TopAutoEdge=4]="TopAutoEdge",t[t.BottomLeftEdge=5]="BottomLeftEdge",t[t.BottomCenter=6]="BottomCenter",t[t.BottomRightEdge=7]="BottomRightEdge",t[t.BottomAutoEdge=8]="BottomAutoEdge",t[t.LeftTopEdge=9]="LeftTopEdge",t[t.LeftCenter=10]="LeftCenter",t[t.LeftBottomEdge=11]="LeftBottomEdge",t[t.RightTopEdge=12]="RightTopEdge",t[t.RightCenter=13]="RightCenter",t[t.RightBottomEdge=14]="RightBottomEdge"}(_||(_={})),function(t){t[t.ContentEdit=1]="ContentEdit",t[t.LargestContentEdit=2]="LargestContentEdit"}(I||(I={}));var T=function(){function t(t,e){void 0===t&&(t=new Map),void 0===e&&(e=0),this._map=t,this._count=e}return t.prototype.getValueCount=function(){return this._count},t.prototype.inc=function(t){var e=this._map.get(t);this._map.set(t,(e||0)+1),this._count+=1},t.prototype.getJsonArray=function(){var t=[];return this._map.forEach((function(e,n){var i;t.push(((i={})[String(n)]=e,i))})),t},t}();var E,U=n(1858);function N(t,e){return t===e||t.provider===e.provider&&function(t,e){if(!t||!e)return!1;if(t===e)return!0;var n=w(t),i=n.aadId,r=n.upn,a=w(e),o=a.aadId,c=a.upn;return k(i,o)||k(r,c)}(t.id,e.id)||k(t.email,e.email)||F(t.id,e.email)||F(e.id,t.email)}function w(t){if(0!==t.indexOf("S::")){var e=t.match(/(.*)(@)(.*)(\.)(.*)/);return 6===(null==e?void 0:e.length)?{aadId:"",upn:t}:{aadId:"",upn:""}}var n=t.match(/(.*)(::)(.*?)(::)(.*)/i);return 6===(null==n?void 0:n.length)?{aadId:n[5],upn:n[3]}:{aadId:"",upn:""}}function k(t,e){return!(!t||!e)&&t===e}function F(t,e){return!(!t||!e)&&-1!==t.indexOf(e)}function x(t,e){switch(t){case 0:return f.logTrace({tag:559436956,level:"Warning",message:"Retrieving authors layout string for catch-up flyout with zero authors",eventCategory:"Generic",eventName:g.CatchUpNoAuthorsForAuthorLayoutString}),e.ActivityNotificationText;case 1:return e.CatchUpFlyoutOnePersonChange;case 2:return e.CatchUpFlyoutTwoPeopleChange;case 3:return e.CatchUpFlyoutThreePeopleChange;case 4:return e.CatchUpFlyoutFourPeopleChange;default:return e.CatchUpFlyoutMultiplePeopleChange}}function S(t,e){switch(t.type){case y.Comment:return e.CommentAction;case y.Edit:return e.EditAction;case y.AtMention:return e.CatchUpFlyoutMentionItem;case y.Reply:return e.CatchUpFlyoutCommentReplyItem;case y.Restore:return e.RestoreAction;case y.TaskAssign:return j(t.actors)?e.CatchUpFlyoutSelfAssignedTaskItem:e.CatchUpFlyoutAssignTaskItem;case y.TaskReassign:case y.TaskReopen:case y.TaskComplete:var n=t;switch(t.type){case y.TaskReassign:return t.relevancy===A.Outstanding?e.CatchUpFlyoutAssignTaskItem:n.relationship===b.TaskCreator?e.CatchUpFlyoutReassignTaskUserCreatedItem:e.CatchUpFlyoutReassignTaskItem;case y.TaskReopen:if(n.relevancy===A.New&&n.relationship===b.TaskCreator)return e.CatchUpFlyoutCreatedTaskReopenedItem;if(n.relevancy===A.New&&R(n.relationship))return e.CatchUpFlyoutReopenTaskItem;var i=j(n.actors);return n.relevancy===A.Outstanding&&i?e.CatchUpFlyoutSelfAssignedTaskItem:(n.relevancy===A.Outstanding&&!i&&R(n.relationship)||f.logTrace({tag:560215310,level:"Warning",message:"Unhandled TaskReopen case. Relevancy: "+n.relevancy+". Relationship: "+n.relationship+". CreatorIsMentionee: "+i+".",eventCategory:"Generic",eventName:g.CatchUpUnhandledTaskReopenCase}),e.CatchUpFlyoutAssignTaskItem);case y.TaskComplete:return n.relationship===b.TaskCreator?e.CatchUpFlyoutCompleteTaskUserCreatedItem:e.CatchUpFlyoutCompleteTaskItem;default:return e.CatchUpFlyoutOnePersonChange}case y.TaskReply:return e.CatchUpFlyoutReplyToTaskItem;default:return f.logTrace({tag:560215311,level:"Warning",message:"Invalid activity type provided when generating relevant item string",eventCategory:"Generic",eventName:g.CatchUpInvalidActivityTypeForItemString}),e.CatchUpFlyoutOnePersonChange}}function j(t){return t&&t[0]&&t[1]?N(t[0],t[1]):(f.logTrace({tag:560215313,level:"Warning",message:"Can't check if creator==mentionee. Defaulting to false.actors:"+!!t+", actors[0]:"+!!(null==t?void 0:t[0])+", actors[1]:"+!!(null==t?void 0:t[1]),eventCategory:"Generic",eventName:g.CatchUpMissingActorsToCheckMentionee}),!1)}function R(t){return t===b.NewAssignee||t===b.ExistingAssignee}function D(t,e,n){var i=function(t,e){if(!e)return 1;if(t.type===y.Edit)return 5;if(t.type>999)return 4;if(t.relevancy&&t.relevancy!==A.None)return 3;return 2}(e,n);return i>t.priority?{activity:e,priority:i}:t}function W(t,e,n,r,a,o,c){return void 0===c&&(c=!1),Object(i.__awaiter)(this,void 0,void 0,(function(){var s,l,u,p,h,v,m,C,b,_,I,O,E,N,w,k;return Object(i.__generator)(this,(function(F){switch(F.label){case 0:return[4,M(t,e,c)];case 1:return s=F.sent(),l=s.preprocessedActivities,u=s.wywaPayload,[4,B(r,t)];case 2:return p=F.sent(),h=function(t){var e=new T,n=new T,i=new T,r=[],a=new Set,o=[],c=new Set;return t.filter((function(t){return t.contentExists})).forEach((function(t){switch(t.relevancy){case A.New:r.push(d(t)),a.add(t.creatorName),e.inc(t.type);break;case A.Outstanding:r.push(d(t)),a.add(t.creatorName),n.inc(t.type);break;case A.None:o.push(d(t)),c.add(t.creatorName),i.inc(t.type)}})),{genericActivities:o,genericActivityTypesCountMap:i,genericAuthorsCount:c.size,newActivityTypesCountMap:e,outstandingActivityTypesCountMap:n,relevantActivities:r,relevantAuthorsCount:a.size}}(l),v=h.genericActivities,m=h.genericActivityTypesCountMap,C=h.genericAuthorsCount,b=h.newActivityTypesCountMap,_=h.outstandingActivityTypesCountMap,I=h.relevantActivities,O=h.relevantAuthorsCount,E=function(t,e,n,i,r){if(!i)return{authorNames:[],summaryNavActivity:void 0};var a=n.map((function(t){return t.displayName})).filter((function(t){return!!t})),o={activity:void 0,priority:0},c=e.map((function(t){var e;return null!==(e=t.activities)&&void 0!==e?e:[]})).reduce((function(t,e){return t.concat(e)}),[]).map((function(t){return t&&t.activityId})).filter((function(t){return!!t}));return t.forEach((function(t){switch(t.relevancy){case A.New:if(!t.contentExists||!r)break;a.push(t.creatorName),o=D(o,t,t.contentExists);break;case A.Outstanding:break;case A.None:default:if(!t.contentExists&&(t.type===y.AtMention||t.type===y.Comment||t.type===y.Reply||t.type===y.TaskAssign||t.type===y.TaskComplete||t.type===y.TaskReassign||t.type===y.TaskReopen||t.type===y.TaskReply))break;if(c.indexOf(t.activityId)>-1)break;a.push(t.creatorName),o=D(o,t,t.contentExists)}})),{authorNames:a=a.filter((function(t,e,n){return e===n.indexOf(t)})),summaryNavActivity:o.activity}}(l,p,u.authors,a&&!u.isFirstDocumentOpen,o),N=E.authorNames,w=E.summaryNavActivity,k=function(t,e){if(0===t.length)return"";var n=t.length<=4?t:t.slice(0,3).concat((t.length-3).toString());return U.b.apply(void 0,Object(i.__spreadArrays)([x(t.length,e)],n))}(N,n),f.logTrace({tag:595637973,level:"Info",message:JSON.stringify({featuredActivityGroups:p.length,msg:"Activities processed on CatchUpFlyout construction.",genericActivityCount:m.getValueCount(),genericActivityTypesCounts:m.getJsonArray(),newActivityCount:b.getValueCount(),newActivityTypesCounts:b.getJsonArray(),outstandingActivityCount:_.getValueCount(),outstandingActivityTypesCounts:_.getJsonArray(),peopleMadeGenericChanges:C,peopleMadeNewChanges:N.length,peopleMadeRelevantChanges:O,relevantChanges:I.length}),eventCategory:"Generic",eventName:g.CatchUpFlyoutActivitiesProcessed}),[2,{relevantActivities:I,genericActivities:v,catchUpActivitiesCount:l.length,activityGroups:p,authorCount:N.length,summaryNavActivity:w,summaryItemText:k}]}}))}))}function M(t,e,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){var r,a;return Object(i.__generator)(this,(function(o){switch(o.label){case 0:return[4,t.getWywaActivities()];case 1:return r=o.sent(),a=[],n?(h("GetActivityFeed"),[4,t.getActivityFeedItems()]):[3,3];case 2:return a=o.sent(),h("EndGetActivityFeed"),[3,5];case 3:return h("GetRelevantActivities"),[4,t.getRelevantActivities()];case 4:a=o.sent(),h("EndGetRelevantActivities"),o.label=5;case 5:return[2,{preprocessedActivities:(c=a,s=r.activities,l=Object(i.__spreadArrays)(c),s.forEach((function(t){-1===Object(O.e)(l,(function(e){return e.activityId===t.activityId}))&&l.push(t)})),l).sort((function(t,e){return e.displayTimestamp.getTime()-t.displayTimestamp.getTime()})).map((function(t){var n=function(t){if(!t.actors||!t.actors.length)return void f.logTrace({tag:559436959,level:"Error",message:"No actors for activity.",eventCategory:"Error",eventName:g.CatchUpNoActorsForActivityError});var e=t.actors[0];if(!e||!e.displayName||0===e.displayName.length)return void f.logTrace({tag:559436960,level:"Error",message:"No creator attribution for activity.",eventCategory:"Error",eventName:g.CatchUpNoCreatorAttributionError});return e.displayName}(t);if(n){var r=!0;return e&&"function"==typeof e.doesContentExist&&(r=e.doesContentExist(t)),Object(i.__assign)(Object(i.__assign)({},t),{creatorName:n,contentExists:r})}})).filter((function(t){return void 0!==t})),wywaPayload:r}]}var c,s,l}))}))}function B(t,e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return n=[],t?(h("GetFeaturedActivityGroups"),[4,e.getFeaturedActivityGroups()]):[3,2];case 1:n=i.sent().map(d).sort((function(t,e){return t.ranking-e.ranking})),h("EndGetFeaturedActivityGroups"),i.label=2;case 2:return[2,n]}}))}))}function H(t,e,n){return t&&0!==t.length?function(t,e){if(!t||0===t.length)return[""];switch(e){case E.compressed4:return[""];case E.compressed3:return["Activity"];case E.compressed2:return[t.length>1?Object(U.b)("{0} activities",t.length.toString()):"1 activity"];case E.compressed1:return[G(t)]}var n=L(t);if(0===n.length)return[G(t)];var i=P(t);if(1===n.length){return[t.length>1?Object(U.b)("has {0} activities for you",t.length.toString()):"has 1 activity for you",i]}var r=n.length-1;return[Object(U.b)("+ {0} have {1} activities for you",r.toString(),t.length.toString()),i]}(t,n):e&&0!==e.length?function(t){var e=L(t);if(0===e.length)return["New changes"];if(1===e.length)return["made new changes",P(t)];var n=e.length-1;return[Object(U.b)("+ {0} made new changes",n.toString()),P(t)]}(e):[""]}function G(t){return t.length>1?Object(U.b)("{0} activities for you",t.length.toString()):"1 activity for you"}function P(t){for(var e=0,n=t;e<n.length;e++){var i=n[e];if(i.actors&&i.actors[0])return i.actors[0]}}function L(t){for(var e=[],n=0,i=t;n<i.length;n++){var r=i[n];if(r.actors&&r.actors[0]){if(!r.actors[0].displayName||0===r.actors[0].displayName.length)return[];e.push(r.actors[0].displayName)}}return e=e.filter((function(t,e,n){return e===n.indexOf(t)}))}!function(t){t[t.noCompression=0]="noCompression",t[t.compressed1=1]="compressed1",t[t.compressed2=2]="compressed2",t[t.compressed3=3]="compressed3",t[t.compressed4=4]="compressed4"}(E||(E={}));var z,Q=n(598),q=n(248);function K(t,e){return"CommentCreated"===t?e?y.TaskReply:y.Reply:"TaskCreated"===t?y.TaskAssign:"TaskCompleted"===t?y.TaskComplete:"TaskReassigned"===t?y.TaskReassign:"TaskReopened"===t?y.TaskReopen:"UserAtMentioned"===t?y.AtMention:(f.logTrace({tag:560215318,level:"Error",message:"Unknown type: getActivityType.",eventCategory:"Error",eventName:g.CatchUpUnknownActivityTypeError}),y.None)}function J(t,e){return 0!=(t&e)}function V(t){var e=[];return t.forEach((function(t){var n=function(t){var e,n,i;if(!t.type)return void f.logTrace({tag:560215319,level:"Error",message:"No type when validating activity feed item.",eventCategory:"Error",eventName:g.CatchUpNoFeedItemPayloadError});if(!t.activityFeedItemPayload)return void f.logTrace({tag:560215320,level:"Error",message:"No activityFeedItemPayload when validating activity feed item.",eventCategory:"Error",eventName:g.CatchUpNoDataInFeedItemError});var r=JSON.parse(t.activityFeedItemPayload);if(!r||!r.data||!r.data.activityId)return void f.logTrace({tag:560215321,level:"Error",message:"No data when validating activity feed item.",eventCategory:"Error",eventName:g.CatchUpNoActorInFeedItemError});if(!r.actor)return void f.logTrace({tag:560215322,level:"Error",message:"No actor when validating activity feed item.",eventCategory:"Error",eventName:g.CatchUpNoTimestampInFeedItemError});if(!r.timestamp)return void f.logTrace({tag:560215323,level:"Error",message:"No timestamp when validating activity feed item.",eventCategory:"Error",eventName:g.CatchUpNoTimestampInFeedItemError});var a={id:r.actor.id,provider:r.actor.provider,email:null!==(e=r.actor.email)&&void 0!==e?e:r.actor.userPrincipalName,displayName:r.actor.name,imageUrl:r.actor.pictureUrl,color:""};return{type:t.type,activityId:r.data.activityId,navigationId:null!==(n=r.data.navigationId)&&void 0!==n?n:void 0,commentThreadIsTask:r.data.commentThreadIsTask,actor:a,timestamp:new Date(r.timestamp),currentUserRoles:Y(r.userRoles),commentThreadId:null!==(i=r.data.commentThreadId)&&void 0!==i?i:void 0}}(t);n&&e.push(n)})),e}function Y(t){var e=z.Unknown;return t.split(", ").forEach((function(t){"Creator"===t&&(e|=z.Creator),"CommentThreadCreator"===t&&(e|=z.CommentThreadCreator),"TaskCreator"===t&&(e|=z.TaskCreator),"RepliedTo"===t&&(e|=z.RepliedTo),"InThread"===t&&(e|=z.InThread),"ExistingAssignee"===t&&(e|=z.ExistingAssignee),"NewAssignee"===t&&(e|=z.NewAssignee),"Mentioned"===t&&(e|=z.Mentioned)})),e}function Z(t){return!J(t,z.Creator)&&J(t,z.Mentioned)}function X(t,e){var n;t.has(e.commentThreadId)||t.set(e.commentThreadId,[]),null===(n=t.get(e.commentThreadId))||void 0===n||n.push(e)}function $(t){for(var e,n=[],i=new Map,r=0,a=t;r<a.length;r++){var o=a[r];switch(K(o.type,o.commentThreadIsTask)){case y.Reply:case y.TaskReply:if(J(e=o.currentUserRoles,z.Creator)||!J(e,z.InThread|z.RepliedTo))continue;n.push(tt(o));continue;case y.AtMention:if(!Z(o.currentUserRoles))continue;n.push(tt(o));continue;case y.TaskAssign:case y.TaskComplete:case y.TaskReassign:case y.TaskReopen:X(i,o);continue;default:f.logTrace({tag:556933518,level:"Error",message:"Unknown activity type: parseRelevantActivities",eventCategory:"Error",eventName:g.CatchUpUnknownActivityTypeError});continue}}return function(t,e){t.forEach((function(t,n){t.sort((function(t,e){return e.timestamp.getTime()-t.timestamp.getTime()}));var i=t[0];if(J(i.currentUserRoles,z.NewAssignee|z.ExistingAssignee|z.TaskCreator)){var r=tt(i);e.push(r)}}))}(i,n),Array.from(n.values())}function tt(t){var e,n,r={activityId:t.activityId,type:K(t.type,t.commentThreadIsTask),actors:[t.actor],location:void 0,displayTimestamp:t.timestamp,relevancy:A.Outstanding,navigationId:t.navigationId};return r.type!==y.TaskAssign&&r.type!==y.TaskComplete&&r.type!==y.TaskReassign&&r.type!==y.TaskReopen||(J(t.currentUserRoles,z.TaskCreator)&&J(t.currentUserRoles,z.NewAssignee|z.ExistingAssignee)&&(null===(e=r.actors)||void 0===e||e.push(t.actor)),r.type===y.TaskReassign&&!J(t.currentUserRoles,z.TaskCreator)&&J(t.currentUserRoles,z.ExistingAssignee)&&(r.type=y.TaskAssign),r=Object(i.__assign)(Object(i.__assign)({},r),{relationship:(n=t.currentUserRoles,J(n,z.TaskCreator)?b.TaskCreator:J(n,z.ExistingAssignee)?b.ExistingAssignee:b.NewAssignee)})),r}!function(t){t[t.Creator=1]="Creator",t[t.CommentThreadCreator=2]="CommentThreadCreator",t[t.TaskCreator=4]="TaskCreator",t[t.RepliedTo=8]="RepliedTo",t[t.InThread=16]="InThread",t[t.ExistingAssignee=32]="ExistingAssignee",t[t.NewAssignee=64]="NewAssignee",t[t.Mentioned=128]="Mentioned",t[t.Unknown=0]="Unknown"}(z||(z={}));var et=function(){function t(t){this.getWywaActivitiesPromise=void 0,this._activityRepo=t}return t.prototype.getWywaActivities=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(i.__generator)(this,(function(e){return this.getWywaActivitiesPromise||(this.getWywaActivitiesPromise=Object(i.__awaiter)(t,void 0,void 0,(function(){var t,e,n;return Object(i.__generator)(this,(function(r){switch(r.label){case 0:return h("RequestWywaActivities"),t={activities:[],authors:[],isFirstDocumentOpen:!1},[4,this._activityRepo.getWywaActivities()];case 1:if(!(e=r.sent()))return[2,t];t.activities=e.activities,t.authors=e.actors,t.highWaterline=e.highWaterline,t.lowWaterline=e.lowWaterline,t.wywaWaterline=e.wywaWaterline,t.isFirstDocumentOpen=null!==(n=e.isFirstDocumentOpen)&&void 0!==n&&n,h("RequestActivities"),r.label=2;case 2:return(null==e?void 0:e.hasMore)?[4,this._activityRepo.getActivities(t.lowWaterline,t.wywaWaterline)]:[3,4];case 3:return(e=r.sent())&&(t.lowWaterline=e.lowWaterline,t.activities=Object(i.__spreadArrays)(t.activities,e.activities),t.authors=Object(i.__spreadArrays)(t.authors,e.actors)),[3,2];case 4:return t.activities=this.dedupeActivities(t.activities),t.activities.length&&(t.authors=this.getActivityCreators(t.activities)),[2,t]}}))}))),[2,this.getWywaActivitiesPromise]}))}))},t.prototype.getRelevantActivities=function(){var t;return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,n,r,s;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return e=(new Date).getTime(),[4,this.getWywaActivities()];case 1:return[4,i.sent().wywaWaterline];case 2:return n=i.sent(),[4,this._activityRepo.getRelevantActivities(n)];case 3:return r=i.sent(),s=(new Date).getTime()-e,a.a.sendTraceTag(594879243,o.a.msoulscat_Wac_CatchUpFlyout,c.a.Info,JSON.stringify({msg:"requestRelevantActivities completed",latencyMs:s})),[2,null!==(t=null==r?void 0:r.activities)&&void 0!==t?t:[]]}}))}))},t.prototype.getActivityFeedItems=function(){var t;return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return e=(new Date).getTime(),[4,this._activityRepo.getActivityFeedItems()];case 1:return n=i.sent(),r=(new Date).getTime()-e,a.a.sendTraceTag(556337170,o.a.msoulscat_Wac_CatchUpFlyout,c.a.Info,JSON.stringify({msg:"requestActivityFeedItems completed",latencyMs:r})),[2,$(null!==(t=null==n?void 0:n.activityFeedItems)&&void 0!==t?t:[])]}}))}))},t.prototype.getFeaturedActivityGroups=function(){var t;return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,n,r,s;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return e=(new Date).getTime(),[4,this.getWywaActivities()];case 1:return[4,i.sent().activities];case 2:return n=i.sent(),[4,this._activityRepo.getFeaturedActivityGroups({wywaActivities:n})];case 3:return r=i.sent(),s=(new Date).getTime()-e,a.a.sendTraceTag(592188749,o.a.msoulscat_Wac_CatchUpFlyout,c.a.Info,JSON.stringify({hasWywaActivities:!!n.length,hasActivityGroups:!!(null==r?void 0:r.activityGroups.length),msg:"requestFeaturedActivityGroups completed",latencyMs:s})),[2,null!==(t=null==r?void 0:r.activityGroups)&&void 0!==t?t:[]]}}))}))},t.prototype.dedupeActivities=function(t){return e=function(t){return t.activityId},n={},t.filter((function(t){var i=e(t);return!n.hasOwnProperty(i)&&(n[i]=!0)}));var e,n},t.prototype.getActivityCreators=function(t){return t.map((function(t){return t.actors[0]})).filter((function(t){return t})).reduce((function(t,e){return t.some((function(t){return N(t,e)}))||t.push(e),t}),[])},t}();function nt(t,e,n,r){var s;return void 0===r&&(r=c.a.Error),Object(i.__awaiter)(this,void 0,void 0,(function(){var c,l;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,t()];case 1:return(c=null!==(s=i.sent())&&void 0!==s?s:void 0)||a.a.sendTraceTag(588391823,o.a.msoulscat_Wac_CatchUpFlyout,r,e+" received null data from "+n+"."),[2,c];case 2:return l=i.sent(),a.a.sendTraceTag(588391824,o.a.msoulscat_Wac_CatchUpFlyout,r,(null==l?void 0:l.message)?e+" received an error. "+(null==l?void 0:l.message):e+" received an error from "+n+" with no message."),[3,3];case 3:return[2,void 0]}}))}))}function it(t){var e;if(t&&st(t,"activityId","Activity")&&st(t,"displayTimestamp","Activity"))return Object(i.__assign)(Object(i.__assign)({},t),{actors:ct(t.actors,rt),relevancy:null!==(e=t.relevancy)&&void 0!==e?e:A.None})}function rt(t){if(t)return Object(i.__assign)({},t)}function at(t){var e;if(t)return Object(i.__assign)(Object(i.__assign)({},t),{reasons:null!==(e=t.reasons)&&void 0!==e?e:[],activities:ct(t.activities,it),contentChanges:ct(t.contentChanges,ot)})}function ot(t){if(t&&st(t,"content","ContentChange"))return Object(i.__assign)(Object(i.__assign)({},t),{changes:ct(t.changes,(function(t){return t}))})}function ct(t,e){var n,i;return null!==(i=null===(n=null==t?void 0:t.map((function(t){return e(t)})))||void 0===n?void 0:n.filter((function(t){return null!=t})))&&void 0!==i?i:[]}function st(t,e,n){return void 0!==t[e]&&null!==t[e]||(f.logTrace({tag:557983766,level:"Error",message:"Essential property "+e+" is null or undefined on "+n+", the object will be set to undefined.",eventCategory:"Error",eventName:g.CatchUpActivityValidationPropMissingError}),!1)}function lt(t){var e,n,r;if(t)return Object(i.__assign)(Object(i.__assign)({},t),{wywaWaterline:null!==(e=t.wywaWaterline)&&void 0!==e?e:void 0,highWaterline:null!==(n=t.highWaterline)&&void 0!==n?n:void 0,lowWaterline:null!==(r=t.lowWaterline)&&void 0!==r?r:void 0,activities:ct(t.activities,it),actors:ct(t.actors,rt)})}function ut(t){var e,n;if(t)return{activityFeedItems:V(null!==(n=null===(e=t.activityFeedItems)||void 0===e?void 0:e.filter((function(t){return!!t})))&&void 0!==n?n:[])}}function gt(t){if(t)return{activityGroups:ct(t.activityGroups,at)}}var ft,pt,ht=function(){function t(t,e){this._activityRequestManager=t,this._changeSummariesDataProvider=e}return t.prototype.getWywaActivities=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,e=this;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,nt((function(){return e._activityRequestManager.requestWYWAActivities()}),"getWywaActivities","requestWYWAActivities")];case 1:return null!==(null==(t=n.sent())?void 0:t.isFirstDocumentOpen)&&void 0!==(null==t?void 0:t.isFirstDocumentOpen)&&a.a.sendTraceTag(578404700,o.a.msoulscat_Wac_CatchUpFlyout,c.a.Info,"Is first document open: "+t.isFirstDocumentOpen),[2,lt(t)]}}))}))},t.prototype.getActivities=function(t,e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var n=this;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,nt((function(){return n._activityRequestManager.requestActivities(t,e)}),"getActivities","requestActivities",c.a.Info)];case 1:return[2,lt(i.sent())]}}))}))},t.prototype.getRelevantActivities=function(t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e=this;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,nt((function(){return e._activityRequestManager.requestRelevantActivities(t)}),"getRelevantActivities","requestRelevantActivities",c.a.Info)];case 1:return[2,lt(n.sent())]}}))}))},t.prototype.getActivityFeedItems=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return[4,nt((function(){return t._activityRequestManager.requestActivityFeed({})}),"getActivityFeedItems","requestActivityFeed")];case 1:return[2,ut(e.sent())]}}))}))},t.prototype.getFeaturedActivityGroups=function(t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e=this;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return this._changeSummariesDataProvider?[4,nt((function(){var n;return null===(n=e._changeSummariesDataProvider)||void 0===n?void 0:n.getFeaturedActivityGroups(t)}),"getFeaturedActivityGroups","getFeaturedActivityGroups")]:[2,void 0];case 1:return[2,gt(n.sent())]}}))}))},t}(),vt=function(){function t(){this._listeners=[]}return t.prototype.fireEvent=function(t){this._listeners.forEach((function(e){return e(t)}))},t.prototype.addListener=function(t){t&&this._listeners.push(t)},t.prototype.removeListener=function(t){this._listeners=this._listeners.filter((function(e){return e!==t}))},t}(),dt=n(0),mt=n(38),At=n(58),Ct=n(545),yt=n(39),bt=n(12),_t=n(4),It=Object(bt.c)((function(t){var e;return{activityIndicatorTooltip:Object(_t.eb)({boxShadow:t?"0px 16px 18px -4px rgba(0, 0, 0, 0.1)":"0px 8px 10px -2px rgba(0, 0, 0, 0.1)",borderRadius:"1px",maxWidth:"176px",zIndex:1,pointerEvents:"none"},_t.f.small),activityIndicatorTooltipContent:Object(_t.eb)({display:"inline-block",margin:"4px 12px 8px 12px"}),activityIndicatorTooltipAuthorNames:Object(_t.eb)({float:"left",clear:"both",fontSize:_t.j.small,fontWeight:_t.k.semibold}),activityIndicatorTooltipEditInfo:Object(_t.eb)({float:"left",clear:"both"}),activityIndicatorTooltipDotContainer:Object(_t.eb)({display:"inline-block",width:"8px",margin:"2px 1px"}),activityIndicatorTooltipDot:Object(_t.eb)({borderRadius:"50%",width:"6px",height:"6px",backgroundColor:"#006BFF",cursor:"default",selectors:(e={},e[_t.l]={backgroundColor:"Highlight"},e)}),activityIndicatorTooltipNewText:Object(_t.eb)({color:"#006BFF",fontSize:_t.j.small,fontWeight:_t.k.semibold,display:"inline",margin:"0px 1px"}),activityIndicatorTooltipChangeText:Object(_t.eb)({fontSize:_t.j.small,fontWeight:_t.k.regular,display:"inline",margin:"0px 4px",color:"#484644"}),activityIndicatorTooltipTimestamp:Object(_t.eb)({float:"left",display:"inline-block",clear:"both",fontSize:_t.j.small,color:"#484644",marginTop:"1px"})}})),Ot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.__extends)(e,t),e.prototype.componentDidMount=function(){Tt.register(this)},e.prototype.componentWillUnmount=function(){Tt.unregister(this)},e.prototype.render=function(){return this.props.formatter(this.props.date)},e}(dt.PureComponent),Tt=new(function(){function t(){this.components=[]}return t.prototype.register=function(t){var e=this;this.components.push(t),void 0===this.timerId&&(this.timerId=window.setInterval((function(){return e.onTimerFired()}),6e4))},t.prototype.unregister=function(t){this.components=this.components.filter((function(e){return e!==t})),this.components.length||window.clearInterval(this.timerId)},t.prototype.onTimerFired=function(){this.components.forEach((function(t){return t.forceUpdate()}))},t}()),Et=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.renderChangeString=function(t,e){return dt.createElement("span",{dir:"auto",className:e},t)},e}return Object(i.__extends)(e,t),e.prototype.convertDirectionalHint=function(t){if(!t)return At.DirectionalHint.leftTopEdge;switch(t){case _.TopLeftEdge:return At.DirectionalHint.topLeftEdge;case _.TopCenter:return At.DirectionalHint.topCenter;case _.TopRightEdge:return At.DirectionalHint.topRightEdge;case _.TopAutoEdge:return At.DirectionalHint.topAutoEdge;case _.BottomLeftEdge:return At.DirectionalHint.bottomLeftEdge;case _.BottomCenter:return At.DirectionalHint.bottomCenter;case _.BottomRightEdge:return At.DirectionalHint.bottomRightEdge;case _.BottomAutoEdge:return At.DirectionalHint.bottomAutoEdge;case _.LeftTopEdge:return At.DirectionalHint.leftTopEdge;case _.LeftCenter:return At.DirectionalHint.leftCenter;case _.LeftBottomEdge:return At.DirectionalHint.leftBottomEdge;case _.RightTopEdge:return At.DirectionalHint.rightTopEdge;case _.RightCenter:return At.DirectionalHint.rightCenter;case _.RightBottomEdge:return At.DirectionalHint.rightBottomEdge;default:return At.DirectionalHint.leftTopEdge}},e.prototype.render=function(){var t=this.props,e=t.anchorTarget,n=t.authorNames,i=t.timestamp,r=t.dateFormatter,a=t.isSticky,o=t.directionalHint,c=t.changeTypesDisplayString,s=t.localizedStrings,l=e.getBoundingClientRect(),u=document.documentElement.scrollTop,g=document.documentElement.scrollHeight>0?document.documentElement.scrollHeight:document.documentElement.clientHeight,f=document.documentElement.scrollTop+g,p=document.documentElement.scrollLeft,h=document.documentElement.scrollLeft+document.documentElement.scrollWidth,v=l.top+l.height/2,d=l.left+l.width/2,m=document.getElementById("AppHeaderPanel"),A=document.getElementById("Ribbon");(m||A)&&(u=u+(m?m.clientHeight:0)+(A?A.clientHeight:0)+5);var C=v>=u&&v<=f&&d>=p&&d<=h,y=It(a),b=this.convertDirectionalHint(o),_=this.renderChangeString(c,y.activityIndicatorTooltipChangeText);return C&&dt.createElement(Ct.a,{target:e,directionalHint:b,isBeakVisible:!1,gapSpace:5,doNotLayer:!0,className:y.activityIndicatorTooltip,role:"alert","aria-live":"polite","aria-atomic":!0,"data-unique-id":"activityIndicatorTooltipContent",bounds:yt.getBoundingWindowWithPaddingFabric},dt.createElement("div",{className:y.activityIndicatorTooltipContent},n&&dt.createElement("div",{className:y.activityIndicatorTooltipAuthorNames},n),dt.createElement("div",{className:y.activityIndicatorTooltipEditInfo},dt.createElement("div",{className:y.activityIndicatorTooltipDotContainer},dt.createElement("div",{className:y.activityIndicatorTooltipDot})),dt.createElement("div",{className:y.activityIndicatorTooltipNewText},s.ActivityFlyoutNew,_)),i&&dt.createElement("div",{className:y.activityIndicatorTooltipTimestamp},dt.createElement(Ot,{date:i,formatter:r}))))},e}(dt.Component),Ut=function(t){function e(e){var n=t.call(this,e)||this;return n.state={tooltips:[]},n}return Object(i.__extends)(e,t),e.prototype.addTooltip=function(t){this.setState((function(e){return{tooltips:Object(i.__spreadArrays)(e.tooltips,[t])}}))},e.prototype.removeTooltips=function(t){this.setState((function(e){return t?{tooltips:[]}:{tooltips:e.tooltips.filter((function(t){return t.isSticky}))}}))},e.prototype.updateTooltip=function(t,e){var n=this.state.tooltips.filter((function(e){return e.anchorTarget.id===t.id}));if(n&&n.length>0){var r=n[0];this.setState((function(n){return r.anchorTarget=t,r.isSticky=e,{tooltips:Object(i.__spreadArrays)(n.tooltips.filter((function(t){return t.anchorTarget.id!==r.anchorTarget.id})),[r])}}))}},e.prototype.render=function(){return dt.createElement(dt.Fragment,null,this.state.tooltips.map((function(t){return dt.createElement(Et,Object(i.__assign)({},t,{key:t.anchorTarget.id}))})))},e}(dt.Component);function Nt(t,e,n,i,r,a,o,c,s){(function(t,e){var n=new Promise((function(e){mt.render(dt.createElement(Ut,{ref:function(t){e(t)}}),t)}));return e?ft=n:pt=n,n})(e,a).then((function(e){return e.addTooltip({anchorTarget:t,authorNames:n,timestamp:i,dateFormatter:r,isSticky:a,directionalHint:o,changeTypesDisplayString:c,localizedStrings:s})}))}var wt=function(){function t(t,e,n){this._catchUpActivityStrings=e,this._dateFormatter=n,this._activityStore=t}return t.prototype.createActivityIndicatorTooltip=function(t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e=this;return Object(i.__generator)(this,(function(n){return t&&t.target&&t.container&&t.activityIds?[2,this.getRecentActivitiesFromIds(t.activityIds).then((function(n){var i=e.getAuthorNames(n),r=e.getLatestTimestamp(n),a=e.getChangeString(n);Nt(t.target,t.container,i,r,e._dateFormatter,t.isSticky,t.dirHint,a,e._catchUpActivityStrings)})).catch((function(t){return a.a.sendTraceTag(587206741,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Error,"createActivityIndicatorTooltip failed, indicator not shown. Error: "+t)}))]:(a.a.sendTraceTag(588305366,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Warning,"Activity Indicator tooltip requested with invalid empty parameters."),[2])}))}))},t.prototype.dismissActivityIndicatorTooltips=function(t){var e;t?(e=t.clearSticky,pt&&pt.then((function(t){return t.removeTooltips(e)})),e&&ft&&ft.then((function(t){return t.removeTooltips(e)}))):a.a.sendTraceTag(575807587,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Error,"dismissActivityIndicatorTooltipsWithParams called with no parameters.")},t.prototype.updateActivityIndicatorTooltip=function(t){var e,n;t&&t.target?(e=t.target,n=t.isSticky,pt&&pt.then((function(t){return t.updateTooltip(e,n)})),ft&&ft.then((function(t){return t.updateTooltip(e,n)}))):a.a.sendTraceTag(588305367,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Warning,"Activity Indicator tooltip Update requested with invalid empty target.")},t.prototype.getRecentActivitiesFromIds=function(t){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return t&&0!==t.length?[4,this._activityStore.getWywaActivities()]:(a.a.sendTraceTag(587206743,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Warning,"Unable to retrieve Activities for empty set of Activity Ids."),[2,[]]);case 1:return[2,e.sent().activities.filter((function(e){return t.indexOf(e.activityId)>-1}))]}}))}))},t.prototype.getAuthorNames=function(t){if(0===t.length)return a.a.sendTraceTag(588305369,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Warning,"Unable to retrieve Author Names for empty set of Activities."),"";var e=t.filter((function(t){return t&&t.actors&&t.actors[0]&&t.actors[0].displayName})).map((function(t){return t.actors[0].displayName}));if((e=e.filter((function(t,e,n){return e===n.indexOf(t)}))).length>0)switch(e.length){case 1:return e[0];case 2:return U.b.apply(void 0,Object(i.__spreadArrays)([this._catchUpActivityStrings.ActivityFlyoutTwoAuthors],e));case 3:return U.b.apply(void 0,Object(i.__spreadArrays)([this._catchUpActivityStrings.ActivityFlyoutThreeAuthors],e));default:return U.b.apply(void 0,Object(i.__spreadArrays)([this._catchUpActivityStrings.ActivityFlyoutFourOrMoreAuthors],e))}return a.a.sendTraceTag(588305370,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Warning,"Unable to retrieve Author Names for the given Activity Ids."),""},t.prototype.getLatestTimestamp=function(t){if(0!==t.length){var e;if(t.length>0&&t[0]&&t[0].displayTimestamp){var n=t.reduce((function(t,e){return e&&e.displayTimestamp&&t&&t.displayTimestamp&&e.displayTimestamp>t.displayTimestamp?e:t}),t[0]);n&&(e=n.displayTimestamp)}return e||a.a.sendTraceTag(588305372,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Warning,"Unable to retrieve valid Timestamp for the given Activity Ids."),e}a.a.sendTraceTag(588305371,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Warning,"Unable to retrieve Timestamp for the empty set of Activities.")},t.prototype.getChangeString=function(t){if(0===t.length)return a.a.sendTraceTag(588305373,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Warning,"Unable to determine changes string with empty set of Activities."),this._catchUpActivityStrings.ActivityFlyoutChanges;for(var e=0,n=0,i=0,r=t;i<r.length;i++){switch(r[i].type){case y.Edit:e+=1;break;case y.Comment:case y.Reply:n+=1}}return e>=1&&n>=1?this._catchUpActivityStrings.ActivityFlyoutEditsAndComments:e>1?this._catchUpActivityStrings.ActivityFlyoutEdits:n>1?this._catchUpActivityStrings.ActivityFlyoutComments:1===e?this._catchUpActivityStrings.ActivityFlyoutEdit:1===n?this._catchUpActivityStrings.ActivityFlyoutComment:(a.a.sendTraceTag(588305374,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Warning,"No supported change types found in the activities."),this._catchUpActivityStrings.ActivityFlyoutChanges)},t}(),kt=n(1678),Ft=n(1682),xt=n(577),St=n.n(xt);var jt=n(345),Rt=Object(bt.c)((function(){var t;return{catchUpNotificationContainer:Object(_t.eb)({boxShadow:"0px 8px 10px -2px rgba(0, 0, 0, 0.1)",borderRadius:"4px"},_t.f.small),catchUpNotificationMessageContainer:Object(_t.eb)({width:"300px"}),catchUpNotificationMessage:Object(_t.eb)({clear:"both"}),catchUpNotificationDotContainer:Object(_t.eb)({display:"inline-block",width:"8px",margin:"2px 1px 2px 1px"}),catchUpNotificationDot:Object(_t.eb)({borderRadius:"50%",width:"6px",height:"6px",backgroundColor:"#4B9CF4",cursor:"default",selectors:(t={},t[_t.l]={backgroundColor:"Highlight"},t)}),catchUpNotificationNewText:Object(_t.eb)({color:"#006BFF",display:"inline",margin:"0px 1px",fontSize:_t.j.medium,fontWeight:_t.k.semibold,lineHeight:"18px",paddingRight:"2px"}),catchUpNotificationMessageText:Object(_t.eb)({color:"#212121",display:"inline",fontSize:_t.j.medium,lineHeight:"18px"}),catchUpNotificationMessageAuthor:Object(_t.eb)({color:"#212121",display:"inline",fontSize:_t.j.medium,fontWeight:_t.k.semibold,lineHeight:"18px"})}}));var Dt,Wt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.calloutRef=dt.createRef(),e.renderAuthorName=function(t,e,n){return dt.createElement("span",{key:e,dir:"auto",className:n},t)},e.getContent=function(){var t=e.props,n=t.authorNames,i=t.localizedStrings,r=Rt(),a=e.generateAuthorsElement(n,i,r.catchUpNotificationMessageAuthor),o=!e.props.hideNewDot;return dt.createElement("div",{id:"catchUpNotificationContainer",className:r.catchUpNotificationMessageContainer},dt.createElement("div",{className:r.catchUpNotificationMessage},o&&dt.createElement("div",{className:r.catchUpNotificationDotContainer},dt.createElement("div",{className:r.catchUpNotificationDot})),o&&dt.createElement("div",{className:r.catchUpNotificationNewText},i.ActivityNotificationNew),a&&dt.createElement("div",{className:r.catchUpNotificationMessageText},a)))},e.focus=function(){e.calloutRef.current&&e.calloutRef.current.focus()},e.onExecute=function(){var t=e.props,n=t.eventCallbacks;(0,t.logUserAction)("CatchUpActiveAwarenessSession"),n.onCatchUpNotificationButtonClicked()},e}return Object(i.__extends)(e,t),e.prototype.generateAuthorsElement=function(t,e,n){var i=this;if(null!=t&&t.length>0){var r=function(t,e){switch(t){case 0:return e.ActivityNotificationText;case 1:return e.ActivityNotificationTextOneName;case 2:return e.ActivityNotificationTextTwoNames;case 3:return e.ActivityNotificationTextThreeNames;case 4:return e.ActivityNotificationTextFourNames;default:return e.ActivityNotificationTextMoreNames}}(t.length,e);return Object(U.a)(r,(function(e,r){return i.renderAuthorName(t[parseInt(e,10)],r,n)}))}return[e.ActivityNotificationText]},e.prototype.render=function(){var t=this.props,e=t.anchorTarget,n=t.hasBeak,i=t.hasButton,r=t.buttonLabel,a=t.localizedStrings,o=t.appColors,c={directionalHint:At.DirectionalHint.bottomRightEdge,isBeakVisible:n,onDismiss:Ht},s=function(t){return{mainContent:{width:300},primaryButton:Object(jt.d)(Object(jt.b)(t),jt.a)}}(o);return dt.createElement(kt.a,{telemetryId:"CatchUpNotificationCallout",expirationSettings:{displayTimeoutSeconds:10,onExpire:function(){}},focus:this.focus,isActionable:!0},dt.createElement(Ft.a,{componentRef:this.calloutRef,target:e,calloutProps:c,title:a.ActivityNotificationTitle,"data-unique-id":"CatchUpNotificationCallout",primaryButtonProps:i?{label:r||a.ActivityNotificationButtonLabel,onExecute:this.onExecute}:void 0,contentRendererFunction:this.getContent,hasDynamicSizing:!0,showCloseIcon:!0,closeButtonProps:St.a?{icon:St.a.CancelGlyph_16,label:""}:void 0,styles:s}))},e}(dt.Component),Mt=function(t){function e(e){var n=t.call(this,e)||this;return n.state={callouts:[]},n}return Object(i.__extends)(e,t),e.prototype.addCatchUpNotificationCallout=function(t){this.setState((function(e){return{callouts:Object(i.__spreadArrays)(e.callouts,[t])}}))},e.prototype.removeCatchUpNotificationCallouts=function(){this.setState({callouts:[]})},e.prototype.render=function(){return dt.createElement(dt.Fragment,null,this.state.callouts.map((function(t){return dt.createElement(Wt,Object(i.__assign)({},t,{key:t.anchorTarget.id}))})))},e}(dt.Component);function Bt(t,e,n,i,r,a,o,c,s,l){var u={anchorTarget:e,authorNames:t,hasBeak:n,hasButton:i,buttonLabel:r,hideNewDot:a,localizedStrings:o,eventCallbacks:c,appColors:s,logUserAction:l},g=document.createElement("div");document.body.appendChild(g),function(t){return Dt=new Promise((function(e){mt.render(dt.createElement(Mt,{ref:function(t){e(t)}}),t)}))}(g).then((function(t){return t.addCatchUpNotificationCallout(u)}))}function Ht(){Dt&&Dt.then((function(t){return t.removeCatchUpNotificationCallouts()}))}var Gt=function(){function t(t,e,n,i){this._activityStore=t,this._catchUpActivityStrings=e,this._appColors=n,this._logUserAction=i,this._onCatchUpNotificationButtonClickEvent=new vt}return t.prototype.showCatchUpNotification=function(t){var e,n,r,s;return Object(i.__awaiter)(this,void 0,void 0,(function(){var l,u,g,f,p,h,v,d;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(!t)return a.a.sendTraceTag(575807585,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Error,"Undefined ShowCatchUpNotificationParameters, not showing the CatchUpNotification."),[2];i.label=1;case 1:return i.trys.push([1,4,,5]),(l=t.authorNames)&&0!==l.length?[3,3]:[4,this._activityStore.getWywaActivities()];case 2:if((u=i.sent()).activities.length<=0)return a.a.sendTraceTag(587206735,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Info,"CatchUpNotification requested with no Author Names and no Recent Activities. Callout not shown."),[2];l=(l=u.activities.filter((function(t){var e;return null===(e=t.actors[0])||void 0===e?void 0:e.displayName})).map((function(t){return t.actors[0].displayName}))).filter((function(t,e,n){return e===n.indexOf(t)})),i.label=3;case 3:return l&&0!==l.length?(g={onCatchUpNotificationButtonClicked:this._onCatchUpNotificationButtonClickEvent.fireEvent.bind(this._onCatchUpNotificationButtonClickEvent,!1)},a.a.sendTraceTag(587206737,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Info,"CatchUpNotification requested to Show."),(f=null!==(e=t.anchorTarget)&&void 0!==e?e:document.querySelector("button[data-unique-id='CatchUpWithChanges']"))?(p=null===(n=t.hasBeak)||void 0===n||n,h=null===(r=t.hasButton)||void 0===r||r,v=null!==(s=t.hideNewDot)&&void 0!==s&&s,Bt(l,f,p,h,t.buttonLabel,v,this._catchUpActivityStrings,g,this._appColors,this._logUserAction),[3,5]):(a.a.sendTraceTag(575796513,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Warning,"CatchUp Notification unable to obtain valid Target for anchoring."),[2])):(a.a.sendTraceTag(587206736,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Warning,"Unable to retrieve Author Names to display CatchUpNotification"),[2]);case 4:return d=i.sent(),a.a.sendTraceTag(587206738,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Error,"showActivityNotification failed, callout not shown. Error: "+d),[3,5];case 5:return[2]}}))}))},t.prototype.dismissCatchUpNotification=function(t){a.a.sendTraceTag(588305365,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Info,"CatchUpNotification requested to be Dismissed."),t?Ht():a.a.sendTraceTag(575807586,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Error,"dismissCatchUpNotification called with no parameters.")},t.prototype.getCatchUpNotificationButtonClick=function(){return this._onCatchUpNotificationButtonClickEvent},t}();function Pt(){var t,e;return null===(e=null===(t=u())||void 0===t?void 0:t.isChangeGateEnabled("CatchUpChangeGate_DarkModeStyling"))||void 0===e||e}var Lt=n(565),zt=n(1863),Qt=function(t){var e=Object(Lt.a)();return dt.createElement(zt.a,{theme:e},t.children)};function qt(t){return"activityId"in t}function Kt(t){return"ranking"in t}function Jt(t,e){var n=Object(O.e)(t,e);return Object(O.g)(t,n)}function Vt(t,e){t&&e.push(t)}function Yt(t){return t.relevantActivities.length>0||t.activityGroups.length>0||t.summaryItemText.length>0}var Zt,Xt=n(572),$t=n(45),te=n(83),ee='"Segoe UI", "Segoe UI Web", Arial, Verdana, sans-serif',ne="#e1dfdd",ie="black",re="#f3f2f1",ae="#605e5c",oe="#006bff28",ce="#006bff",se="#266ff6";var le={color:"#252423",lineHeight:"20px",fontFamily:ee,fontWeight:_t.k.regular,fontSize:_t.j.medium,display:"inline",selectors:(Zt={},Zt[_t.l]=Object(i.__assign)({color:"inherit",backgroundColor:"inherit"},Object(_t.S)()),Zt)},ue=function(t){var e;return{color:t.textColor,lineHeight:"20px",fontFamily:ee,fontWeight:_t.k.regular,fontSize:_t.j.medium,display:"inline",selectors:(e={},e[_t.l]=Object(i.__assign)({color:"inherit",backgroundColor:"inherit"},Object(_t.S)()),e)}},ge=Object(bt.c)((function(t,e){var n,r,a=Object(te.a)(t),o=ue(a);return{button_deprecated:Object(_t.eb)({backgroundColor:"transparent",border:"transparent solid 2px",display:"flex",outline:"none",padding:0,paddingRight:"6px",textAlign:"left",width:"100%",selectors:(n={":hover":{backgroundColor:re}},n[":hover [class^='topRightControls']"]={display:"flex"},n[":focus [class^='topRightControls']"]={display:"flex"},n[":active"]={backgroundColor:ne},n[":focus"]={borderColor:e.showFocus?ie:"transparent"},n["::-moz-focus-inner"]={border:"0"},n[_t.l]=Object(i.__assign)(Object(i.__assign)({borderColor:"ButtonFace",color:"ButtonText"},Object(_t.S)()),{selectors:{":hover":{backgroundColor:"Highlight",color:"HighlightText",borderColor:e.showFocus?"Highlight":"transparent"},":focus":{borderColor:e.showFocus?"Highlight":"transparent"}}}),n)}),button:Object(_t.eb)({backgroundColor:"transparent",border:"transparent solid 2px",display:"flex",outline:"none",padding:0,paddingRight:"6px",textAlign:"left",width:"100%",selectors:(r={":hover":{backgroundColor:a.hoverBackgroundColor}},r[":hover [class^='topRightControls']"]={display:"flex"},r[":focus [class^='topRightControls']"]={display:"flex"},r[":active"]={backgroundColor:a.selectedBackgroundColor},r[":focus"]={borderColor:e.showFocus?t.palette.black:"transparent"},r["::-moz-focus-inner"]={border:"0"},r[_t.l]=Object(i.__assign)(Object(i.__assign)({borderColor:"ButtonFace",color:"ButtonText"},Object(_t.S)()),{selectors:{":hover":{backgroundColor:"Highlight",color:"HighlightText",borderColor:e.showFocus?"Highlight":"transparent"},":focus":{borderColor:e.showFocus?"Highlight":"transparent"}}}),r)}),contentChangeContainer_deprecated:Object(_t.eb)(Object(i.__assign)(Object(i.__assign)({},le),{color:ae,fontSize:_t.j.small,lineHeight:"16px",marginBottom:"3px",maxHeight:(16*e.contextPreviewLines).toString()+"px",overflow:"hidden"})),contentChangeContainer:Object(_t.eb)(o,{color:a.textSecondaryColor,fontSize:_t.j.small,lineHeight:"16px",marginBottom:"3px",maxHeight:(16*e.contextPreviewLines).toString()+"px",overflow:"hidden"})}})),fe=Object(bt.c)((function(t){return{listContainer:Object(_t.eb)({overflow:"auto",maxHeight:(t.heightOfItems*t.numberOfItems).toString()+"px"}),list:Object(_t.eb)({selectors:{":focus":{outline:"0"},"::-moz-focus-inner":{border:"0"}}})}})),pe=Object(bt.c)((function(t){var e,n,r,a,o=Object(te.a)(t),c=ue(o);return{noChangesItemContainer:Object(_t.eb)({padding:"0px 20px 0px 20px",selectors:(e={":focus":{outline:"0"},"::-moz-focus-inner":{border:"0"}},e[_t.l]=Object(i.__assign)({color:"WindowText"},Object(_t.S)()),e)}),textContents:Object(_t.eb)({display:"flex",flexDirection:"column",marginTop:"4px",marginBottom:"1px",width:"100%"}),centeredTextContents_deprecated:Object(_t.eb)({alignItems:"center",display:"flex",minHeight:"44px",width:"100%"}),summaryTextContents:Object(_t.eb)({alignItems:"center",display:"flex",minHeight:"44px",paddingBottom:"2px",paddingTop:"2px",width:"100%"}),inlineText_deprecated:Object(_t.eb)(Object(i.__assign)({},le)),inlineText:Object(_t.eb)(c),summaryText_deprecated:Object(_t.eb)(Object(i.__assign)(Object(i.__assign)({},le),{paddingBottom:"2px",paddingTop:"2px"})),actorNameText_deprecated:Object(_t.eb)(Object(i.__assign)(Object(i.__assign)({},le),{fontWeight:_t.k.semibold})),actorNameText:Object(_t.eb)(c,{fontWeight:_t.k.semibold}),timeStamp_deprecated:Object(_t.eb)(Object(i.__assign)(Object(i.__assign)({},le),{color:ae,fontSize:_t.j.small,lineHeight:"16px",marginBottom:"3px"})),timeStamp:Object(_t.eb)(c,{color:o.textSecondaryColor,fontSize:_t.j.small,lineHeight:"16px",marginBottom:"3px"}),topRightControls:Object(_t.eb)({displayName:"topRightControls",display:"none",height:"16px",marginTop:"4px",marginRight:"4px"}),topRightIconButton:{root:[{width:16,height:16,margin:"0 2px"}]},topRightIconSelected:{root:[{color:"red",fontSize:14,width:14,height:14}]},topRightIcon:{root:[{fontSize:14,width:14,height:14}]},cornerControls:Object(_t.eb)({display:"flex",height:"24px",marginTop:"10px",marginRight:"8px"}),newDotContainer:Object(_t.eb)({alignItems:"center",display:"flex",height:"inherit",justifyContent:"center",width:"18px",minWidth:"18px"}),newDot:Object(_t.eb)({backgroundColor:ce,borderRadius:"50%",height:"4px",width:"4px",selectors:(n={},n[_t.l]=Object(i.__assign)({backgroundColor:"ButtonText"},Object(_t.S)()),n)}),summaryItemIcon:Object(_t.eb)({height:"24px",width:"24px",minWidth:"24px",borderRadius:"50%",backgroundColor:se,display:"flex",justifyContent:"center",alignItems:"center",marginLeft:"18px",selectors:(r={},r[_t.l]=Object(i.__assign)(Object(i.__assign)({border:"0.5px solid WindowText",backgroundColor:"Window"},Object(_t.S)()),{selectors:{"svg > path.OfficeIconColors_HighContrast":{fill:"WindowText !important"}}}),r)}),icon:{width:"12px"},contentChange:Object(_t.eb)({backgroundColor:oe,selectors:(a={},a[_t.l]=Object(i.__assign)({color:"ButtonFace",backgroundColor:"ButtonText"},Object(_t.S)()),a)})}}));function he(t){if(t.activities&&t.activities.length)return t.activities[0]}var ve=n(1044),de=n(1190);function me(t){if(!t||!t.displayName)return dt.createElement(dt.Fragment,null);var e=t.color||t.id&&function(t){for(var e=0,n=0;n<t.length;n+=1)e+=t.charCodeAt(n);var i=["#d47800","#3834d1","#981788","#058249","#8c00e3","#1050ca","#878303","#0b6f98","#2c26a4","#ed6b4f","#b339c2","#393939","#0b6a0b","#b86487","#1c0b75","#74757a","#912e5c","#7e7969","#705b00","#2e568e"];return i[e%i.length]}(t.id);return dt.createElement(de.a,{coinSize:24,initialsColor:e||void 0,hidePersonaDetails:!0,imageInitials:Object(ve.a)(t.displayName,!1),imageShouldStartVisible:!0,imageUrl:t.imageUrl||void 0,showInitialsUntilImageLoads:!0})}function Ae(t,e,n){if(e.displayName){var i=e.displayName;return Object(U.a)(t,(function(t){return function(t){return dt.createElement("span",{key:t,dir:"auto",className:n},i)}(t)}))}f.logTrace({tag:560215314,level:"Error",message:"Missing display name rendering action element.",eventCategory:"Error",eventName:g.CatchUpMissingDisplayNameError})}function Ce(t,e){return t.displayTimestamp?e(new Date(t.displayTimestamp)):(f.logTrace({tag:560215315,level:"Warning",message:"Missing display timestamp.",eventCategory:"Generic",eventName:g.CatchUpMissingDisplayTimestamp}),"")}function ye(t,e){var n=[];if(!t||!t.content)return n;var i=t.content;if(!t.changes||!t.changes.length)return Vt(i,n),n;var r,a=0;return(r=t.changes,r.sort((function(t,e){return t||e?t?e?t.start-e.start:-1:1:0}))).forEach((function(t){t&&(t.start<0||t.end>i.length?f.logTrace({tag:560215308,level:"Warning",message:"Invalid change indices - start:"+t.start+", end:"+t.end+", content size:"+i.length,eventCategory:"Generic",eventName:g.CatchUpInvalidChangeIndices}):t.start<a?f.logTrace({tag:560215309,level:"Warning",message:"Overlapping content changes provided",eventCategory:"Generic",eventName:g.CatchUpOverlappingContentChanges}):(a<t.start&&Vt(i.substring(a,t.start),n),Vt(e(i.substring(t.start,t.end)),n),a=t.end))})),Vt(i.substring(a),n),n}function be(t,e,n){if(!t.contentChanges||!t.contentChanges.length)return[];var i=function(t){return Object(U.b)(e.CatchUpFlyoutNewContentA11yPlaceholderLabel,t)},r=0;return function(t,e,n){var i=[];if(!t.length)return i;for(var r=0;r<t.length;r+=1)i.push.apply(i,ye(t[r],n)),r<t.length-1&&Vt(e,i);return i}(t.contentChanges," ",(function(t){return r+=1,dt.createElement("span",{className:n,dir:"auto","aria-label":i(t),key:r},t)}))}var _e=function(t){var e,n=t.activityGroup,i=t.dateFormatter,r=t.flyoutItemId,a=t.flyoutStrings,o=t.hasKeyboardNavStarted,c=t.onItemClicked,s=t.onKeyDown,l=dt.useCallback((function(){c(n)}),[n,c]),u=Object(Lt.a)(),p=he(n);if(!(null===(e=null==p?void 0:p.actors)||void 0===e?void 0:e.length)||!p.actors[0])return dt.createElement(dt.Fragment,null);var h=p.actors[0],v=function(t,e){return t.reasons&&t.reasons.length||f.logTrace({tag:560215312,level:"Warning",message:"No reasons exist on FeaturedActivityGroup to determine action string",eventCategory:"Generic",eventName:g.CatchUpNoReasonsInActivityGroup}),e.CatchUpFlyoutFeaturedEditItem}(n,a),d=function(t){return r+t},m=d("Action"),A=d("Time"),C=d("ContentChange"),y=d("Dot"),b=[m,A,C,y].join(" "),_=pe(u),I=ge(u,{showFocus:o,contextPreviewLines:1});return dt.createElement("div",{id:d("Container")},dt.createElement("button",{id:r,type:"button",onKeyDown:s,className:Pt()?I.button:I.button_deprecated,onClick:l,"aria-labelledby":b},dt.createElement("div",{className:_.cornerControls},dt.createElement("div",{className:_.newDotContainer},!n.isClicked&&dt.createElement("span",{id:y,className:_.newDot,"aria-label":a.CatchUpFlyoutNewDotA11yLabel,role:"img"})),me(h)),dt.createElement("div",{className:_.textContents},dt.createElement("div",{id:m,className:Pt()?_.inlineText:_.inlineText_deprecated},Ae(v,h,Pt()?_.actorNameText:_.actorNameText_deprecated)||a.ActivityNotificationText),dt.createElement("div",{id:A,className:Pt()?_.timeStamp:_.timeStamp_deprecated},Ce(p,i)),dt.createElement("div",{id:C,className:Pt()?I.contentChangeContainer:I.contentChangeContainer_deprecated},be(n,a,_.contentChange)))))},Ie=dt.memo((function(t){var e=t.flyoutStrings,n=t.onKeyDown,i=Object(Lt.a)();if(!e||!e.NoChangesByOthers)return f.logTrace({tag:560215317,level:"Error",message:"Missing string resource in NoChangesItem.",eventCategory:"Error",eventName:g.CatchUpMissingNoChangesItemStringError}),dt.createElement(dt.Fragment,null);var r=pe(i);return dt.createElement("div",{id:"flyoutItem",className:r.noChangesItemContainer,tabIndex:0,onKeyDown:n,"data-unique-id":"no-changes-item"},dt.createElement("div",{className:r.textContents},dt.createElement("div",{className:Pt()?r.inlineText:r.inlineText_deprecated},e.NoChangesByOthers)))})),Oe=n(255),Te=function(t){var e=t.activity,n=t.updateActivityState,i=Object(Lt.a)(),r=pe(i);return dt.createElement("div",{className:r.topRightControls},dt.createElement(Oe.a,{onClick:function(t){t.stopPropagation(),e?n(e,0):f.logTrace({tag:556562181,level:"Error",message:"Null activity during flagged action",eventCategory:"Error",eventName:g.CatchUpFlyoutTriageIconsNullActivityError})},styles:r.topRightIconButton,iconProps:{iconName:"Flag",styles:r.topRightIcon}}),dt.createElement(Oe.a,{onClick:function(t){t.stopPropagation(),e?n(e,0):f.logTrace({tag:556562182,level:"Error",message:"Null activity during complete action",eventCategory:"Error",eventName:g.CatchUpFlyoutTriageIconsNullActivityError})},styles:r.topRightIconButton,iconProps:{iconName:"Accept",styles:r.topRightIcon}}))},Ee=function(t){var e=t.activity,n=t.dateFormatter,i=t.flyoutItemId,r=t.flyoutStrings,a=t.hasKeyboardNavStarted,o=t.isTriageModelEnabled,c=t.onItemClicked,s=t.onKeyDown,l=t.updateActivityState,u=dt.useCallback((function(){c(e)}),[e,c]),g=Object(Lt.a)();if(!(e&&e.actors&&e.actors.length&&e.actors[0]))return dt.createElement(dt.Fragment,null);var f=e.actors[0],p=S(e,r),h=!e.isClicked&&e.relevancy===A.New,v={showFocus:a,contextPreviewLines:1},d=function(t){return i+t},m=d("Action"),C=d("Time"),y=d("Dot"),b=[m,C,y].join(" "),_=pe(g);return dt.createElement("div",{id:d("Container")},dt.createElement("button",{id:i,type:"button",onKeyDown:s,className:Pt()?ge(g,v).button:ge(g,v).button_deprecated,onClick:u,"aria-labelledby":b},dt.createElement("div",{className:_.cornerControls},dt.createElement("div",{className:_.newDotContainer},h&&dt.createElement("span",{id:y,className:_.newDot,"aria-label":r.CatchUpFlyoutNewDotA11yLabel,role:"img"})),me(f)),dt.createElement("div",{className:_.textContents},dt.createElement("div",{id:m,className:Pt()?_.inlineText:_.inlineText_deprecated},Ae(p,f,Pt()?_.actorNameText:_.actorNameText_deprecated)||r.ActivityNotificationText),dt.createElement("div",{id:C,className:Pt()?_.timeStamp:_.timeStamp_deprecated},Ce(e,n))),o&&dt.createElement(Te,{activity:e,updateActivityState:l})))},Ue=n(173),Ne=function(t){var e=t.flyoutItemId,n=t.hasKeyboardNavStarted,i=t.iconName,r=t.onKeyDown,a=t.onSummaryItemClicked,o=t.summaryText,c=Object(Lt.a)();if(!o)return f.logTrace({tag:560215316,level:"Error",message:"Missing string resource in SummaryItem.",eventCategory:"Error",eventName:g.CatchUpMissingSummaryItemStringError}),dt.createElement(dt.Fragment,null);var s=e+"Text",l={showFocus:n,contextPreviewLines:1},u=pe(c);return dt.createElement("div",null,dt.createElement("button",{id:e,type:"button",onKeyDown:r,className:Pt()?ge(c,l).button:ge(c,l).button_deprecated,onClick:a,"data-unique-id":"summary-item","aria-labelledby":s},dt.createElement("div",{className:u.cornerControls},dt.createElement("div",{className:u.summaryItemIcon},dt.createElement(Ue.a,{iconName:i,style:u.icon}))),dt.createElement("div",{id:s,className:Pt()?u.summaryTextContents:u.centeredTextContents_deprecated},dt.createElement("div",{className:Pt()?u.inlineText:u.summaryText_deprecated},o))))},we=function(t){function e(e){var n=t.call(this,e)||this;return n._currentFocus=0,n._itemCount=0,n._itemIds=[],n.getContent=function(){n._itemCount=0;var t=n.props,e=t.flyoutData,i=t.flyoutStrings,r=e.activityGroups,a=e.relevantActivities,o=e.summaryItemText,c={heightOfItems:67,numberOfItems:5},s=function(t){return dt.createElement("div",{id:"catchUpFlyoutContainer",className:fe(c).listContainer,"data-is-scrollable":!0},t)};if(!Yt(e))return s(dt.createElement(Ie,{flyoutStrings:i,onKeyDown:n.onKeyDown}));var l=[];return a.length>0&&l.push.apply(l,n.renderRelevantToMeItems(a)),r.length>0&&l.push.apply(l,n.renderFeaturedActivityGroups(r)),o.length>0&&l.push(n.renderSummaryItem(o)),s(dt.createElement(Xt.a,{"aria-label":i.CatchUpFlyoutListA11yLabel,className:fe(c).list,id:"catchUpFlyoutList",items:l,onKeyDown:n.onKeyDown,onRenderCell:n.onRenderCell}))},n.onRenderCell=function(t,e){return t},n.onKeyDown=function(t){var e,i=[$t.a.up,$t.a.down,$t.a.space,$t.a.tab,$t.a.enter,$t.a.home,$t.a.end,$t.a.f6,$t.a.escape],r=null!==(e=t.keyCode)&&void 0!==e?e:t.which;if(-1!==i.indexOf(r))if(r!==$t.a.escape){if(!n.state.hasKeyboardNavStarted)return n.setState({hasKeyboardNavStarted:!0},(function(){n.focusOnCurrentElement()})),t.preventDefault(),void t.stopPropagation();switch(r){case $t.a.down:n._currentFocus=(n._currentFocus+1)%n._itemCount,n.focusOnCurrentElement();break;case $t.a.up:n._currentFocus=n._currentFocus-1<0?n._itemCount-1:n._currentFocus-1,n.focusOnCurrentElement();break;case $t.a.home:n._currentFocus=0,n.focusOnCurrentElement();break;case $t.a.end:n._currentFocus=n._itemCount-1,n.focusOnCurrentElement();break;case $t.a.f6:return;case $t.a.space:case $t.a.enter:var a=document.getElementById("flyoutItem"+n._currentFocus);a&&a.click();break;case $t.a.tab:if(t.shiftKey){n._currentFocus=n._currentFocus-1<0?n._itemCount-1:n._currentFocus-1,n.focusOnCurrentElement();break}n._currentFocus=(n._currentFocus+1)%n._itemCount,n.focusOnCurrentElement()}t.preventDefault(),t.stopPropagation()}else{var o=document.querySelector(n.props.anchorTarget);o&&o.focus()}},n.focusOnCurrentElement=function(){var t=document.getElementById("flyoutItem"+n._currentFocus);t&&t.focus()},n.state={hasKeyboardNavStarted:!1},n}return Object(i.__extends)(e,t),e.prototype.getNextId=function(){return this._itemCount>=this._itemIds.length&&this._itemIds.push("flyoutItem"+this._itemCount),this._itemCount+=1,this._itemIds[this._itemCount-1]},e.prototype.renderRelevantToMeItems=function(t){var e=this,n=this.props,i=n.dateFormatter,r=n.eventCallbacks,a=n.flyoutStrings,o=n.isTriageModelEnabled;return t.map((function(t){return dt.createElement(Ee,{activity:t,dateFormatter:i,flyoutItemId:e.getNextId(),flyoutStrings:a,hasKeyboardNavStarted:e.state.hasKeyboardNavStarted,isTriageModelEnabled:o,key:t.activityId||"",onItemClicked:r.onItemClicked,onKeyDown:e.onKeyDown,updateActivityState:r.updateActivityState})}))},e.prototype.renderFeaturedActivityGroups=function(t){var e=this,n=this.props,i=n.dateFormatter,r=n.eventCallbacks,a=n.flyoutStrings;return t.map((function(t){return dt.createElement(_e,{activityGroup:t,dateFormatter:i,flyoutItemId:e.getNextId(),flyoutStrings:a,hasKeyboardNavStarted:e.state.hasKeyboardNavStarted,key:t.ranking,onItemClicked:r.onItemClicked,onKeyDown:e.onKeyDown})}))},e.prototype.renderSummaryItem=function(t){var e=this.props,n=e.eventCallbacks,i=e.summaryItemIconName;return dt.createElement(Ne,{flyoutItemId:this.getNextId(),hasKeyboardNavStarted:this.state.hasKeyboardNavStarted,iconName:i||"",key:"SummaryItemId",onKeyDown:this.onKeyDown,onSummaryItemClicked:n.onSummaryTextClicked,summaryText:t})},e.prototype.render=function(){var t=this.props,e=t.anchorTarget,n=t.flyoutData,i=t.flyoutStrings,r=t.eventCallbacks,a=t.shouldShowAsNotification,o={"aria-roledescription":a?i.Notification:void 0,directionalHint:At.DirectionalHint.bottomRightEdge,isBeakVisible:!0,onDismiss:r.dismissCatchUpFlyout,preventDismissOnScroll:!0,setInitialFocus:!a},c=Yt(n)?"#catchUpFlyoutList":'[data-unique-id="no-changes-item"]',s=dt.createElement(Ft.a,{actionableAnnouncement:a?i.Actionable:void 0,calloutProps:o,contentRendererFunction:this.getContent,"data-unique-id":"CatchUpFlyout",firstFocusElement:c,hasDynamicSizing:!0,styles:{mainContent:{width:"354px",margin:"-20px",paddingBottom:"20px",paddingTop:"16px"}},target:e,title:i.CatchUpFlyoutTitle});return a&&(s=dt.createElement(kt.a,{isActionable:!0,onShow:r.onNotificationShown,telemetryId:"CatchUpFlyout"},s)),s},e}(dt.Component);function ke(t){var e=(new Date).getTime()-t.getTime();return e<0?-1:e}function Fe(t,e,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){var r,a,o;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(r=void 0,a=void 0,e&&Kt(e)){if(!(r=he(e)))return f.logTrace({tag:559436957,level:"Error",message:"Unable to get activity from FeaturedActivityGroup.",eventCategory:"Error",eventName:g.CatchUpNoActivityForFeaturedGroupError}),[2,!1];a=e.locationId}else e&&qt(e)&&(r=e);return r||n||f.logTrace({tag:559436958,level:"Error",message:"No activity provided when clicking on item in the flyout",eventCategory:"Error",eventName:g.CatchUpNoActivityForItemClickError}),[4,t.navigateToActivity({activity:r,locationId:a,fromSummaryString:n})];case 1:return(o=i.sent())&&o===C.Success?[2,!0]:(f.logTrace({tag:595637663,level:"Warning",message:"Failed to navigate to "+(e?qt(e)?"activity":"group":"undefined")+", result="+o+".",eventCategory:"Generic",eventName:g.CatchUpNavToItemFailed}),[2,!1])}}))}))}function xe(t){t?f.logTrace({tag:595638497,level:"Info",message:"CatchUpFlyout is requested to be dismissed.",eventCategory:"Generic",eventName:g.CatchUpFlyoutDismissedCalled}):f.logTrace({tag:595638496,level:"Info",message:"CatchUpFlyout is requested to be rendered.",eventCategory:"Generic",eventName:g.CatchUpFlyoutRenderCalled})}var Se=function(t){var e=t.catchUpFlyoutData,n=t.dateFormatter,r=t.disableDismissOnClick,a=t.featureGateAPI,o=t.flyoutFocus,c=t.flyoutRibbonButton,s=t.flyoutStrings,u=t.getCatchUpFlyoutData,p=t.isTriageModelEnabled,h=t.logUserAction,d=t.navigationManager,m=t.summaryItemIconName,A=c(),C=o(),y=d(),b=a(),_=dt.useState(e),I=_[0],T=_[1],E=dt.useState(!1),U=E[0],N=E[1],w=dt.useState(!1),k=w[0],F=w[1],x=dt.useState(!1),S=x[0],j=x[1],R=dt.useState(new Date),D=R[0],W=R[1];dt.useEffect((function(){if(b.isChangeGateEnabled("CatchUpChangeGate_GetFlyoutDataRefactorEnabled")){l(b),N(!0),A.onFlyoutInitialized({}),A.registerButtonClickedEvent({buttonClickedCallback:function(){xe(k),F((function(t){return!t}))}});var t=Yt(I);A.logFlightTriggers({hasFlyoutData:t}),t&&(j(!0),F(!0))}else{l(b),Object(i.__awaiter)(void 0,void 0,void 0,(function(){var t,e;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return[4,u()];case 1:return t=n.sent(),T(t),N(!0),A.onFlyoutInitialized({}),A.registerButtonClickedEvent({buttonClickedCallback:function(){xe(k),F((function(t){return!t}))}}),e=Yt(t),A.logFlightTriggers({hasFlyoutData:e}),e?(j(!0),F(!0),[2]):[2]}}))})).catch((function(t){f.logTrace({tag:559436961,level:"Error",message:"Exception thrown in CatchUpFlyoutContainer initialization hook: "+t+".",eventCategory:"Error",eventName:g.CatchUpFlyoutContainerInitError})}))}}),[]);var M=dt.useCallback((function(){k&&W(new Date),k?null==C||C.enableF6Focus({}):null==C||C.disableF6Focus({}),A.onFlyoutVisibilityChanged({flyoutIsVisible:k})}),[k,C,A]);dt.useEffect((function(){U&&(k&&S&&v(),k&&!S&&h("CatchUpActiveAwarenessSession"),!k&&S&&j(!1),S&&k||M())}),[k]);var B={anchorTarget:"button[data-unique-id='CatchUpWithChanges']",eventCallbacks:{onItemClicked:function(t){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return r||F(!1),[4,Fe(y,t,!1)];case 1:return e=n.sent(),T(e?function(e){return function(t,e){var n=t.relevantActivities;qt(e)&&(n=n.map((function(t){var n=e.activityId===t.activityId||t.isClicked;return Object(i.__assign)(Object(i.__assign)({},t),{isClicked:n})})));var r=t.activityGroups;return Kt(e)&&(r=r.map((function(t){var n=e.ranking===t.ranking||t.isClicked;return Object(i.__assign)(Object(i.__assign)({},t),{isClicked:n})}))),Object(i.__assign)(Object(i.__assign)({},t),{relevantActivities:n,activityGroups:r})}(e,t)}:function(e){return function(t,e){var n=t.relevantActivities;qt(e)&&e.activityId&&(n=Jt(n,(function(t){return t.activityId===e.activityId})));var r=t.activityGroups;return Kt(e)&&(r=Jt(r,(function(t){return t.ranking===e.ranking}))),Object(i.__assign)(Object(i.__assign)({},t),{relevantActivities:n,activityGroups:r})}(e,t)}),function(t,e,n){qt(e)&&f.logTrace({tag:595638498,level:"Info",message:JSON.stringify({msg:"RelevantToMeItem is clicked.",activityIndex:Object(O.e)(t.relevantActivities,(function(t){return t.activityId===e.activityId})),activityLocation:e.location?JSON.stringify(e.location):"Unknown",activityRelevancy:e.relevancy,activityTimestamp:e.displayTimestamp,activityType:e.type,flyoutShowTimeMs:ke(n)}),eventCategory:"Generic",eventName:g.CatchUpRelevantToMeItemClicked}),Kt(e)&&f.logTrace({tag:591528799,level:"Info",message:JSON.stringify({msg:"FeaturedActivityGroup is clicked.",activityGroupIndex:Object(O.e)(t.activityGroups,(function(t){return t.ranking===e.ranking}))+t.relevantActivities.length,flyoutShowTimeMs:ke(n)}),eventCategory:"Generic",eventName:g.CatchUpFeaturedActivityGroupClicked})}(I,t,D),h("CatchUpActiveAwarenessSession"),[2]}}))}))},onSummaryTextClicked:function(){return Object(i.__awaiter)(void 0,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return r||F(!1),[4,Fe(y,I.summaryNavActivity,!0)];case 1:return t.sent(),function(t,e){f.logTrace({tag:595637976,level:"Info",message:JSON.stringify({msg:"Summary text is clicked.",authorCount:t.authorCount,changesCount:t.catchUpActivitiesCount,flyoutShowTimeMs:ke(e)}),eventCategory:"Generic",eventName:g.CatchUpSummaryTextClicked})}(I,D),h("CatchUpActiveAwarenessSession"),[2]}}))}))},dismissCatchUpFlyout:function(){F(!1)},onNotificationShown:M,updateActivityState:function(t,e){}},flyoutData:I,dateFormatter:n,flyoutStrings:s,shouldShowAsNotification:S,isTriageModelEnabled:null!=p&&p,summaryItemIconName:m};return Pt()?U&&k?dt.createElement(Qt,null,dt.createElement(we,Object(i.__assign)({},B))):dt.createElement(dt.Fragment,null):U&&k?dt.createElement(we,Object(i.__assign)({},B)):dt.createElement(dt.Fragment,null)},je=n(54),Re=function(){function t(){}return t.prototype.isChangeGateEnabled=function(t){return Object(je.c)("CatchUpOfficeOnlineDisabledChangeGates",t)},t.prototype.isFeatureGateEnabled=function(t,e){return void 0===e&&(e=!1),Object(je.d)(t,e)},t}();function De(){return new Re}var We=n(82);function Me(t,e,n,r,a,o,c,s,l,u,g){var p,h;return Object(i.__awaiter)(this,void 0,void 0,(function(){var v,d,m=this;return Object(i.__generator)(this,(function(A){return t.flyoutEnabled?(g&&f.setLogger(g),catchupActivitySprite&&(Object(_t.jb)({icons:Object(We.iconSpriteToReactMap)(catchupActivitySprite)}),catchupActivitySprite=void 0),v=document.createElement("div"),document.body.appendChild(v),d=function(){return Object(i.__awaiter)(m,void 0,void 0,(function(){var e,n,r,a;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,W(c,o,s,null!==(e=t.featuredActivityGroupsEnabled)&&void 0!==e&&e,null===(n=t.summaryStringEnabled)||void 0===n||n,null===(r=t.includeRelevantAuthorsInSummaryString)||void 0===r||r,null!==(a=t.activityFeedDataEnabled)&&void 0!==a&&a)];case 1:return[2,i.sent()]}}))}))},mt.render(dt.createElement(Se,{catchUpFlyoutData:e,getCatchUpFlyoutData:d,dateFormatter:l,disableDismissOnClick:null!==(p=t.disableDismissOnClick)&&void 0!==p&&p,featureGateAPI:De,isTriageModelEnabled:null!==(h=t.triageModelEnabled)&&void 0!==h&&h,flyoutFocus:r,flyoutRibbonButton:n,flyoutStrings:s,logUserAction:u,navigationManager:a,summaryItemIconName:St.a.ActivityGlyphWhite_16}),v),[2]):[2]}))}))}function Be(t){return{Actionable:t.Actionable,ActivityNotificationText:t.ActivityNotificationText,CatchUpFlyoutAssignTaskItem:t.CatchUpFlyoutAssignTaskItem,CatchUpFlyoutCommentReplyItem:t.CatchUpFlyoutCommentReplyItem,CatchUpFlyoutCompleteTaskItem:t.CatchUpFlyoutCompleteTaskItem,CatchUpFlyoutCompleteTaskUserCreatedItem:t.CatchUpFlyoutCompleteTaskUserCreatedItem,CatchUpFlyoutCreatedTaskReopenedItem:t.CatchUpFlyoutCreatedTaskReopenedItem,CatchUpFlyoutFeaturedEditItem:t.CatchUpFlyoutFeaturedEditItem,CatchUpFlyoutListA11yLabel:t.CatchUpFlyoutListA11yLabel,CatchUpFlyoutMentionItem:t.CatchUpFlyoutMentionItem,CatchUpFlyoutNewContentA11yPlaceholderLabel:t.CatchUpFlyoutNewContentA11yPlaceholderLabel,CatchUpFlyoutNewDotA11yLabel:t.CatchUpFlyoutNewDotA11yLabel,CatchUpFlyoutOnePersonChange:t.CatchUpFlyoutOnePersonChange,CatchUpFlyoutTwoPeopleChange:t.CatchUpFlyoutTwoPeopleChange,CatchUpFlyoutThreePeopleChange:t.CatchUpFlyoutThreePeopleChange,CatchUpFlyoutFourPeopleChange:t.CatchUpFlyoutFourPeopleChange,CatchUpFlyoutMultiplePeopleChange:t.CatchUpFlyoutMultiplePeopleChange,CatchUpFlyoutReassignTaskUserCreatedItem:t.CatchUpFlyoutReassignTaskUserCreatedItem,CatchUpFlyoutReassignTaskItem:t.CatchUpFlyoutReassignTaskItem,CatchUpFlyoutReopenTaskItem:t.CatchUpFlyoutReopenTaskItem,CatchUpFlyoutReplyToTaskItem:t.CatchUpFlyoutReplyToTaskItem,CatchUpFlyoutSelfAssignedTaskItem:t.CatchUpFlyoutSelfAssignedTaskItem,CatchUpFlyoutTitle:t.CatchUpFlyoutTitle,CommentAction:t.CommentAction,EditAction:t.EditAction,NoChangesByOthers:t.NoChangesByOthers,Notification:t.Notification,RestoreAction:t.RestoreAction}}n(1409);var He=function(){function t(){}return t.prototype.logTrace=function(t,e){var n=t;if(n.tag&&n.level&&n.message){if(n.category||(n.category=o.a.msoulscat_Wac_CatchUpFlyout),e){var i=JSON.stringify({errorMessage:e.message,errorStack:e.stack});n.message.concat(n.message,i)}var r=this.getULSTraceLevel(n.level);a.a.sendTraceTag(n.tag,n.category,r,n.message)}else a.a.sendTraceTag(556363853,o.a.msoulscat_Wac_CatchUpFlyout,c.a.Error,"Undefined tag and/or level and/or message in tryLogEvent: "+n)},t.prototype.getULSTraceLevel=function(t){switch(t){case"Error":return c.a.Error;case"Warning":return c.a.Warning;case"Info":return c.a.Info;case"Verbose":return c.a.Verbose;case"Spam":return c.a.Spam;default:return a.a.sendTraceTag(556363854,o.a.msoulscat_Wac_CatchUpFlyout,c.a.Error,"Unknown trace level set, defaulting to level 0"),0}},t}(),Ge=function(){function t(t,e,n,i,r,o,c,s,l,u,g,f,p,h,v){this._activityRequestManager=t,this._activityNavigationManager=e,this._activityContentManager=n,this._changeSummariesDataProvider=i,this._flyoutRibbonButton=r,this._flyoutFocus=o,this._catchUpActivityStrings=l,this._notificationStrings=g,this._appColors=p,this._logUserAction=h,this._options=v,this._onWywaActivitiesReadyEvent=new vt,this._onCatchUpNotificationButtonClickEvent=new vt,a.a.setLogger(f);var d=new Q.a(c,s,u);this._dateFormatter=d.format.bind(d),this._activityStore=new et(new ht(this._activityRequestManager,this._changeSummariesDataProvider)),this._catchUpActivityLogger=new He}return t.prototype.initialize=function(t){var e,n,r,s;return Object(i.__awaiter)(this,void 0,void 0,(function(){var l,u,g,f,p,v,d,m,A,C,y,b,_,I,O=this;return Object(i.__generator)(this,(function(T){switch(T.label){case 0:return[4,this._activityStore.getWywaActivities()];case 1:if(l=T.sent(),h("WywaReadyEvent"),this._onWywaActivitiesReadyEvent.fireEvent({wywaActivities:l.activities,authors:l.authors}),!t)return a.a.sendTraceTag(578044767,o.a.msoulscat_Wac_WacCatchUpActivities,c.a.Error,"Undefined CatchUpConfiguration, not initializing the flyout."),[2];if(!this._activityStore)throw new Error("No ActivityCache when initializing CatchUp flyout.");if(!(u=this._activityNavigationManager))throw new Error("Null ActivityNavigationManager when initializing CatchUp flyout.");return(g=this._flyoutRibbonButton)?(f={relevantActivities:[],genericActivities:[],activityGroups:[],summaryNavActivity:void 0,summaryItemText:"",authorCount:0,catchUpActivitiesCount:0},De().isChangeGateEnabled("CatchUpChangeGate_GetFlyoutDataRefactorEnabled")?[4,W(this._activityStore,this._activityContentManager,Be(Object(i.__assign)(Object(i.__assign)({},this._catchUpActivityStrings),this._notificationStrings)),null!==(e=t.featuredActivityGroupsEnabled)&&void 0!==e&&e,null===(n=t.summaryStringEnabled)||void 0===n||n,null===(r=t.includeRelevantAuthorsInSummaryString)||void 0===r||r,null!==(s=t.activityFeedDataEnabled)&&void 0!==s&&s).catch((function(t){a.a.sendTraceTag(555074974,o.a.msoulscat_Wac_CatchUpFlyout,c.a.Error,"Failed to get Flyout data: "+t)}))]:[3,3]):(a.a.sendTraceTag(579350726,o.a.msoulscat_Wac_CatchUpFlyout,c.a.Error,"FlyoutRibbonButton is null."),[2]);case 2:(p=T.sent())&&(f=p),T.label=3;case 3:return t.dynamicEntryPointEnabled&&this._options.onCatchUpEntryStringChanged&&(v=f.relevantActivities,d=f.genericActivities,m=f.authorCount,A=f.catchUpActivitiesCount,C=H(v,d),y=C[0],b=C[1],_=b?b.displayName+" "+y:y,I=_||"You're all caught up",this._options.onCatchUpEntryStringChanged(I),a.a.sendTraceTag(554833996,o.a.msoulscat_Wac_CatchUpFlyout,c.a.Info,JSON.stringify({message:"Initialized dynamic entry point data",peopleMadeChanges:m,activityCount:A,genericActivityCount:d.length,relevantActivityCount:v.length}))),[4,Me(t,f,(function(){return g}),(function(){return O._flyoutFocus}),(function(){return u}),this._activityContentManager,this._activityStore,Be(Object(i.__assign)(Object(i.__assign)({},this._catchUpActivityStrings),this._notificationStrings)),this._dateFormatter,this._logUserAction,this._catchUpActivityLogger)];case 4:return T.sent(),[2]}}))}))},t.prototype.getActivityIndicatorTooltipManager=function(){return this._activityIndicatorTooltipManager||(this._activityIndicatorTooltipManager=new wt(this._activityStore,this._catchUpActivityStrings,this._dateFormatter)),this._activityIndicatorTooltipManager},t.prototype.getCatchUpNotificationManager=function(){return this._catchUpNotificationManager||(this._catchUpNotificationManager=new Gt(this._activityStore,this._catchUpActivityStrings,this._appColors,this._logUserAction)),this._catchUpNotificationManager},t.prototype.getActivityStore=function(){return this._activityStore},t.prototype.getWywaEvent=function(){return this._onWywaActivitiesReadyEvent},t.prototype.getActivityNotificationButtonClick=function(){return this._onCatchUpNotificationButtonClickEvent},t.prototype.setWebpackPublicPath=function(t){t&&Object(q.a)(t)},t}(),Pe=n(1826),Le=n(1652),ze=n(924),Qe=n(358),qe={onCatchUpEntryStringChanged:function(t){Object(ze.a)(Qe.a)([Object(Pe.a)("CatchUpWithChanges",t),Object(Le.a)("CatchUpWithChanges",!1)])}},Ke=function(){function t(){}return t.createCatchUpApp=function(t,e,n,i,r,a,o,c,s,l,u,g){return void 0===g&&(g=qe),new Ge(t,e,n,i,r,a,o,c,CatchupActivityStrings,FriendlyDatesStrings,NotificationStrings,s,l,u,g)},t}(),Je=n(94);var Ve={shade30:"#094624",shade20:"#0C5F32",shade10:"#0F703B",primary:"#107C41",tint10:"#218D51",tint20:"#55B17E",tint30:"#A0D8B9",tint40:"#CAEAD8"},Ye=new(function(){function t(){}return t.prototype.getExcelCatchUpAppInstance=function(t){if(excelCatchupActivitySprite&&(Object(_t.jb)({icons:Object(We.iconSpriteToReactMap)(excelCatchupActivitySprite)}),excelCatchupActivitySprite=void 0),t&&t.activityRequestManager&&t.uiCulture&&t.dataCulture&&t.ulsLogger)return Ke.createCatchUpApp(t.activityRequestManager,t.activityNavigationManager,t.activityContentManager,t.changeSummariesDataProvider,t.flyoutRibbonButton,t.flyoutFocus,t.uiCulture,t.dataCulture,t.ulsLogger,Ve,Je.logUserAction)},t}());n.d(e,"FactoryGlobal",(function(){return Ye}))},577:function(t,e){t.exports={CancelGlyph_16:"CancelGlyph_16",MissingIcon_20:"MissingIcon_20",ChangesPaneComment_20:"ChangesPaneComment_20",ChangesPaneEdit_20:"ChangesPaneEdit_20",ChangesPaneMention_20:"ChangesPaneMention_20",ChangesPaneRestore_20:"ChangesPaneRestore_20",ActivityGlyphWhite_16:"ActivityGlyphWhite_16"}},94:function(t,e){t.exports=otel}},[[1608,2,0,1]]]);
//# sourceMappingURL=catchUpActivity.min.js.map