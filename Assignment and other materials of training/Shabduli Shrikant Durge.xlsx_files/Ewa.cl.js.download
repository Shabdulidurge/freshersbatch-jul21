typeof IEnumerable=="undefined"&&(IEnumerable=function(){},IEnumerable.registerInterface("IEnumerable"));typeof IEnumerator=="undefined"&&(IEnumerator=function(){},IEnumerator.registerInterface("IEnumerator"));typeof Sys=="undefined"&&Type.registerNamespace("Sys");typeof Sys.IEnumerable$1=="undefined"&&(Sys.IEnumerable$1=function(){},Sys.IEnumerable$1.registerInterface("Sys.IEnumerable$1"));typeof Sys.IEnumerator$1=="undefined"&&(Sys.IEnumerator$1=function(){},Sys.IEnumerator$1.registerInterface("Sys.IEnumerator$1"));Type.registerNamespace("_Ewa");_Ewa.ue=function(){};_Ewa.nT=function(){};_Ewa.ue.registerClass("_Ewa.ue");_Ewa.nT.registerClass("_Ewa.nT");Type.registerNamespace("_Ewa");_Ewa.DZ=function(){};_Ewa.bcE=function(){};Type.registerNamespace("Common.App.CoauthTelemetry");Common.App.CoauthTelemetry.e=function(n){this.g=Function.createDelegate(this,this.k);this.h=Function.createDelegate(this,this.m);this.c={};this.d={};this.f=n};Common.App.CoauthTelemetry.e.prototype={e:null,f:null,b:null,a:function(n){var t=new($$sc.D.$$(Number)),i=this;return this.l().CW(function(){n in i.c?t.d(i.c[n]):i.d[n]=t}),t.a},l:function(){if(this.b)return this.b.a;this.b=new($$sc.D.$$(Object));var n=this;return this.f.CW(function(){n.e=n.f.a();n.e.b(n.h);n.i();n.b.b(null)}),this.b.a},i:function(){var t=this.e.a(),n;for(t.sort(this.g),this.c={},n=0;n<t.length;n++){if(!t[n]||!t[n].h())return;this.j(this.c,t[n].a(),n)}},j:function(n,t,i){n[t]=i;t in this.d&&(this.d[t].d(i),delete this.d[t])},m:function(){this.i()},k:function(n,t){var i=n,r=t;return i.p>r.p?1:i.p<r.p?-1:0}};Common.App.CoauthTelemetry.d=function(n,t,i,r,u,f,e,o,s){this.t=Function.createDelegate(this,this.x);this.n=Function.createDelegate(this,this.y);this.u=n;this.b=new($$sc.D.$$(Common.eE));this.g=i;this.e=t;this.o=r;this.r=u;this.f=f;this.l=e;this.p=o;this.j=!1;this.k=!1;this.d=0;this.i=1;this.h=s;this.m=this.g.a("PeoplesWellExtraButtonInfoIsEnabled")};Common.App.CoauthTelemetry.d.prototype={u:null,b:null,e:null,g:null,o:null,r:null,f:null,l:null,p:null,m:!1,c:null,q:null,s:null,i:0,k:!1,j:!1,d:0,h:null,a:function(){var n=this;$$sc.a.WAA.call(null,this.l,this.e,this.f).CW(function(){n.c=n.l.a();n.q=n.e.a();n.s=n.f.a();$$sc.a.WAA.call(null,n.e.a().bi(),n.f.a().a()).CW(function(){n.i=n.q.bi().a();n.d=n.s.a().a();n.c.b(n.n);n.c.a().length&&n.v()})})},y:function(){this.v()},v:function(){var n=this.p(this.c.a());n?(this.c.c(this.n),this.w(this.j)):this.b.d(1);this.j=!0},w:function(n){var t,i;if(this.k){t=this;this.b.a.CW(function(){Diag.a.a(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",Common.eE.toString(t.b.a.a()))});return}this.k=!0;i=!this.i&&!n;this.z(i)},z:function(n){n?this.o.a(4,this.t,3):this.b.d(1)},x:function(){var i=this.r.b("AppInitStatus_"+Common.App.b.toString(4)),t,n;Diag.a.b(42259235,325,!!this.d,null);t=this.d-i;n={};n.InteractiveTime=i;n.ReactRenderComplete=this.d;n.HadTabSwitch=this.h();n.IsModernGallery=this.m;Diag.a.a(594883104,325,50,Common.H.b(n));this.m?(Diag.a.a(42062997,325,15,t.toString()),this.b.d(this.A(t)?3:2)):Diag.a.a(594883103,325,15,t.toString())},A:function(n){var i=this.g.c("CoauthorGalleryTimeToRenderDurationMs",1e4),t=n>i;return this.h()?(Diag.a.a(50455714,325,50,t.toString()),!1):(t&&(Diag.a.a(42062998,325,15,n.toString()),Common.j.a().recordQosError("CoauthorGalleryTimeToRenderDurationIsTooLong",["CoauthGalleryExperienceDegraded"],!1,!0,!0,!1,null)),t)}};Common.App.CoauthTelemetry.a=function(n,t){this.c=Function.createDelegate(this,this.f);this.b=n;this.d=t};Common.App.CoauthTelemetry.a.a=function(n){for(var t,i,r=null,f=n,e=f.length,u=0;u<e;++u)if(t=f[u],t)if(i=t.f()||!t.b()?t.a():t.b().toUpperCase(),r){if(r!==i)return!0}else r=i;return!1};Common.App.CoauthTelemetry.a.prototype={a:null,d:null,b:null,e:function(){var n=this;this.b.CW(function(){n.a=n.b.a();n.a.b(n.c)})},f:function(){Common.App.CoauthTelemetry.a.a(this.a.a())&&(this.a.c(this.c),this.d.IsRealCoauthSession=!0)}};Common.App.CoauthTelemetry.g=function(){};Common.App.CoauthTelemetry.g.a=function(){Common.App.a.a().a(new Common.App.CoauthTelemetry.g,0,!1)};Common.App.CoauthTelemetry.g.prototype={a:function(){return"Common.App.CoauthTelemetry"},c:function(n){var u=this,t,i,r;n.c(Common.App.CoauthTelemetry.a,null).c(Common.App.CoauthTelemetry.h,null).a().b(function(){return new Common.App.CoauthTelemetry.a(Common.Utils.b.a(Common.cd,n.b(Common.cd,null)),Common.a.f)});t=this;n.c(Common.App.CoauthTelemetry.d,null).c(Common.fL,null).a().b(function(){return new Common.App.CoauthTelemetry.d(Common.a.c(),Common.Utils.b.a(Common.dm,n.b(Common.dm,null)),Common.a.a,Common.App.AppLifecycleManager.get_instance(),Common.bk.a(),Common.Utils.b.a(Common.ei,n.b(Common.ei,null)),Common.Utils.b.a(Common.cd,n.b(Common.cd,null)),Common.App.CoauthTelemetry.a.a,function(){return t.d()})});i=this;n.c(Common.App.CoauthTelemetry.f,null).c(Common.App.CoauthTelemetry.b,null).a().b(function(){return new Common.App.CoauthTelemetry.f(Common.Utils.b.a(Common.dm,n.b(Common.dm,null)),Common.Utils.b.a(Common.ej,n.b(Common.ej,null)),Common.Utils.b.a(Common.cd,n.b(Common.cd,null)),Common.App.AppLifecycleManager.get_instance(),n.a(Common.App.CoauthTelemetry.c,null),Common.bk.a(),function(){return i.d()},Common.a.a,null,Common.j.a())});r=this;n.c(Common.App.CoauthTelemetry.e,null).c(Common.App.CoauthTelemetry.c,null).a().b(function(){return new Common.App.CoauthTelemetry.e(Common.Utils.b.a(Common.cd,n.b(Common.cd,null)))})},b:function(){var n=this;Common.a.a.k(function(){Common.Utils.a.a().a(Common.App.CoauthTelemetry.a,null).e();Common.a.a.a("CoauthorGalleryTelemetryIsEnabled")&&Common.Utils.a.a().a(Common.fL,null).a();Common.a.a.a("CashTelemetryIsEnabled")&&(Common.Utils.a.a().a(Common.App.CoauthTelemetry.b,null),Common.Utils.a.a().a(Common.App.CoauthTelemetry.c,null))})},d:function(){if(Common.ba.b()&&Common.bk.a().c("UserActions")){var n=Common.bk.a().b("UserActions");return n.VisiToggled>0}return!1}};Common.App.CoauthTelemetry.f=function(n,t,i,r,u,f,e,o,s,h){var c,l,a,v;this.B=Function.createDelegate(this,this.M);this.z=Function.createDelegate(this,this.J);this.A=Function.createDelegate(this,this.L);this.t={};this.i={};this.q=new($$sc.v.$$(String));c=this;this.x=new($$sc.z.$$(Number))(function(){return o.e("PresenceBootLatencyThreshold",1e4)});l=this;this.p=new($$sc.z.$$(Number))(function(){return o.e("PresenceBootLatencyCutoffThreshold",6e4)});a=this;this.w=new($$sc.z.$$(Number))(function(){return o.e("PresenceLightupLatencyThreshold",2e3)});v=this;this.o=new($$sc.z.$$(Number))(function(){return o.e("PresenceLightupLatencyCutoffThreshold",1e4)});this.n=r;this.s=u;this.j=n;this.m=t;this.l=i;this.r=f;this.d=s;this.h=e;this.k=h;this.g=!1;this.F()};Common.App.CoauthTelemetry.f.prototype={j:null,m:null,f:null,l:null,e:null,g:!1,d:null,c:null,n:null,s:null,b:null,r:null,u:0,v:0,x:null,p:null,w:null,o:null,h:null,k:null,a:function(n,t,i,r){i&&(Diag.a.b(42274970,302,!this.d||this.d===i,"_myClientId is already set and you are trying to update it to something different"),this.d=i);var u=new($$sc.D.$$(Boolean)),f=this;return this.F().CW(function(){f.K(n);f.H(u,n,t,r)}),u.a},C:function(){return this.d||"{"+Common.a.j+"}"},F:function(){var i,n,t;return this.c?this.c.a:(this.c=new($$sc.D.$$(Object)),this.h()&&Diag.a.a(50951700,302,15,"TabSwitched Session"),i=this,this.j.CW(function(){var n=i.j.a(),t=n.bi(),r=n.bY();r.CW(function(){t.CW(function(){i.k&&i.k.addQosPillar(Common.QosPillarName.toString(6));i.N(t.a(),r.a());i.c.b(null)})})}),n=this,this.m.CW(function(){n.f=n.m.a();n.f.e(n.A);n.f.a(n.z)}),t=this,this.l.CW(function(){t.e=t.l.a();t.e.b(t.B);t.e.a().length>0&&t.G()}),this.c.a)},D:function(){if(this.b)return this.b.a;this.b=new($$sc.D.$$(Number));var n=this;return this.n.a(4,function(){var t=n.r.b("AppInitStatus_"+Common.App.b.toString(4));n.b.d(t)},3),this.b.a},L:function(n,t){if(!this.g&&t.a===2){var r=this.D(),i=this;r.CW(function(){var t=r.a(),u=Date.now()-t,n={};n.clientId=i.C();n.bootTime=u;i.g=!0;i.f.k(15,n,!1)})}},J:function(n,t){if(t.a===15){var r=Date.now(),i=t.b,u=i.clientId,f=i.bootTime,e=this.y(u);e.m(r-f)}},M:function(){this.G()},G:function(){for(var n,r,e,u,o=Date.now(),s=this.e.a(),t=new($$sc.v.$$(String)),f=s,h=f.length,i=0;i<h;++i)n=f[i],this.q.c(n.a())||(this.q.b(n.a()),t.b(n.a()));if(t.f.length>0)for(r=t.$$lge();r.$$mn();)e=r.$$cu(),u=this.y(e),u.k()||u.o(o)},K:function(n){var t=this.y(n);t.j()||t.n(Date.now())},y:function(n){if(!(n in this.i))return this.i[n]=new Common.App.CoauthTelemetry.j(n,this.w,this.o);return this.i[n]},N:function(n,t){this.u=n;this.v=t?t:(new Date).getTime()},H:function(n,t,i,r){var f=i?i.getTime():(new Date).getTime(),u;if(!(t in this.t)){u=new Common.App.CoauthTelemetry.i(t,this.I(),f,this.E(this.C()),this.E(t),this.x,this.p,r,this.h);this.t[t]=u;u.m(n);return}n.f()},I:function(){return this.u===1?$$sc.a.a(Number,this.v):this.D()},E:function(n){return this.s.a(n)}};Common.App.CoauthTelemetry.i=function(n,t,i,r,u,f,e,o,s){this.j=n;this.f=t;this.a=i;this.b=r;this.d=u;this.g=f;this.e=e;this.i=o;this.h=s};Common.App.CoauthTelemetry.i.prototype={c:0,f:null,g:null,e:null,k:!1,a:0,b:null,d:null,i:0,j:null,h:null,m:function(n){var t=this;$$sc.a.WAA(this.f,this.b,this.d).CW(function(){var r,i,u,f,e;if(t.b.a()<=t.d.a()){n.d(!1);return}t.c=t.f.a();r=t.a-t.c;i=new Common.App.CoauthTelemetry.PL;i.id=t.j;i.et=t.a;i.st=t.c;i.d=t.a-t.c;i.mp=t.b.a();i.tp=t.d.a();i.ct=t.l(t.i);i.vc=t.h();u=JSON.stringify(i);Diag.a.a(42078597,302,15,u);r>t.g.a()&&!t.k&&!i.vc&&(t.k=!0,n.d(!0),e=(f=new Common.X,f.extendedProperties=new Map,f),e.extendedProperties.set("data",u),Common.j.a().recordQosError("PresenceRenderDurationIsTooLong",["PresenceExperienceDegraded"],!1,!0,!1,!1,e),r<t.e.a()&&Diag.a.a(42078598,302,15,Common.App.CoauthTelemetry.VD.a(r,t.g.a(),t.e.a())));n.a.b>3||n.d(!1)})},l:function(n){switch(n){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}}};Common.App.CoauthTelemetry.PL=function(){};Common.App.CoauthTelemetry.PL.prototype={id:null,et:0,st:0,mp:0,tp:0,d:0,ct:null,vc:!1};Common.App.CoauthTelemetry.VD=function(){};Common.App.CoauthTelemetry.VD.a=function(n,t,i){var r=new Common.App.CoauthTelemetry.VD;return r.d=n,r.vt=t,r.ct=i,JSON.stringify(r)};Common.App.CoauthTelemetry.VD.prototype={d:0,vt:0,ct:0};Common.App.CoauthTelemetry.j=function(n,t,i){this.h=n;this.e=t;this.d=i};Common.App.CoauthTelemetry.j.prototype={h:null,a:0,c:0,b:0,e:null,d:null,g:0,f:0,m:function(n){return this.a=n,this.i(),n},o:function(n){return this.c=n,this.i(),n},n:function(n){return this.b=n,this.i(),n},k:function(){return!!this.g},j:function(){return!!this.f},i:function(){!this.k()&&this.a&&this.c&&(this.g=this.l(this.c,"CoauthGalleryLightupDurationTooLong"));!this.j()&&this.a&&this.b&&(this.f=this.l(this.b,"CanvasPresenceLightupDurationTooLong"))},l:function(n,t){var r=n-this.a,i=new Common.App.CoauthTelemetry.PL,u,e,f,o;return(i.id=this.h,i.et=n,i.st=this.a,i.d=r,u=JSON.stringify(i),t==="CanvasPresenceLightupDurationTooLong"?Diag.a.a(572289499,302,15,u):Diag.a.a(571524118,302,15,u),r>this.e.a())?(f=(e=new Common.X,e.extendedProperties=new Map,e),f.extendedProperties.set("data",u),o=r<this.d.a(),f.extendedProperties.set("cash",o?"true":"false"),Common.j.a().recordQosError(t,["PresenceExperienceDegraded"],!1,!0,!1,!1,f),Diag.a.a(572289500,302,15,Common.App.CoauthTelemetry.VD.a(r,this.e.a(),this.d.a())),o?2:1):3}};Common.App.CoauthTelemetry.e.registerClass("Common.App.CoauthTelemetry.e",null,Common.App.CoauthTelemetry.c);Common.App.CoauthTelemetry.d.registerClass("Common.App.CoauthTelemetry.d",null,Common.fL);Common.App.CoauthTelemetry.a.registerClass("Common.App.CoauthTelemetry.a",null,Common.App.CoauthTelemetry.h);Common.App.CoauthTelemetry.f.registerClass("Common.App.CoauthTelemetry.f",null,Common.App.CoauthTelemetry.b);Common.App.CoauthTelemetry.i.registerClass("Common.App.CoauthTelemetry.i");Common.App.CoauthTelemetry.PL.registerClass("Common.App.CoauthTelemetry.PL");Common.App.CoauthTelemetry.VD.registerClass("Common.App.CoauthTelemetry.VD");Common.App.CoauthTelemetry.j.registerClass("Common.App.CoauthTelemetry.j");Common.App.CoauthTelemetry.g.a();Type.registerNamespace("Common.App.CollabControls");Common.App.CollabControls.l=function(){};Common.App.CollabControls.l.registerInterface("Common.App.CollabControls.l");Common.App.CollabControls.m=function(){};Common.App.CollabControls.c=function(){};Common.App.CollabControls.c.prototype={multipleBrowsersImageClassName:0,peopleImageClassName:1,peopleImageClusterPath:4,multipleBrowserImageClusterPath:5,imageDimension:6,rtl:8,pointerInputManager:9,clickInputManager:10,vertical:11,zIndex:12,contextMenuInputManager:13,imageDomElement:14,useIdleTooltip:15,viewportBoundsCallback:16,flipHorizontalDirection:17,fixRemoveFadeOutElementCrash:18};Common.App.CollabControls.c.registerEnum("Common.App.CollabControls.c",!1);Common.App.CollabControls.i=function(n){this.K=Function.createDelegate(this,this.bn);Common.App.CollabControls.i.initializeBase(this);this.l=n};Common.App.CollabControls.i.a=function(n,t){return n+(t?"Rtl":"")};Common.App.CollabControls.i.prototype={l:null,bv:function(){return this.l},bl:function(){return this.l.style.visibility==="visible"},H:function(n){return this.l.style.visibility=n?"visible":"hidden",n},bm:function(n){return this.l.dir=n?"rtl":"ltr",n},dispose:function(){this.l&&this.l.parentNode&&this.l.parentNode.removeChild(this.l);this.l=null;Common.bc.prototype.dispose.call(this)},ba:function(n){return this.l.ownerDocument.createElement(n)},bn:function(){return!0}};Common.App.CollabControls.e=function(n,t){Common.App.CollabControls.e.initializeBase(this);this.a=n;this.b=t};Common.App.CollabControls.e.prototype={a:0,b:null};Common.App.CollabControls.f=function(n,t,i){this.O=Function.createDelegate(this,this.S);this.z=Function.createDelegate(this,this.br);this.o=[];Common.App.CollabControls.f.resolveInheritance();this.a=this.bv;Common.App.CollabControls.f.initializeBase(this,[n]);this.D={};this.Q=i;this.E=i.b(8,!1);this.P=i.b(15,!1);this.A=i.b(12,0);this.t=i.b(6,0);this.bb=t;this.R=i.b(16,null);this.V=i.b(17,!1);this.I=0;this.W=new Common.App.CollabControls.j(this.E,this.V);this.B=this.be();this.M=!1;this.q=[];this.C=[];this.l.id=Common.App.CollabControls.f.b();this.l.className=Common.App.CollabControls.i.a("prControl",this.E);this.A&&(this.l.style.zIndex=this.A);this.bm(this.E);this.bt(t);this.r=this.ba("div");this.r.className="prFlyoutContainer";this.l.appendChild(this.r);this.p=[];this.u=new Common.App.CollabControls.k(this.p,this.l,this.t,4,6,32,this.E);this.x=i.b(9,null);this.x.a("msospPointerDown",this.u.a,this.z);this.x.a("msospPointerOver",this.u.a,this.z);this.x.a("msospPointerOut",this.u.a,this.z)};Common.App.CollabControls.f.b=function(){return String.format("{0}-{1}","presencetooltip",Common.App.CollabControls.f.a++)};Common.App.CollabControls.f.prototype={E:!1,w:!1,L:!1,s:!1,bb:0,I:0,F:!1,P:!1,V:!1,M:!1,D:null,r:null,u:null,q:null,C:null,W:null,B:0,x:null,Q:null,R:null,c:function(){return Common.B.c(this.o)},p:null,A:0,t:0,v:function(){return this.p?this.p.length:0},y:function(){return this.v()>0?this.p[0].b:5},bd:function(){return this.y()===3&&!this.w},dispose:function(){var t;if(this.bd()){this.M=!0;return}if(this.p)for(var i=this.p,r=i.length,n=0;n<r;++n)t=i[n],t.A(this.O),System.a.a(t);this.p=null;this.x.b("msospPointerDown",this.u.a,this.z);this.x.b("msospPointerOver",this.u.a,this.z);this.x.b("msospPointerOut",this.u.a,this.z);Common.App.CollabControls.i.prototype.dispose.call(this)},i:function(){this.G(!1);this.H(!0)},h:function(){this.H(!0);this.bc();this.w=!0},e:function(){this.bi(5);this.bf();this.u.i(this.y(),this.F)},b:function(n){var u=this.y(),f=this.w,i,r,t;if(n.n||(n.n=(Common.App.CollabControls.f.a++).toString()),i=0,n.n in this.D&&(i=this.N(n.n),i>=0)){if(r=this.o[i],r.r===n.r&&r.o===n.o)return;this.f(n.n)}this.e();t=new Common.App.CollabControls.a(this.ba("div"),this.Q);t.D(this.O);this.r.insertBefore(t.l,this.r.firstChild);this.D[n.n]=t;Array.add(this.o,n);Array.add(this.p,t);this.bk(u,f);this.H(!0)},f:function(n){if(this.bd()){Array.add(this.C,n);return}var t=this.y(),i=this.w;this.e();this.bj(n);this.bk(t,i)},bk:function(n,t){this.o.length<=0?this.e():n===3&&t?this.h():this.i()},g:function(n,t){t?this.bo(n):this.bh(n)},d:function(n){n!==this.L&&(this.L=n,this.Y(n))},j:function(n,t){this.l.style.top=t+"px";this.l.style.left=n+"px"},G:function(n){var i,t;if(!n||this.s){this.L&&this.Y(!0);var r=Math.min(3,this.v())-1,u=0,f=1,e=0;for(this.F&&(u=this.B,f=-1,e=-this.t),i=this.v()-1;i>r;i--)this.p[i].C(this.o[i],r*-4*f+e,0,!0,!1,!0,u);for(t=r;t>=0;t--)this.p[t].C(this.o[t],t*-4*f+e,0,t>0,Array.contains(this.q,this.o[t].n),t!==this.I,u);this.I=0;this.u.i(0,this.F);this.l.style.zIndex=this.A;this.w=!1;this.bi(0);this.M&&this.dispose()}},bc:function(){var t,i,r,u,f,e,n;for(this.L&&this.Y(!1),this.l.style.zIndex=this.A+1,this.bu(u={val:i},f={val:t},e={val:r}),i=u.val,t=f.val,r=e.val,n=0;n<this.v();n++)this.p[n].V(this.o[n],i,t+(this.t+2)*n,n!==this.I,r)},bf:function(){var t=0,i=0,n;for(this.F&&(t=this.B,i=-6),n=0;n<this.v();n++)this.p[n].M(this.o[n],i,t);this.l.style.zIndex=this.A;this.w=!1;this.H(!1);this.M&&this.dispose()},X:function(n){if(n){this.s=!0;var t=this;$$sc.a.b(n).CW(function(){t.P?t.bq():t.G(!0);t.s=!1})}else this.P?this.e():this.G(!1)},bq:function(){this.s&&this.e()},S:function(n,t){var i=this.y(),r;t.a===2||t.a===4&&i!==3?(this.s&&(this.s=!1),i!==3&&(this.bc(),t.b.b===3&&this.X(2e3))):t.a===4&&i===3?(this.s&&(this.s=!1),this.X(0)):t.a===3&&i===3&&(this.w||(this.v()>1?(this.s=!0,r=this,$$sc.a.b(250).CW(function(){r.G(!0);r.s=!1})):this.X(0)));this.k("InteractivityChanged",t,null)},br:function(n){return n.b===3?this.S(this,new Common.App.CollabControls.e(4,n)):n.d==="msospPointerOver"?this.S(this,new Common.App.CollabControls.e(2,n)):n.d==="msospPointerOut"&&this.S(this,new Common.App.CollabControls.e(3,n)),!1},bt:function(n){this.l.style.width=n+"px";this.l.style.height=this.t+"px"},bj:function(n){var t,r,i;(this.bh(n),t=this.N(n),t<0)||(r=this.o[t],Array.removeAt(this.o,t),delete this.D[r.n],i=this.p[t],this.r.removeChild(i.l),this.Q.b(18,!1)&&i.A(this.O),Array.removeAt(this.p,t),i.dispose())},bi:function(n){if(this.C.length){this.bl()&&this.bf();for(var t=0;t<this.C.length;t++)this.bj(this.C[t]);Array.clear(this.C);this.o.length<=0||n===5?this.e():n||this.i()}},N:function(n){for(var t=0;t<this.o.length;t++)if(this.o[t].n===n)return t;return-1},bg:function(n){var t,r,i;n in this.D&&(t=this.N(n),t&&(r=this.o[t],i=this.D[n],Array.removeAt(this.o,t),Array.insert(this.o,0,r),Array.removeAt(this.p,t),Array.insert(this.p,0,i),this.r.removeChild(i.l),this.r.appendChild(i.l),this.G(!1)))},bo:function(n){if(this.N(n)===-1){Diag.a.a(41706451,302,15,"Cannot set active editor because client id is invalid");return}if(Array.contains(this.q,n)){if(this.o[0].n===n)return;Array.remove(this.q,n)}Array.add(this.q,n);this.bg(n);this.y()!==1&&this.G(!1)},bh:function(n){if(this.N(n)===-1){Diag.a.a(41706452,302,50,"Cannot remove active editor because client id is invalid");return}if(Array.contains(this.q,n)){if(Array.remove(this.q,n),this.o[0].n===n&&this.q.length>0){var t=this.q[this.q.length-1];this.bg(t)}this.o[0].n===n&&this.y()===1&&this.G(!1)}},Y:function(n){n?Sys.UI.DomElement.addCssClass(this.r,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.r,"prBackgroundSelection")},bu:function(n,t,i){var u,f,r;if(n.val=0,t.val=0,i.val=this.B,this.R){if(u=this.R(this),!u)return;f=this.y()===4;r=this.W.g(this.v(),f?6:this.t,this.t,150,2,this.l,u);t.val=r.a;this.I=this.bp(r.c,r.a);i.val=r.b;i.val!==this.B&&(this.bs(i.val),this.l.dir=i.val===3?"rtl":"ltr",this.B=i.val);i.val!==this.be()?(n.val=f?-6:-this.t,this.F=!0):this.F=!1}},bp:function(n,t){if(n===1)return this.v()-1;var i=Math.abs(t);return i>0?i/(this.t+2):0},bs:function(n){for(var t=0;t<this.v();t++)this.p[t].S(n)},be:function(){return this.E?3:4}};Common.App.CollabControls.b=function(){};Common.App.CollabControls.b.h=function(n,t,i,r){return Common.App.CollabControls.b.i(n,t,i,r)};Common.App.CollabControls.b.i=function(n,t,i,r){var u=document.createElementNS(Common.App.CollabControls.b.a,"svg");return u.setAttribute("viewBox",String.format(Common.App.CollabControls.b.f,Common.App.CollabControls.b.c,Common.App.CollabControls.b.b)),u.appendChild(Common.App.CollabControls.b.j(n,t,i,r)),u};Common.App.CollabControls.b.j=function(n,t,i,r){var e=Common.App.CollabControls.b.c/n,h=t/2*e,c=Common.App.CollabControls.b.b/2,o=0,f,u,s;for(r&&(o=(n-t*3-i*4)*e/2),f=document.createElementNS(Common.App.CollabControls.b.a,"g"),f.setAttribute("class",Common.App.CollabControls.b.e),u=1;u<=3;u++)s=o+(u*(t+i)-t/2)*e,f.appendChild(Common.App.CollabControls.b.g(u,h,s,c));return f};Common.App.CollabControls.b.g=function(n,t,i,r){var u=document.createElementNS(Common.App.CollabControls.b.a,"circle");return u.setAttribute("class",String.format("{0}-{1}",Common.App.CollabControls.b.d,n)),u.setAttribute("cx",String.format("{0}",i)),u.setAttribute("cy",String.format("{0}",r)),u.setAttribute("r",String.format("{0}",t)),u};Common.App.CollabControls.g=function(n){this.b=n;this.b.d(10,Common.i.a());this.b.d(9,Common.f.a());this.b.d(6,20);this.b.d(13,Common.bj.a());this.b.d(17,!1)};Common.App.CollabControls.g.prototype={b:null,a:function(n,t){return this.b.d(15,t),new Common.App.CollabControls.f(n,20,this.b)}};Common.App.CollabControls.a=function(n,t){this.u=Function.createDelegate(this,this.Q);this.t=Function.createDelegate(this,this.P);this.s=Function.createDelegate(this,this.O);this.r=Function.createDelegate(this,this.N);Common.App.CollabControls.a.initializeBase(this,[n]);this.q=t.b(8,!1);this.f=t.b(6,0);this.w=t.b(15,!1);this.z=t;this.o=0;this.l=n;this.l.className=Common.App.CollabControls.a.h;this.a=document.createElement("span");this.l.appendChild(this.a);this.v=Common.App.CollabControls.b.h(t.b(6,0),4,2,!0);this.R(t);this.b=5};Common.App.CollabControls.a.prototype={g:null,e:null,j:null,z:null,a:null,p:null,v:null,f:0,q:!1,w:!1,i:null,o:0,c:null,D:function(n){this.m("InteractivityChanged",n)},A:function(n){this.n("InteractivityChanged",n)},y:null,b:0,dispose:function(){this.l&&(this.g.b("click",this.l,this.r),this.g.b("dblclick",this.l,this.K),this.e.b("msospPointerDown",this.l,this.s),this.e.b("msospPointerOut",this.l,this.t),this.e.b("msospPointerOver",this.l,this.u),this.j.c(this.l,this.K));Common.App.CollabControls.i.prototype.dispose.call(this)},R:function(n){this.g=n.b(10,null);this.g.a("click",this.l,this.r);this.g.a("dblclick",this.l,this.K);this.e=n.b(9,null);this.e.a("msospPointerOver",this.l,this.u);this.e.a("msospPointerOut",this.l,this.t);this.e.a("msospPointerDown",this.l,this.s);this.j=n.b(13,null);this.j.a(this.l,this.K)},M:function(n,t,i){this.w&&n?this.W(n,t,i):(this.b===3&&this.B(),this.H(!1),this.b=5)},W:function(n,t,i){this.x(n,t,15,4,!1,i)},C:function(n,t,i,r,u,f,e){var o=r?2:u?1:0;this.x(n,t,i+20,o,f,e)},V:function(n,t,i,r,u){this.x(n,t,i+20,3,r,u)},x:function(n,t,i,r,u,f){n&&(r!==this.b||!this.L(t,i))&&(this.E(r,u,f),this.G(n,r,f),this.b=r,f!==4&&(f||this.q)?this.l.style.right=t+"px":this.l.style.left=t+"px",this.l.style.top=i+"px",this.H(!0))},G:function(n,t,i){var r,u;this.y=n;Common.o.h(this.a);Common.M.g(this.a);this.a.id="fly_"+n.n;this.a.style.backgroundColor=n.r;t!==4?(this.a.style.height=this.f+"px",this.a.style.lineHeight=this.f+"px",Common.M.e(this.a,"border-radius",this.f+"px")):i!==4&&(i||this.q)?this.a.style.right="0px":this.a.style.left="0px";t!==2&&(t===4?Common.o.m(this.a,""):t===1?this.a.appendChild(this.v):(this.a.setAttribute("dir","auto"),r=Common.d.ba(n.o,!1,!1),!n.w&&r||t?(u=n.o,t||(u=r,Common.M.e(this.a,"text-align","center")),Common.o.m(this.a,u)):(this.p||(this.p=this.I()),this.a.appendChild(this.p),Common.M.e(this.a,"text-align","start"))))},N:function(n){return this.b?(this.b===3&&Diag.a.a(50436114,302,50,"User clicked on presence pill."),!1):(this.k("InteractivityChanged",new Common.App.CollabControls.e(1,n),null),!0)},P:function(n){return this.b===3&&this.k("InteractivityChanged",new Common.App.CollabControls.e(3,n),null),!1},Q:function(n){return n.b!==3&&this.k("InteractivityChanged",new Common.App.CollabControls.e(2,n),null),!1},O:function(n){return n.b!==3?!0:(this.k("InteractivityChanged",new Common.App.CollabControls.e(4,n),null),!1)},I:function(){var n=document.createElement("img");return n.setAttribute("src",Common.D.c("doughperson_white_glyph.svg")),n.setAttribute("Unselectable","on"),n.setAttribute("role","presentation"),Common.N.c(this.f,this.f,null,null,Common.App.CollabControls.a.k,"",!1,"",this.l.ownerDocument,n)},E:function(n,t,i){if(!this.h(this.b)||!this.h(n)){Sys.UI.DomElement.removeCssClass(this.l,this.i);switch(this.b){case 4:n===3?this.d(Common.App.CollabControls.a.b,Common.App.CollabControls.a.f):this.h(n)&&this.d(Common.App.CollabControls.a.a,Common.App.CollabControls.a.f);break;case 3:n===4?this.d(Common.App.CollabControls.a.d,Common.App.CollabControls.a.e):this.h(n)&&(t&&this.B(),this.d(Common.App.CollabControls.a.a,Common.App.CollabControls.a.e,t?Common.App.CollabControls.a.j:""));break;case 0:case 1:case 2:if(n===4)this.d(Common.App.CollabControls.a.d,Common.App.CollabControls.a.c);else if(n===3){t&&this.F();var r=i===3?Common.App.CollabControls.a.m:Common.App.CollabControls.a.l;this.d(Common.App.CollabControls.a.b,Common.App.CollabControls.a.c,t?Common.App.CollabControls.a.g:"",r)}break;default:n===4?this.d(Common.App.CollabControls.a.d):n===3?this.d(Common.App.CollabControls.a.b):this.h(n)&&this.d(Common.App.CollabControls.a.a)}}},d:function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];this.i=t.join(" ");Sys.UI.DomElement.addCssClass(this.l,this.i)},F:function(){var n=this;this.o=window.setTimeout(function(){n.l&&(n.c=n.l.cloneNode(!0),n.l.parentNode.appendChild(n.c),n.l.style.zIndex=2,n.c.style.zIndex=1)},300)},B:function(){if(window.clearTimeout(this.o),this.c){Sys.UI.DomElement.removeCssClass(this.c,Common.App.CollabControls.a.c+" "+Common.App.CollabControls.a.g);Sys.UI.DomElement.addCssClass(this.c,Common.App.CollabControls.a.i);var n=this;$$sc.a.b(300).CW(function(){n.l&&n.l.parentNode===n.c.parentNode&&n.l.parentNode.removeChild(n.c)});Common.M.d(this.l,"z-index")}},h:function(n){return!n||n===1||n===2},L:function(n,t){var i=Common.M.b(this.l.style.left),r=Common.M.b(this.l.style.top);return i===n&&r===t},S:function(n){var t,i;n===3&&Common.M.c(this.l,"left")?(t=Common.M.b(this.l.style.left),Common.M.d(this.l,"left"),this.l.style.right=-1*t+"px"):n===4&&Common.M.c(this.l,"right")&&(i=Common.M.b(this.l.style.right),Common.M.d(this.l,"right"),this.l.style.left=-1*i+"px")}};Common.App.CollabControls.j=function(n,t){this.a=n;this.b=t};Common.App.CollabControls.j.prototype={a:!1,b:!1,g:function(n,t,i,r,u,f,e){var l=e.y,a=e.height,d=this.f(f),h=d,g=h+t,v=n*i+(n-1)*u,s=null,o=null,y;if(n===1||h+v<=l+a?s=new Common.App.CollabControls.d(0,0,2,4):(s=this.d(g,v,l,a),y=s.a-h,s.a=y),this.b)o=new Common.App.CollabControls.d(0,0,2,this.a?4:3);else{var p=this.e(f,e),c=Math.max(0,e.x),w=e.width,b=p,k=p+t;b+r<=c+w?o=new Common.App.CollabControls.d(0,0,2,this.a?3:4):r<=k-c&&(o=new Common.App.CollabControls.d(0,0,2,this.a?4:3));o||(o=this.c(b,k,r,c,w))}return new Common.App.CollabControls.d(s.a,o.d,s.c,o.b)},f:function(n){return Common.g.I(n)},e:function(n,t){return this.a?t.width-Common.g.H(n):Common.g.G(n)},d:function(n,t,i,r){var u=1,f=Math.max(i,n-t),o=n-i,e;return t>o&&(u=2,e=t<r,f=e?r-t:i),new Common.App.CollabControls.d(f,0,u,4)},c:function(n,t,i,r,u){var f,e,o=n-r,s=u-t;return s>=o?(e=t,f=4):(e=n,f=3),new Common.App.CollabControls.d(0,e,2,f)}};Common.App.CollabControls.d=function(n,t,i,r){this.a=n;this.d=t;this.c=i;this.b=r};Common.App.CollabControls.d.prototype={a:0,d:0,c:0,b:0};Common.App.CollabControls.k=function(n,t,i,r,u,f,e){this.b=n;this.f=t;this.e=i;this.g=r;this.h=u;this.c=f;this.d=e;this.a=document.createElement("div");this.a.className="prTouchTarget"};Common.App.CollabControls.k.prototype={b:null,f:null,d:!1,e:0,g:0,h:0,c:0,a:null,i:function(n,t){if(n!==3){if(n===5||!this.b||!this.b.length){this.a.parentNode&&this.a.parentNode.removeChild(this.a);return}var f=0,u=0,i=0,r=0;n===4?(i=this.h,r=(this.c-i)/2,this.a.style.height=this.c+"px",this.a.style.width=this.c+"px",f=Common.M.b(this.b[0].l.style.top),u=Common.M.b(this.d?this.b[0].l.style.right:this.b[0].l.style.left)):(i=this.e,r=(this.c-i)/2,this.a.style.height=this.c+"px",this.a.style.width=this.k()+r*2+"px",f=Common.M.b(this.b[this.b.length-1].l.style.top),u=this.j(this.b[this.b.length-1].l,i,t));Common.M.e(this.a,"border-radius",this.c+"px");this.a.style.top=f-r-i+"px";this.d?this.a.style.right=u-r+"px":this.a.style.left=u-r+"px";this.a.parentNode||this.f.insertBefore(this.a,this.f.firstChild)}},j:function(n,t,i){return this.d&&!i?Common.M.b(n.style.right):this.d||i?this.d&&i?-Common.M.b(n.style.left)-t:-Common.M.b(n.style.right)-t:Common.M.b(n.style.left)},k:function(){return!this.b||!this.b.length?0:this.e+Math.min(this.b.length-1,2)*this.g}};Common.App.CollabControls.h=function(){this.c={}};Common.App.CollabControls.h.prototype={b:function(n,t){var r=Common.App.CollabControls.c.toString(n),i;return typeof t=="number"?(i=this.c[r],i?Number.parseInvariant(i.toString()):0):this.c[r]},a:function(n,t){this.c[Common.App.CollabControls.c.toString(n)]=t},d:function(n,t){Common.App.CollabControls.c.toString(n)in this.c||(this.c[Common.App.CollabControls.c.toString(n)]=t)}};Common.App.CollabControls.i.registerClass("Common.App.CollabControls.i",Common.bc,Sys.IDisposable);Common.App.CollabControls.e.registerClass("Common.App.CollabControls.e",Sys.EventArgs);Common.App.CollabControls.f.registerClass("Common.App.CollabControls.f",Common.App.CollabControls.i,Common.App.CollabControls.l,Sys.IDisposable);Common.App.CollabControls.a.registerClass("Common.App.CollabControls.a",Common.App.CollabControls.i);Common.App.CollabControls.f.a=0;Common.App.CollabControls.b.a="http://www.w3.org/2000/svg";Common.App.CollabControls.b.e="prDancingDots";Common.App.CollabControls.b.d="prAnimateCircle";Common.App.CollabControls.b.f="0 0 {0} {1}";Common.App.CollabControls.b.b=40;Common.App.CollabControls.b.c=120;Common.App.CollabControls.a.h="prModernFlyout UIFont";Common.App.CollabControls.a.d="flyoutIdle";Common.App.CollabControls.a.b="flyoutExpanded";Common.App.CollabControls.a.a="flyoutCollapsed";Common.App.CollabControls.a.f="flyoutFromIdle";Common.App.CollabControls.a.e="flyoutFromExpanded";Common.App.CollabControls.a.c="flyoutFromCollapsed";Common.App.CollabControls.a.g="flyoutStacked";Common.App.CollabControls.a.j="flyoutFromStacked";Common.App.CollabControls.a.i="flyoutFadeOut";Common.App.CollabControls.a.k="cui-img-cont-float cui-img-20by20";Common.App.CollabControls.a.l="flyoutLtrDir";Common.App.CollabControls.a.m="flyoutRtlDir";Type.registerNamespace("Common.App.Presence");Common.App.Presence.a=function(n,t,i,r,u,f,e,o,s){this.p=Function.createDelegate(this,this.y);this.o=Function.createDelegate(this,this.v);this.n=Function.createDelegate(this,this.u);this.q=new Common.bc;this.k=n;this.j=t;this.i=i;this.g=r;this.d=f;Common.App.Presence.a.a=u;this.l=e;this.f=o;this.m=s;$$sc.a.WAA(t,i).CW(this.n)};Common.App.Presence.a.prototype={a:null,e:!0,c:null,k:null,d:0,j:null,b:null,i:null,h:null,g:null,l:null,f:null,m:!1,s:function(){this.q.k("u",null,this)},u:function(){this.j.a()&&this.i.a()&&(this.b=this.j.a(),this.h=this.i.a(),this.b.f(this.o),this.c=new Common.Z(2,2,this.d,this.p,88,null,!1,0),Common.App.Presence.a.a.a(this.c))},v:function(n,t){(this.e||this.w(t.b))&&Common.App.Presence.a.a.d(this.c,0)},w:function(n){var f=n,i,e,t,r,u;for(i in f)if(e={key:i,value:f[i]},t=this.g.a(e),t&&t.a()&&(r=t.a().toLowerCase(),u=this.a[r]||this.a[r.toUpperCase()],u&&u.a===2))return!0;return!1},y:function(n){var f=this.b.q(),i,r,c,l,a,e,v,k,t,y,u,p,s,h;if(f){if(i=new Date,r=!1,this.e){this.a=f;this.e=!1;c=this.a;for(l in c)a={key:l,value:c[l]},e=a.value,e.b<i&&(i=e.b),e.a===2&&(r=!0,this.h.b(a.key));r&&this.s();Common.App.Presence.a.a.d(n,this.r(i));return}var o=new($$sc.v.$$(String)),w=!1,b=this.a;for(v in b)(k={key:v,value:b[v]},t=k.key,t in this.a&&this.k.a()!==t)&&(y=this.a[t],u=f[t],y&&u&&(p=y.a,s=u.a,p===2&&s===1?(o.b(t),Diag.a.a(38052609,392,50,t+" returned from away")):p===1&&s===2&&(r=!0,w=!0,this.h.b(t),Diag.a.a(38052610,392,50,t+" went away")),s===1&&u.b<i&&(i=u.b)));this.a=f;Common.App.Presence.a.a.d(n,this.r(i));(o.f.length>0||r)&&this.s();o.f.length>0&&!this.m?(h=this.t(o),this.x(h)):h=new($$sc.v.$$(String));(w||h.f.length>0)&&this.l(2052777571,2,null)}},x:function(n){var i,r,t;if(n.f.length)for(i=n.$$lge();i.$$mn();)r=i.$$cu(),t=this.f.b(String.format($a.fh,r),!1),t.a(5),t.f("CoAuth_AuthorStatus_16x16x32"),this.f.a(t)},t:function(n){var e=this.b.p(),i=new($$sc.v.$$(String)),f=e,r,t,u;for(r in f)t={key:r,value:f[r]},n.c(t.key)&&(u=this.g.a(t),u&&(i.b(u.d()),n.e(t.key)));return i.f.length||Diag.a.a(38052611,392,10,"There were no coauthor names found"),i},r:function(n){var t=new Date;return Math.max(n.getTime()+this.d-t.getTime(),0)}};Common.App.Presence.b=function(){this.b=updates};Common.App.Presence.b.prototype={b:0,a:function(n){return!!(this.b&n)},toString:function(){if(this.a(0))return"none";var n=new($$sc.v.$$(String));return this.a(1)&&n.b("user(s) joined"),this.a(2)&&n.b("user(s) disconnected"),this.a(4)&&n.b("user(s) updated"),n.g().join(", ")}};Common.App.Presence.a.registerClass("Common.App.Presence.a");Common.App.Presence.a.a=null;Type.registerNamespace("RealtimePresenceUI");RealtimePresenceUI.f=function(){};RealtimePresenceUI.f.registerInterface("RealtimePresenceUI.f");RealtimePresenceUI.b=function(n,t,i,r){var u,f;this.y=Function.createDelegate(this,this.be);this.k=Function.createDelegate(this,this.bf);this.p=new($$sc.D.$$(Number));this.b=n;this.i=t;i&&(u=this,i.CW(function(){u.g=i.a();u.g.b(u.k);u.j()}));r&&(f=this,r.CW(function(){f.f=r.a();f.f.a(f.k);f.j()}));this.z=new Common.cW(this.b.d,"Anonymous user","#cccccc",new Common.dc(7),null,null,null,null,!1,!1,!1,0,null,0);this.m=!0;this.h=!0;this.o=!1;this.l=!1;this.d=RealtimePresenceUI.e.a(this.b.d,this.b.b,n.e)};RealtimePresenceUI.b.a=function(n,t){var i=n,r=t;return i.c().a(1)&&r.c().a(1)||!i.c().a(1)&&!r.c().a(1)?Common.d.bi(n.o,t.o):i.c().a(1)?-1:1};RealtimePresenceUI.b.prototype={z:null,m:!1,o:!1,l:!1,b:null,d:null,i:null,g:null,f:null,h:!1,R:function(){return Common.a.a?Common.a.a.a("ColorPresenceHashIsEnabled"):!1},D:function(){return Common.a.a?Common.a.a.a("PeoplesWellExtraButtonInfoIsEnabled"):!1},T:function(n,t,i,r,u,f){var e,o,s,h,c=this.U();this.d.a()?this.d.a()===1?(e=!0,o=this.b.a.a.a,s=this.b.a.a.b,h=this.d.b()[0].e()):(e=!0,o=this.b.a.h.a,s=this.b.a.h.b,h=""):(e=!1,o="",s="",h="");n.val=c[0];t.val=c.slice(1);i.val=e;r.val=o;u.val=s;f.val=h},U:function(){if(this.d.a()>=2)return[String.format($a.jb,this.d.a())];if(this.d.a()===1){var n=this.d.b()[0],t=this.b.b(n.a());return t&&t.a===2?[$a.je,n.d()]:[n.g()?$a.jd:$a.jc,n.d()]}return[$a.jf]},bc:function(n){return this.bd(n)},B:function(n,t,i){if(!t)return i&&Diag.a.a(4482393,325,50,"User does not have any presence data"),!1;if(!this.A(n,t))return i&&Diag.a.a(4482394,325,50,"User has presence data but app can't use it"),!1;var r=this.b.b(n);return r&&r.a===2?!1:!0},X:function(n){return n.g()?$a.jh:$a.j},bd:function(n){if(!n.c().a(1))return this.X(n);var t=n.g(),i=this.b.b(n.a()),r=this.b.c(n.a());if(!i)return $a.j;switch(i.a){case 1:return r?t?$a.ji:this.C(n.a(),t,r)||$a.j:$a.j;case 2:return $a.jg;default:return $a.j}},W:function(n){return this.i.h()?this.i.b(n.b(),"O365",Common.a.i,0):undefined},Y:function(n){var t=this.b.b(n.a());return!t||t&&t.a===1?!0:!1},bb:function(n){return this.f?this.f.b(n.a()):n.c().a(4)},Z:function(n){var c=String.format("buttonPeoplesWellUser-{0}",n.a()),u=n.a(),l=this.bc(n),f=n.d(),a=n.e(),t,i=(t=new Common.hU,t.Id=c,t.Command=this.b.a.e.toString(),t.LabelText="{0}",t.Image32by32=this.b.a.i.a,t.Image32by32Class=this.b.a.i.b,t.MenuItemId=u,t.CommandValueId=u,t.Alt=f,t.DisplayMode=this.F(),t.LabelCss="display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",t.Description=l,t.ImageBackColor=a,t.IsAnonymous=n.f(),t.LabelTextUserGeneratedPlaceholderReplacements=CommandUI.b.w([f]),t.Upn=n.b(),t),r,e,o,s,h;return Common.a.a.a("PeoplesWellExtraButtonInfoIsEnabled")&&this.i&&(r=this.W(n),e=this.Y(n),i.ImageUrl=r,i.ActiveStatus=e,o=n.h(),i.JoinTimeInMS=o,s=this.B(n.a(),this.b.c(n.a()),!1),h=this.bb(n),i.CanJump=s,i.ChatCapable=h,r===""&&Diag.a.a(40969413,302,50,"ImageURL collection failed")),i},V:function(){var n;return n=new Common.bT,n.Id="BasicChat",n.Command="2288458806",n.LabelText=$a.kH,n.LabelCss="display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",n},F:function(){return this.R()?"Initials":"Menu32"},ba:function(n){for(var u,f,i=[],r=n,e=r.length,t=0;t<e;++t)u=r[t],f=this.Z(u),Array.add(i,f);return i},bh:function(n){if(!this.m)return!0;this.h||(n[CommandUI.Controls.d.Visible]=!0);var i,t,r,e,u,f,o,s,h,c,l,a;return this.T(o={val:i},s={val:t},h={val:r},c={val:e},l={val:u},a={val:f}),i=o.val,t=s.val,r=h.val,e=c.val,u=l.val,f=a.val,n[CommandUI.Controls.d.LabelText]=i,t&&t.length&&(n[CommandUI.Controls.d.LabelTextUserGeneratedPlaceholderReplacements]=t),n.ImageIsVisible=r,n[CommandUI.Controls.d.Image16by16Class]=u,n.ImageBackColor=f,this.m=!1,!0},bg:function(n){var e,r,o;if(this.d.a()<=0)return!1;var s=this.bl(this.d.b()),h=this.ba(s),i,u=(i=new Common.cA,i.Id="menuCoauthors",i.MaxWidth="220px",i.MenuSectionList=[],i),t,f=(t=new Common.ce,t.Id="msCoauthors",t.ControlsId="msCoauthorsControls",t.DisplayMode=this.F(),t.ControlList=h,t);return Common.a.a.a("WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.i&&(f.Title=$a.ja,f.TitleId="menuCoauthorsTitle",f.Theme="Light"),Array.add(u.MenuSectionList,f),Common.a.a.a("DocChatIsEnabled")&&Common.a.a.a("PeoplesWellExtraButtonInfoIsEnabled")&&Common.a.b()&&Common.a.b().a().f()&&(e=[],Array.add(e,this.V()),o=(r=new Common.ce,r.Id="msGroupChat",r.ControlsId="msGroupChatControl",r.ControlList=e,r),Array.add(u.MenuSectionList,o)),Common.a.b()&&Common.a.b().a().f()?n.MenuItems=u:n.PopulationXML=Common.z.f(u),!0},bm:function(n){var t,i;return(Diag.a.a(4482395,325,50,"PeoplesWell: Received user button click"),t=n.MenuItemId,!t)?!1:(i=this.b.c(t),!this.B(t,i,!0))?!1:(this.G(t,i),!0)},bi:function(){var n=this.S();this.d.c(n);this.h&&this.d.a()>=1&&(Diag.a.a(6092429,325,50,"PeoplesWell: User is no longer forever alone."),this.h=!1);this.m=!0},bf:function(){if(!this.l){var n=this;window.setTimeout(function(){n.j();n.l=!1},3e3);this.l=!0}},S:function(){var n=null,r;n||(n=this.E()||[]);for(var i=n,u=i.length,t=0;t<u;++t)r=i[t],this.bk(r);return n},bk:function(n){n.a()||n.j(Common.v.a().a);n.d()||n.m("Anonymous user");n.c()||n.i(new Common.dc(0));n.e()||n.k("#cccccc");n.h()||n.l(0)},bl:function(n){var t=[];return Array.addRange(t,n),t.sort(RealtimePresenceUI.b.a),t},bj:function(){Common.a.a.a("CoauthorGalleryTelemetryIsEnabled")&&Common.a.c().a(691867605,2147483648,this.y);this.H();this.o=!0;this.j()},be:function(n,t,i,r,u){return this.p.d(u.RenderTime),32},a:function(){return this.p.a},j:function(){if(this.o||(this.p.d((new Date).getTime()),Diag.a.a(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"),!this.D())){if(this.bi(),this.D()&&this.h){Common.cB.c("ribbon","coauthorGallery",!1);return}Common.cB.d("ribbon","coauthorGallery",!1);Common.cB.b("ribbon","coauthorGallery",!1);this.x()}},dispose:function(){this.g&&(this.g.c(this.k),this.g=null);this.f&&(this.f.c(this.k),this.f=null)}};RealtimePresenceUI.a=function(n,t,i,r,u){var f,e;this.a=n;this.d=t;this.e=u;f=this;this.c=i||function(){return null};e=this;this.b=r||function(){return null}};RealtimePresenceUI.a.a=function(n,t,i,r,u){return new RealtimePresenceUI.a(n,t,i,r,u)};RealtimePresenceUI.a.prototype={a:null,d:null,c:null,b:null,e:!1};RealtimePresenceUI.g=function(n){this.d=new($$sc.w.$$(Array));this.e=n};RealtimePresenceUI.g.prototype={e:null,f:null,c:function(n){var i;this.k();this.l(n);for(var r=n,u=r.length,t=0;t<u;++t)i=r[t],i.a()!==this.e&&this.h(i)},b:function(){for(var n=new Array(0),t=this.d.k().$$ge(),i,r;t.$$mn();)i=t.$$cu(),r=this.j(i),Array.add(n,r);return n},a:function(){return this.d.e},i:function(n,t){n=n.toUpperCase();var i,r,u;(u=this.d.f(n,r={val:i},null),i=r.val,u)||(i=new Array(0),this.d.a(n,i));Array.add(i,t)},k:function(){this.d=new($$sc.w.$$(Array))},l:function(n){for(var i,r=n,u=r.length,t=0;t<u;++t)if(i=r[t],i.a()===this.e){this.f=i;return}}};RealtimePresenceUI.e=function(){};RealtimePresenceUI.e.a=function(n,t,i){return i?new RealtimePresenceUI.c(n,t):new RealtimePresenceUI.d(n)};RealtimePresenceUI.c=function(n,t){RealtimePresenceUI.c.initializeBase(this,[n]);this.g=t};RealtimePresenceUI.c.prototype={g:null,h:function(n){if(n.f()||!n.b()){this.i(n.a(),n);return}this.f&&$$sc.d.a().a(this.f.b(),n.b())||this.i(n.b(),n)},j:function(n){for(var r,t,u=new Date(0),f=n.length>0?n[0]:null,e=n,o=e.length,i=0;i<o;++i)(r=e[i],t=this.g(r.n),t)&&u.getTime()<t.b.getTime()&&(u=t.b,f=r);return f}};RealtimePresenceUI.d=function(n){RealtimePresenceUI.d.initializeBase(this,[n])};RealtimePresenceUI.d.prototype={h:function(n){this.i(n.a(),n)},j:function(n){return n[0]}};RealtimePresenceUI.b.registerClass("RealtimePresenceUI.b",null,Common.ei,Sys.IDisposable);RealtimePresenceUI.g.registerClass("RealtimePresenceUI.g");RealtimePresenceUI.c.registerClass("RealtimePresenceUI.c",RealtimePresenceUI.g);RealtimePresenceUI.d.registerClass("RealtimePresenceUI.d",RealtimePresenceUI.g);Type.registerNamespace("_Ewa");_Ewa.Uf=function(n){this.o=Function.createDelegate(this,this.u);this.p=Function.createDelegate(this,this.v);this.m=Function.createDelegate(this,this.y);this.j=Function.createDelegate(this,this.n);this.k=Function.createDelegate(this,this.w);this.l=Function.createDelegate(this,this.x);_Ewa.Uf.initializeBase(this,[!1]);this.e=n;Diag.a.b(40461393,0,!!this.e.b(),"NamedSheetViewConversionManager ctor: EwaControl.SessionStateManager should not be null");this.e.F(this.l);this.e.b().D(this.k);this.e.b().cd(this.j);this.e.b().r(this.m);this.e.b().t()&&this.n(this,Sys.EventArgs.Empty)};_Ewa.Uf.prototype={f:null,h:null,g:!1,i:!1,e:null,a:function(n){this.er("SVCU",n)},b:function(n){this.es("SVCU",n)},dispose:function(){this.f=null;this.h=null;this.e&&this.e.H(this.l);this.e.b()&&(this.e.b().A(this.k),this.e.b().cF(this.j),this.e.b().s(this.m));this.e=null;_Ewa.bX.prototype.dispose.call(this)},d:function(n){return this.g?null:this.q(n,this.h,"ConvertPresencePublicToPrivate")},c:function(n){return this.g?null:this.q(n,this.f,"ConvertPresencePrivateToPublic")},z:function(n){if(!n){Diag.a.a(40993282,0,10,"NamedSheetViewConversionManager.ProcessConversionEntries: conversionEntries can be empty but not null");return}this.t(n);this.f=n;this.h=this.r(this.f)},y:function(){var t=this.e.b().m(),n,u,e;if(t&&t.SheetChanges)for(var o=t.SheetChanges,c=o.length,i=0;i<c;++i)if(n=o[i],n.Type===2){if(this.f)for(var s=this.f,l=s.length,r=0;r<l;++r)u=s[r],u.Range.SheetName===n.Name&&(u.Range.SheetName=n.NewName);if(this.h)for(var h=this.h,a=h.length,f=0;f<a;++f)e=h[f],e.Range.SheetName===n.Name&&(e.Range.SheetName=n.NewName)}},w:function(){Diag.a.a(50657436,0,50,"NamedSheetViewConversionManager.OnGridLoaded");this.i=!1;this.n(this,Sys.EventArgs.Empty)},x:function(){Diag.a.a(50657437,0,50,"NamedSheetViewConversionManager.OnWorkbookClosing");this.i=!0},n:function(){if(Diag.a.a(50620166,0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: triggered with version [{0}]",this.e.b().bH()),!this.e.j()||!this.e.b().a()||this.e.b().X()||this.i||this.e.b().bH()===-2){Diag.a.a(50467170,0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: Request skipped [Edit Mode: {0}] [IsSessionActive: {1}] [HasRaisedSessionEnded: {2}] [WorkbookClosed: {3}]",this.e.j(),this.e.b().a(),this.e.b().X(),this.i);return}this.f=null;this.h=null;var n=this.e.c().a().b(!1);_Ewa.Wa.a(this.e.c().a(),this.p,this.o,null,n,null)},v:function(n){var t,r,i;if(_Ewa.j.e(n.Errors)){this.g=!0;t=[-1100324317,-1857233882];_Ewa.j.d(n.Errors,t)&&Diag.a.a(40993283,0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionSuccess Errors: [{0}]",_Ewa.j.b(n.Errors,","));r=_Ewa.j.f(n.Errors,t,"NamedSheetViewConversionManager:OnGetNamedSheetViewConversionSuccess");this.e.b().p(r);return}this.g=!1;i=n.Result;this.e.b().cK(i.ConversionVersion);this.z(i.NamedSheetViewConversionEntries);this.A()},u:function(n){this.g=!0;var t=n.b,i=_Ewa.X.a(t);Diag.a.a(40993284,0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionFailure: Errors: [{0}].",_Ewa.j.b(i,","))},A:function(){Diag.a.a(40461394,0,50,"NamedSheetViewConversionManager.RaiseConversionUpdatedEvent: new version is update on client from server");this.ep("SVCU",null,null)},q:function(n,t,i){var r,u,f,e,h;if(!t||!t.length)return Diag.a.a(40993285,0,50,"NamedSheetViewConversionManager.{0}: skipping convert due to {1} ConversionEntries. ",i,t?"empty":"null"),n;for(var c=n,a=c.length,o=0;o<a;++o){r=c[o];for(var l=t,v=l.length,s=0;s<v;++s)if((u=l[s],u.IsRow)&&_Ewa.fY.a(u.Range,r)&&(!(r.FirstRow<=u.Range.FirstRow)||!(r.LastRow>=u.Range.LastRow)))if(f={},f.SheetName=r.SheetName,f.FirstRow=f.LastRow=r.FirstRow,f.FirstColumn=f.LastColumn=r.FirstColumn,_Ewa.fY.a(u.Range,f)){if(e=-1,h=-1,e=r.FirstRow-u.Range.FirstRow,e<0||e>=u.ConversionMap.length){Diag.a.a(40993286,0,10,"NamedSheetViewConversionManager.ConvertRanges: invalid mapIndex after adjust. Index: [{0}], ConversionMap.Length: {1}",e,u.ConversionMap.length);continue}else h=u.ConversionMap[e]-e;r.FirstRow+=h;r.LastRow=r.FirstRow;r.LastColumn=Math.min(r.LastColumn,u.Range.LastColumn)}else r.FirstRow<u.Range.FirstRow&&r.LastRow>=u.Range.FirstRow?r.LastRow=u.Range.FirstRow-1:r.LastColumn>=u.Range.FirstColumn&&(r.LastColumn=u.Range.FirstColumn-1);(r.FirstRow<0||r.FirstRow>1048575)&&(r.FirstRow=Math.max(Math.min(r.FirstRow,1048575),0));(r.LastRow<0||r.LastRow>1048575)&&(r.LastRow=Math.max(Math.min(r.LastRow,1048575),0));(r.FirstColumn<0||r.FirstColumn>16383)&&(r.FirstColumn=Math.max(Math.min(r.FirstColumn,16383),0));(r.LastColumn<0||r.LastColumn>16383)&&(r.LastColumn=Math.max(Math.min(r.LastColumn,16383),0))}return n},r:function(n){var u,t,i,r;if(!n||!n.length)return Diag.a.a(40993287,0,50,"NamedSheetViewConversionManager.CreateInverseConversionEntries: skip creating inverse due to {0} ConversionEntries. ",this.f?"empty":"null"),n;for(u=new Array(n.length),t=0;t<n.length;++t){for(i=new _Ewa.DZ,i.Range=n[t].Range,i.IsRow=n[t].IsRow,i.ConversionMap=new Array(n[t].ConversionMap.length),i.IsRow||(this.g=!0,Diag.a.a(41185634,0,10,"NamedSheetViewConversionManager.CreateInverseConversionEntries: adjusting presence against column sort map is NYI.")),r=0;r<n[t].ConversionMap.length;++r)i.ConversionMap[n[t].ConversionMap[r]]=r;u[n.length-t-1]=i}return u},t:function(n){var t,r;if(n&&n.length)for(var u=n,f=u.length,i=0;i<f;++i)t=u[i],this.s(t),r=t.IsRow?t.Range.LastRow-t.Range.FirstRow+1:t.Range.LastColumn-t.Range.FirstColumn+1,t.ConversionMap.length!==r&&(Diag.a.b(41435473,0,!1,"NamedSheetViewConversionManager.DecompressEntries: decompressed conversion map doesn't match expected size - Expected: [{0}] | Actual: [{1}]",r,t.ConversionMap.length),this.g=!0)},s:function(n){var t=n.ConversionMap,r,i,f,e,u;if(t&&t.length){if(t[0]<0){Diag.a.b(41435474,0,!1,"NamedSheetViewConversionManager.DecompressConversionMap: conversionMap starts with a negative number");this.g=!0;return}for(r=[],i=0;i<t.length;++i)if(t[i]<0)for(f=t[i-1],e=t[i]*-1,u=1;u<=e;++u)Array.add(r,f+u);else Array.add(r,t[i]);n.ConversionMap=r}}};_Ewa.bnY=function(){};_Ewa.bnY.registerInterface("_Ewa.bnY");_Ewa.bnZ=function(){};_Ewa.bnZ.registerInterface("_Ewa.bnZ");_Ewa.VV=function(n,t,i){this.a(null);this.d=n;this.g=t;this.h=i;this.e=new _Ewa.sF(_Ewa.c.a(this.g),this.d.User.UserID,this.d.User.UserName,this.d.UserColor,null,i,this.g,this.d.IsAnonymous)};_Ewa.VV.prototype={g:null,e:null,d:null,h:null,f:null,a:function(n){return this.f=n,this.f&&this.h.S(this.f.cl()),n},i:null,dispose:function(){this.l();System.a.a(this.e);this.a(null);this.d=null;this.g=null;this.i=null},k:function(n){this.e.N(n.e)},l:function(){this.f&&this.d&&this.d.User&&(this.f.bv(!1,this.d.User.UserID,null),this.e.o(!0))},b:function(){this.f&&this.d&&this.d.User&&(this.f.bv(!0,this.d.User.UserID,this.d.UserColor),this.e.v())},j:function(n){this.e.t(n);this.e.e(n,!0)},c:function(n,t){this.e.O(null,t?37:36,n)}};_Ewa.sE=function(){_Ewa.sE.initializeBase(this,[!1])};_Ewa.sE.a=function(n,t){var i=n.b.d();System.a.b(n.d());System.a.b([n.b]);n.b=null;n.b=new _Ewa.AR(t);n.n([]);n.y(t);n.o(i)};_Ewa.sE.prototype={b:null,k:null,d:function(){return this.k},n:function(n){return this.k=n,n},l:null,g:function(){return this.l},y:function(n){return this.l=n,n},a:function(){return this.b.d()},o:function(n){return this.b.e(n),n},x:function(){},h:function(){return null},m:function(){return null},p:function(){},q:function(){},z:function(){}};_Ewa.VW=function(n){_Ewa.VW.initializeBase(this);this.m=n;this.l()};_Ewa.VW.prototype={m:null,i:null,a:function(){this.k(this.i||(this.i=new _Ewa.Uf(this.m)))}};_Ewa.gx=function(n,t,i){var r,e,u,f;for(this.q=Function.createDelegate(this,this.v),this.n=Function.createDelegate(this,this.u),_Ewa.gx.initializeBase(this,[!1]),this.l=n,this.t=n.d(),this.o=!1,this.k=new _Ewa.w(!0),r=0;r<4;r++)e=this.l.f().A(i,_Ewa.gx.a()[r])||_Ewa.gx.a()[r]===1,e&&(u=t.a(document.createElement("div"),!1),f=n.n(_Ewa.gx.a()[r]).j(),f.insertBefore(u.a(),f.firstChild),this.k.c(Enum.toString(_Ewa.qc,_Ewa.gx.a()[r]),u))};_Ewa.gx.a=function(){return _Ewa.gx.b||(_Ewa.gx.b=[1,3,2,4])};_Ewa.gx.prototype={l:null,t:!1,m:null,o:!1,s:null,p:!1,k:null,a:function(){return null},c:function(){var n=_Ewa.w.a(this.k.b,Enum.toString(_Ewa.qc,_Ewa.gx.a()[0]),null);return n?n.c():null},dispose:function(){var n,t,i;if(this.k.a.length>0){this.e();n=this.k.b;for(t in n)i={key:t,value:n[t]},i.value.dispose()}this.l=null;this.k.f();_Ewa.bX.prototype.dispose.call(this)},i:function(){var t=this.k.b,n,i;for(n in t)i={key:n,value:t[n]},i.value.i()},h:function(){var n,t,i;this.r();n=this.k.b;for(t in n)i={key:t,value:n[t]},i.value.h()},e:function(){var n,t,i;this.w();n=this.k.b;for(t in n)i={key:t,value:n[t]},i.value.e()},b:function(n){var i=this.k.b,t,r;for(t in i)r={key:t,value:i[t]},r.value.b(n)},f:function(n){var i=this.k.b,t,r;for(t in i)r={key:t,value:i[t]},r.value.f(n)},g:function(n,t){var r=this.k.b,i,u;for(i in r)u={key:i,value:r[i]},u.value.g(n,t)},d:function(n){var t,i,r;this.o!==n&&(this.o=n,t=_Ewa.w.a(this.k.b,Enum.toString(_Ewa.qc,_Ewa.gx.a()[0]),null),this.m&&t&&(i=_Ewa.b.G(t.a())/2,r=this.o?this.m.x+14+i:this.m.x-14-i,this.j(r,this.m.y)))},j:function(n,t){var r=this.k.b;for(var u in r){var f={key:u,value:r[u]},o=Enum.parse(_Ewa.qc,f.key),e=this.l.n(o),i=_Ewa.AN.a(e,new Sys.UI.Point(n,t),!1);this.m=new Sys.UI.Point(n,t);i.x<0&&(i.x+=e.j().scrollLeft);_Ewa.b.t(f.value.a(),i.x,i.y,!1,this.t)}},u:function(){this.r()},v:function(){this.r()},r:function(){this.m&&(this.j(this.m.x,this.m.y),this.p||(this.p=!0,this.l.b().j(this.n),this.l.b().g(this.n),this.l.i().d(this.q)))},w:function(){this.p&&(this.l.b().k(this.n),this.l.b().e(this.n),this.l.i().c(this.q))}};_Ewa.sF=function(n,t,i,r,u,f,e,o){this.I=Function.createDelegate(this,this.R);this.J=Function.createDelegate(this,this.S);this.K=Function.createDelegate(this,this.T);this.H=Function.createDelegate(this,this.Q);this.w={};_Ewa.sF.initializeBase(this,[!1]);o=!!(o|i===_Ewa.ClientStringManager.a().c(83));this.G=new Common.cW(t,i,r,new Common.dc(0),null,null,null,null,o,!1,!1,0,null,0);this.D=n;this.y=t;this.F=u;this.B=f;this.M=e};_Ewa.sF.a=function(n,t){return n.toString()+t.toString()};_Ewa.sF.prototype={C:null,F:null,L:0,D:null,B:null,z:null,E:null,M:null,j:function(n){this.er("hidePresenceTooltip",n)},p:function(n){this.es("hidePresenceTooltip",n)},m:function(n){this.er("showPresenceTooltip",n)},r:function(n){this.es("showPresenceTooltip",n)},l:function(n){this.er("showFullPresenceTooltip",n)},q:function(n){this.es("showFullPresenceTooltip",n)},k:function(n){this.er("presenceChanged",n)},s:function(n){this.es("presenceChanged",n)},y:null,a:function(){return this.y},G:null,c:function(){return this.G},x:0,b:function(){return this.x},i:function(){return this.C},h:function(){return this.C||this.E?_Ewa.AN.a(this.D.n(this.x),this.A(this.x).h(),!0):null},g:function(){return this.A(this.x).g()},t:function(n){var i=this.w,t,r;for(t in i)r={key:t,value:i[t]},r.value.t(n);return n},dispose:function(){var t,i,r,n;this.ep("hidePresenceTooltip",null,null);this.ep("presenceChanged",null,null);this.B&&this.B.O(this.y);t=this.w;for(i in t)r={key:i,value:t[i]},n=r.value,n.p(this.H),n.r(this.K),n.q(this.J),n.s(this.I),n.dispose();this.w=null;this.D=null;this.F=null;this.C=null;this.B=null;_Ewa.bX.prototype.dispose.call(this)},O:function(n,t,i){n?(this.C=_Ewa.h.b(n),this.x=this.D.f().e(this.C.O())):i?(this.E=i,this.x=i.e().B()):this.x=1;this.L=t;this.A(this.x);this.u(n,i)},u:function(n,t){var r=this.w,i,u;for(i in r)u={key:i,value:r[i]},u.value.u(n,t)},o:function(n){var t,i,r;this.A(this.x).o(n);t=this.w;for(i in t)r={key:i,value:t[i]},r.value.o(!1)},N:function(n){var r=this.w,t,u,i;for(t in r)u={key:t,value:r[t]},i=u.value,i.n(n.A(i.b()))},n:function(n){this.A(n.b()).n(n)},d:function(){var n=this.A(this.x).d(),i=this.w,t,r;for(t in i)r={key:t,value:i[t]},n=!!(n|r.value.d());return n},e:function(n,t){var i,r,u;this.B.t(this);this.A(this.x).e(n,t);i=this.w;for(r in i)u={key:r,value:i[r]},u.value.e(n,!1)},f:function(n){var i=this.w,t,r;for(t in i)r={key:t,value:i[t]},r.value.f(n)},v:function(){var t=this.w,n,i;for(n in t)i={key:n,value:t[n]},i.value.v();this.B.t(this)},A:function(n){return this.P(n,this.L)},P:function(n,t){var u=this.F?this.F.e(t,n,0).a:this.E?this.E.B():null,r=_Ewa.sF.a(t,n),i=_Ewa.w.a(this.w,r,null);return i||(i=new _Ewa.Wc(u,this.D,this.G,n,this.M),this.w[r]=i,i.j(this.H),i.m(this.K),i.l(this.J),i.k(this.I)),i},Q:function(n){this.z&&this.z!==n||(this.z=null,this.o(!1));this.ep("hidePresenceTooltip",null,null)},T:function(n){this.z&&this.z!==n||(this.z=null,this.e(!0,!1));this.ep("showPresenceTooltip",null,null)},S:function(n){this.z||this.ep("showFullPresenceTooltip",null,null);this.z=n},R:function(){this.o(!1);this.ep("presenceChanged",null,null)}};_Ewa.AO=function(n){this.f=Function.createDelegate(this,this.h);this.e=new Common.bc;this.d=n;this.d.b().P(this.f)};_Ewa.AO.prototype={d:null,g:!1,dispose:function(){this.g||(this.d&&this.d.b()&&this.d.b().R(this.f),System.a.b([this.e]),this.e=null,this.d=null,this.g=!0)},b:function(n){this.e.m("UU",n)},c:function(n){this.e.n("UU",n)},a:function(){for(var n,u,t=[],r=this.d.b().u(),f=r.length,i=0;i<f;++i)n=r[i],u=new Common.cW(n.User.UserID,n.User.UserName,n.UserColor,new Common.dc(1),null,n.UserEmail,null,null,!1,!1,!1,n.JoinCoauthTime,null,0),Array.add(t,u);return Diag.a.a(42481440,0,50,"PeopleInfoProvider.GetAllUsers: Count: [{0}]",t.length),t},h:function(){Diag.a.a(42481442,0,50,"PeopleInfoProvider.OnUserListUpdated fired");this.e.k("UU",this,null)}};_Ewa.VX=function(){};_Ewa.VX.prototype={a:function(n){var f=n.key,i=n.value,r,t,u;return i?(r=i.SupportsChat?4:0,u=(t=new Common.cW,t.n=f,t.u=i.ChatThreadId,t.t=i.ChatThreadDiscoveryUri,t.v=i.InChat,t.s=i.Cid,t.q=new Common.dc(r),t),u):null}};_Ewa.sG=function(){_Ewa.sG.initializeBase(this);this.l()};_Ewa.sG.a=function(n){n.a().b(_Ewa.blK.$$(Common.eO),159,new _Ewa.sG)};_Ewa.sG.prototype={i:null,a:function(){this.k(this.i||(this.i=new _Ewa.VX))}};_Ewa.fZ=function(n,t,i){_Ewa.fZ.initializeBase(this,[t,_Ewa.c.a(t),!0,!1,n.User.UserID]);_Ewa.fZ.a||(_Ewa.fZ.a={});this.A=n;this.X=t;this.u=new _Ewa.sF(this.t,this.A.User.UserID,this.A.User.UserName,this.A.UserColor,this,i,this.X,this.A.IsAnonymous)};_Ewa.fZ.b=function(n,t,i){if(i){if(t===n.firstChild)return;n.removeChild(t);n.insertBefore(t,n.firstChild)}else{if(t===n.lastChild)return;n.removeChild(t);n.appendChild(t)}};_Ewa.fZ.prototype={A:null,V:36,C:!1,J:!1,X:null,u:null,dispose:function(){var t,i,r,n;System.a.a(this.u);_Ewa.hh.prototype.dispose.call(this);t=_Ewa.fZ.a;for(i in t)r={key:i,value:t[i]},n=r.value,n&&!n.children.length&&(_Ewa.b.g(n),_Ewa.fZ.a[r.key]=null)},W:function(n){this.u.N(n.u)},bm:function(n){this.J||(this.u.t(n),this.u.e(n,!0));this.C=n&&this.J},Y:function(n,t){this.u.O(n,t?37:36,null);this.C=!1},bK:function(n){this.u.e(!0,!0);this.V=n;this.d([n],null,null)},bH:function(n){this.bI();this.a(n)},be:function(n,t,i){var u,e,r,f;i.className="ewr-cell-presence-highlight-all";i.style.borderColor=this.A.UserColor;u=document.createElement("div");n!==36&&n!==37&&(u.style.backgroundColor=this.A.UserColor);i.appendChild(u);e=["ewr-cell-presence-highlight-fill","ewr-cell-presence-highlight-edit"];u.className=e[n-36];r=_Ewa.w.a(_Ewa.fZ.a,t.toString(),null);r||(f=this.t.n(t).j(),r=document.createElement("div"),f.insertBefore(r,f.firstChild),_Ewa.fZ.a[t.toString()]=r);r.appendChild(i)},bf:function(){},bi:function(n,t,i,r){var f=this.bG(r,n,t),u,e,o;_Ewa.dO.a(i,this.t.d(),f.a.a+"px");i.width=f.c()+"px";i.top=f.a.b+"px";i.height=f.d()+"px";u=t.a;e=u.parentNode;n===37?_Ewa.fZ.b(e,u,!1):n===36&&(o=this.e(37,1,0),r.g(o.l)?_Ewa.fZ.b(e,u,!1):_Ewa.fZ.b(e,u,!0));this.bJ(n)},bk:function(){return!1},bG:function(n,t,i){var r=n.a.b+this.F(i,!1),u=n.a.a+this.F(i,!0)+_Ewa.be.i(i.a.parentNode.parentNode,this.t.d()),f=n.c(),e=n.d()+1;return u<1&&u>=-1&&t===36&&(f-=1-u,u=1),r<1&&r>=-1&&t===36&&(e-=1-r,r=1),f=Math.max(0,f-1),e=Math.max(0,e-2),new _Ewa.ba(u,r,f,e)},bJ:function(n){this.u.v();this.V=n;this.J=!1;this.C&&this.bm(!0);this.C=!1},bI:function(){this.J||(this.u.o(!0),this.C=!1)}};_Ewa.VZ=function(n){this.u=Function.createDelegate(this,this.E);this.i=n;Common.ba.b()&&(this.o=window.performance.timing.navigationStart);this.o||Diag.a.a(555038465,0,15,"Navigation start time is zero");this.i.b().h(this.u)};_Ewa.VZ.prototype={i:null,C:!1,B:!1,s:!1,x:!1,y:!1,A:!1,q:!1,z:!1,t:0,m:0,l:0,p:0,r:0,w:!1,k:0,o:0,n:!1,h:function(n){this.C||(this.t=n,this.C=!0)},g:function(n,t){this.B||(this.m=t,this.w=n,this.B=!0)},f:function(n){this.s||(this.l=n,this.s=!0)},d:function(n){!this.q&&this.s&&(this.r=n,this.q=!0)},a:function(n){this.x||(this.p=n,this.x=!0)},b:function(n){if(!this.y&&this.j()&&!this.n){this.y=!0;var t=this.v();t.RtcIntializeToPeopleWellServiceCreate=this.p-this.m;t.PeopleWellServiceCreateToPresenceGalleryRender=n-this.p;t.PresenceGalleryRenderTotalTime=n-this.j();_Ewa.Z.a(this.i).a(_Ewa.y.o,t,null,!0)}},e:function(n){if(!this.A&&this.j()&&!this.n){this.A=!0;var t=this.v();t.RtcIntializeToRtcConnect=this.l-this.m;t.RtcConnectToPresenceSent=n-this.l;t.PresenceSentTotalTime=n-this.j();_Ewa.Z.a(this.i).a(_Ewa.y.q,t,null,!0)}},c:function(n){if(!this.z&&this.q&&this.j()&&!this.n){this.z=!0;var t=this.v();t.RtcIntializeToRtcConnect=this.l-this.m;t.RtcConnectToPresenceRenderInitiate=this.r-this.l;t.PresenceRenderInitiateToPresenceRenderFinish=n-this.r;t.PresenceRenderTotalTime=n-this.j();_Ewa.Z.a(this.i).a(_Ewa.y.p,t,null,!0)}},dispose:function(){this.i=null},v:function(){var n={};return n.CoAuthorCountsOnBoot=this.i.b().u().length,n.RtcConnectedLaterInSession=this.w,n.BrowserVisibilityChanged=this.D(),n.AppInteractiveAbsTime=this.j(),n.NavigationStartTime=this.o,n.AppInteractiveToRtcSliceLoad=this.t-this.j(),n.RtcSliceLoadToRtcInitialize=this.m-this.t,n},j:function(){return this.k?this.k:(Common.bk.a().c("AppInitStatus_interactivityReady")&&(this.k=Common.bk.a().b("AppInitStatus_interactivityReady")),this.k||Diag.a.a(555038464,0,15,"App interactive time is zero"),this.k)},E:function(){this.n=!0;this.i.b().i(this.u)},D:function(){if(Common.ba.b()&&Common.bk.a().c("UserActions")){var n=Common.bk.a().b("UserActions");return n.VisiToggled>0}return!1}};_Ewa.AP=function(n){_Ewa.AP.initializeBase(this);this.i=n;this.l()};_Ewa.AP.a=function(n){n.a().b(_Ewa.blK.$$(_Ewa.fB),436,new _Ewa.AP(n))};_Ewa.AP.prototype={i:null,a:function(){this.k(this.i.a().a(_Ewa.fB,435,!1,null)||this.i.a().b(_Ewa.fB,435,new _Ewa.VZ(this.i)))}};_Ewa.AQ=function(n){this.v=Function.createDelegate(this,this.Q);this.u=Function.createDelegate(this,this.E);this.r=Function.createDelegate(this,this.K);this.s=Function.createDelegate(this,this.L);this.p=Function.createDelegate(this,this.I);this.o=Function.createDelegate(this,this.H);this.h=Function.createDelegate(this,this.G);this.q=Function.createDelegate(this,this.J);this.k="ewaboot_doughboywhite20";this.f=20;this.a=_Ewa.c.a(n);this.c=n;this.g={};this.b={};this.d={};this.e={};this.c.d()&&this.c.d().c(this.q);this.x()};_Ewa.AQ.a=function(n,t,i){return n.x.toString()+"-"+n.y.toString()+"-"+t.toString()+"-"+i.a.toString()+"-"+i.b.toString()};_Ewa.AQ.prototype={f:16,g:null,d:null,b:null,e:null,i:!1,k:null,a:null,c:null,l:null,j:null,dispose:function(){this.N();this.w();this.c&&this.c.d()&&this.c.d().d(this.q);this.a=null},N:function(){this.i&&(this.a.b().k(this.h),this.a.b().e(this.h),this.a.i().c(this.o),this.i=!1)},O:function(n){var t=this.d[n],i=this.b[n];t&&this.A(t);i&&this.m(i,t.c().n,this.c,t.b(),t.a());delete this.b[n];delete this.d[n];delete this.e[n]},t:function(n){var t=n.a(),i=this.d[t];i||(this.F(n),this.d[t]=n)},R:function(n){var u=n.g(),i=n.a(),t=this.y(n.h(),n.b(),n.i()),r=this.b[i];t&&t!==r&&(n.f(t),this.b[i]=t,this.d[i]=n,this.e[i]&&t.d(this.e[i]));r!==t&&r&&this.m(r,n.c().n,this.c,n.b(),n.a());!this.i&&this.a&&(this.a.b().j(this.h),this.a.b().g(this.h),this.a.i().d(this.o),this.i=!0)},m:function(n,t,i,r,u){var e,f,o;n.f(t);_Ewa.a.b("OfficeVSO:3663630_ModernPresenceUxPerf")&&(e=this.b[u],e===n&&delete this.b[u]);n.c()&&n.c().length||(f=n.s,f&&delete this.g[f],_Ewa.a.b("OfficeVSO:3663630_ModernPresenceUxPerf")||(o=this.b[u],o===n&&delete this.b[u]),n.dispose())},A:function(n){n&&(n.p(this.p),n.r(this.s),n.q(this.r),n.f(null))},F:function(n){n.j(this.p);n.m(this.s);n.l(this.r)},I:function(n){var t=n,i=this.b[t.a()];i&&this.m(i,t.c().n,this.c,t.b(),t.a())},L:function(n){this.B(!1,n)},K:function(n){this.B(!0,n)},B:function(n,t){var i,r;t.g()||this.t(t);this.R(t);i=this.b[t.a()];i&&(r=t.i(),i.b(t.c()),t.d()?n?i.h():i.i():i.e())},y:function(n,t,i){var u,e,f,r;return n?(u=this.D(n,t),e=this.a.n(t).x(),f=_Ewa.AQ.a(u,t,e).toString(),r=_Ewa.w.a(this.g,f,null),r||(r=new _Ewa.gx(this.a,this.l,i),r.j(u.x,u.y),r.s=f,this.g[f]=r),r):null},D:function(n,t){var f=this.a.n(t).y(),i=this.a.n(t).x(),r=_Ewa.fW.a(t,f.a),e=Math.max(i.a,n.x-this.f/2-2),u;return e=Math.min(Math.max(r.a+i.a,e),r.a+i.a+f.c()-this.f),u=Math.max(i.b,n.y-this.f/2+1),u=Math.min(Math.max(r.b+i.b,u),r.b+i.b+f.d()-this.f),new Sys.UI.Point(e,u)},w:function(){var r=this.d,n,u,t,i,f;for(n in r)u={key:n,value:r[n]},this.A(u.value);t=this.g;for(i in t)f={key:i,value:t[i]},f.value.dispose();this.b={};this.d={};this.g={};this.e={};System.a.a(this.j);this.j=null},G:function(){this.C()},H:function(){this.C()},J:function(){this.x();this.w()},E:function(n){for(var i=_Ewa.b.m(n.a()),f=new _Ewa.ba(i.x,i.y,i.width,i.height),u=_Ewa.gx.a(),e=u.length,r=0;r<e;++r){var o=u[r],s=this.a.n(o),t=_Ewa.b.h(s.j()),h=new _Ewa.ba(t.x,t.y,t.width,t.height);if(h.i(f))return t}return null},x:function(){var n=new Common.App.CollabControls.h;n.a(0,"ewaboot_presenceheadswhite");n.a(1,this.k);n.a(12,49);n.a(6,this.f);this.a&&(n.a(4,_Ewa.u.a(3)),n.a(5,_Ewa.u.a(3)),n.a(8,this.a.d()));n.a(18,!0);this.l=new Common.App.CollabControls.g(n);n.a(16,this.u)},P:function(n,t){var i=new Common.App.CollabControls.h;i.a(0,n?"ewaboot_presenceheadswhite":t);i.a(1,n===1?t:this.k);i.a(12,n===12?Number.parseInvariant(t.toString()):49);i.a(6,n===6?t:this.f);this.a&&(i.a(4,n===4?t:_Ewa.u.a(3)),i.a(5,n===5?t:_Ewa.u.a(3)),i.a(8,n===8?t:this.a.d()));this.l=new Common.App.CollabControls.g(i)},S:function(n){this.P(12,n)},C:function(){this.j=_Ewa.cV.a(this.v,100,_Ewa.o.ce,this.j)},Q:function(){var u=this.d,r,f,n;for(r in u)if(f={key:r,value:u[r]},n=f.value,n){var e=n.d(),i=this.b[n.a()],t=e?this.y(n.h(),n.b(),n.i()):null;t!==i?(i&&this.m(i,n.c().n,this.c,n.b(),n.a()),t&&e&&(t.b(n.c()),this.b[n.a()]=t,n.f(t),this.z(t,n))):this.z(i,n)}},z:function(n,t){this.e[t.a()]&&n.d(this.e[t.a()]);t.d()?t.e(!0,!0):t.e(!1,!0)},n:function(n,t){this.e[n]=t;var i=this.b[n];i&&i.d(t)},M:function(n,t){var i=this.b[n];i&&i.g(n,t)}};_Ewa.pq=function(n,t,i,r,u){this.F=Function.createDelegate(this,this.bp);this.H=Function.createDelegate(this,this.br);this.G=Function.createDelegate(this,this.bq);this.E=Function.createDelegate(this,this.bo);this.I=Function.createDelegate(this,this.bc);this.R=Function.createDelegate(this,this.bm);this.K=Function.createDelegate(this,this.bt);this.L=Function.createDelegate(this,this.bx);this.D=Function.createDelegate(this,this.bn);this.J=Function.createDelegate(this,this.bs);this.i={};_Ewa.pq.initializeBase(this,[!1]);this.u={};this.v={};this.m={};this.l={};this.h=n;this.w=r;this.q=t;this.j=i;this.bj();this.n=new _Ewa.AQ(n);this.h.d()&&this.h.d().c(this.J);this.q.b(this.D);n.c()&&this.h.c().j(this.L);this.k=[];this.q.a();n.a().b(_Ewa.mX,25,this);this.o=!1;this.h.F(this.K);this.r=_Ewa.B.a().b(this.R,this.O/2,_Ewa.o.cf,!0,!1);this.x=u};_Ewa.pq.a=function(n,t,i,r){var u;if(!r||!r.a()||!r.a().Object)return!1;for(var e=r.a().Object,o=e.length,f=0;f<o;++f)if(u=e[f],n&&u&&u.ObjectId&&!u.ObjectId.localeCompare(n))return Array.add(u.ObjectPresenceType===1?i:t,r.b.a.User),!0;return!1};_Ewa.pq.prototype={r:null,h:null,w:null,t:0,s:0,k:null,n:null,p:null,q:null,o:!1,z:null,O:3e4,m:null,u:null,v:null,y:!1,Q:!0,x:null,B:null,d:function(n){this.er("pcek",n)},g:function(n){this.es("pcek",n)},j:null,a:function(){return this.i},l:null,b:function(n){var t=this.i[n];t&&this.bd(n,!1)},bv:function(n){this.p&&this.p!==n.b()&&(this.Q=!1);this.j.f(n);this.p=n.b()},e:function(n,t,i,r){var u,f,o,e,s;i.val=[];r.val=[];u=this.i;for(f in u)o={key:f,value:u[f]},e=o.value,t?(s=_Ewa.h.D(n,this.h),this.Y(s,i.val,r.val,e)):this.X(n,i.val,r.val,e)},c:function(n,t,i,r,u){var f=this.i[u];f&&(t?this.Y(n,i,r,f):this.X(n,i,r,f))},f:function(){var r=[],u=this.i,t,n,l;for(t in u){var a={key:t,value:u[t]},f=a.value,e=f.a().SelectedRange;if(!isNullOrUndefined(e)&&_Ewa.a.b("OfficeVSO:5280212_Guard_PresenceState.SelectedRange"))for(var o=e,v=o.length,i=0;i<v;++i){var s=o[i],h=_Ewa.h.b(s),c=_Ewa.c.a(this.h).a().a().g();if(this.h.d().a().b()===s.SheetName&&h.c===c.c&&h.a===c.a){n=f.g();l=new Common.cW(n.User.UserID,n.User.UserName,n.UserColor,new Common.dc(1),null,n.UserEmail,null,null,!1,!1,!1,n.JoinCoauthTime,null,0);Array.add(r,l);break}}}return r},dispose:function(){var n,t,i;if(this.bw(),this.h&&(this.h.d()&&this.h.d().d(this.J),this.h.c()&&this.h.c().k(this.L),this.h.H(this.K)),this.q&&this.q.c(this.D),this.r&&(this.r.dispose(),this.r=null),this.i){n=this.i;for(t in n)i={key:t,value:n[t]},i.value.dispose()}System.a.b([this.j,this.n]);this.U();this.j=null;this.h=null;this.i=null;Array.clear(this.k);_Ewa.bX.prototype.dispose.call(this)},bw:function(){this.j&&(this.j.k(this.I),this.j.j(this.E),this.j.l(this.G),this.j.m(this.H));this.w.b(this.F)},bo:function(){var i=this.l,t,r,n;for(t in i)r={key:t,value:i[t]},n=r.key,this.S(n)?(this.A(n,!0),delete this.m[n],delete this.l[n]):Diag.a.a(20303883,0,50,"PresenceView.OnEcsUserListChanged: pending userId=[{0}] still not updated",n)},bc:function(n,t){var h={},b,it,u,e,c,l,a,i,f,r,k,o,d,v,s,y,p,w,g,nt,tt,rt;if(h.UpdatedCount=t.b?Object.keys(t.b).length:0,h.DisconnectedCount=t.a?t.a.length:0,_Ewa.Z.a(this.h).a(_Ewa.y.h,h,null,!1),_Ewa.a.b("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&(b=(new Date).getTime(),it=this,_Ewa.g.a(_Ewa.l.b(_Ewa.fB,this.h.a(),435,436,1,null),function(n){var t=n.a();t.d(b)},this.h.g(),3,null,null)),u=null,this.h.m()&&(u=this.h.m().b("ModelUpdate","PresenceRendering"),u.d()),e={},t.b){this.o||(this.P(!0),this.o=!0);c=t.b;for(l in c)(a={key:l,value:c[l]},i=a.key,this.v[i]=_Ewa.s.a().a(),f=a.value,this.V(i,new Date),this.bf(f),i!==this.p)&&(r=this.i[i],r||(this.S(i)?this.A(i,!0):(i in this.l?Diag.a.a(25187144,0,50,"PresenceView.OnSelectionPresenceChanged: userId=[{0}] already pending update",i):(this.m[i]=_Ewa.s.a().a(),e[i]=1),this.l[i]=!0,k=this.bi(i),this.i[i]=this.W(k)),r=this.i[i]),r&&(r.o(f),f.SelectedRange&&f.SelectedRange.length>1?this.t++:this.s++,this.be(i),this.M(r)))}if(t.a)for(o=0,d=t.a.length;o<d;o++)v=t.a[o],this.u[v]=_Ewa.s.a().a(),this.bd(v,!0);(t.a&&t.a.length>0||$$sc.j.a(e).length>0||$$sc.j.a(this.l).length>0)&&(s=[],Array.addRange(s,$$sc.j.a(e)),Array.addRange(s,$$sc.j.a(this.l)),y=this.h.a().a(_Ewa.hT,292,!1,null),y&&y.h(s,t.a));u&&u.a();this.y=!1;p=this.i;for(w in p)if(g={key:w,value:p[w]},nt=$$as(_Ewa.sE,g.value).a().CollabMode,!nt){this.y=!0;break}_Ewa.a.b("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&this.h.b()&&this.h.b().Y()&&(tt=(new Date).getTime(),rt=this,_Ewa.g.a(_Ewa.l.b(_Ewa.fB,this.h.a(),435,436,1,null),function(n){var t=n.a();t.c(tt)},this.h.g(),3,null,null));this.ep("pcek",t,null)},bx:function(n,t){t&&this.h.b().C()&&(t.a.HasAnyNonOcsCoauthor=this.y)},W:function(n){return new _Ewa.pr(n,this.h,this.n)},S:function(n){var t=this.h.b().bN(n),i;return t&&(n in this.i?this.i[n].z(t):(i=this.W(t),this.i[n]=i,this.M(i))),!!t},Y:function(n,t,i,r){var u,f,s;if(n)for(var h=n,l=h.length,e=0;e<l;++e){if(u=h[e],u){if(f=_Ewa.fY.b(u,this.h,1),f&&_Ewa.pq.a(f.R,t,i,r))return;if(f=_Ewa.fY.b(u,this.h,2),f&&_Ewa.pq.a(f.R,t,i,r))return}if(r.a().SelectedRange)for(var c=r.a().SelectedRange,a=c.length,o=0;o<a;++o)if(s=c[o],s&&u&&_Ewa.fY.a(u,s)){Array.add(r.a().PresenceType===1?i:t,r.b.a.User);return}}},X:function(n,t,i,r){n&&_Ewa.pq.a(this.bh(n),t,i,r)},bp:function(){var t=new Common.gc({},null),i=this.i;for(var r in i){var u={key:r,value:i[r]},f=u.key,e=u.value,n=e.a();n.SelectedRange=n.SelectedRangeRaw;t.b[f]=n}this.bc(this,t)},bf:function(n){n.SelectedRange&&(n.SelectedRangeRaw=this.bg(n.SelectedRange),n.SelectedRange=this.w.d(n.SelectedRange))},bg:function(n){for(var i=new Array(n.length),t=0;t<n.length;t++)i[t]=_Ewa.fY.c(n[t]);return i},bh:function(n){if(n)switch(n.a){case 0:var t=this.h.n().bD(n.c);return t?t.R:null;case 2:return n.E;default:return null}return null},bj:function(){this.j.c(this.I);this.j.d(this.G);this.j.b(this.E);this.j.e(this.H);this.w.a(this.F)},bb:function(n,t,i,r){var u={};u.a=this.h.e().UserSessionId;u.b=n;u.c=i?"PendingUserRemoved":"Non-PendingUserRemoved";u.d=r?"Disconnected":"Inactivity";u.e=t;_Ewa.E.a().a(22,u,!0)},bd:function(n,t){if(n in this.i){this.be(n);var i=this.i[n];i.dispose();delete this.i[n];Diag.a.a(38322520,0,50,"PresenceView.RemovePresenceForUser: userId=[{0}] removed due to inactivity",n);this.bb(n,_Ewa.s.a().a(),!1,t)}n in this.l&&(this.A(n,!1),delete this.m[n],delete this.l[n],Diag.a.a(38322521,0,50,"PresenceView.RemovePresenceForUser: Pending userId=[{0}] removed due to inactivity",n),this.bb(n,_Ewa.s.a().a(),!0,t))},be:function(n){for(var u,t=this.k.length-1;t>=0;t--)if(this.k[t].User.UserID===n){Array.removeAt(this.k,t);for(var r=this.i[n].d(),f=r.length,i=0;i<f;++i)u=r[i],this.n.n(u.u.y,!1);this.C()}},br:function(){this.Z()},bm:function(){this.z&&_Ewa.bV.a(_Ewa.s.a(),this.z)<this.O||(this.z=_Ewa.s.a().a(),this.N(),this.bk(),this.bl(),this.o||this.P(!1))},bl:function(){(this.s||this.t)&&(this.h.w(-70383382,-1,0,null),Diag.a.a(41477068,0,50,"PresenceView.LogDiscontinuousCountPresenceData: Discontinuous Presence Received with count= [{0}], Continuous Presence Received with count= [{1}]",this.t,this.s));this.s=0;this.t=0},bs:function(){var n,t,i;this.Z();n=this.i;for(t in n)i={key:t,value:n[t]},this.M(i.value)},bt:function(){this.N();this.o||this.P(!1);this.o=!1},U:function(){this.N();this.m=null;this.l=null},N:function(){var t=this.l,n,i;for(n in t)i={key:n,value:t[n]},this.A(i.key,!1)},bk:function(){var f=this.u,n,t,i,r,u;for(n in f)t={key:n,value:f[n]},this.ba(t.key,!0,t.value);i=this.v;for(r in i)u={key:r,value:i[r]},this.ba(u.key,!1,u.value);this.u={};this.v={}},A:function(n,t){var i,r;this.h.j()&&this.h.b().a()&&(i={},i.a=this.h.e().UserSessionId,i.b=n,i.c=t,i.e=!1,i.d=-1,i.f=_Ewa.s.a().a(),this.h.b()&&(i.e=this.h.b().B()),r=this.m[n],r&&(i.d=_Ewa.bV.a(_Ewa.s.a(),r)),_Ewa.E.a().a(20,i,!0))},P:function(n){if(this.h.j()){var t={};t.e=-1;t.f=-1;t.c=!1;t.d=!1;t.b=n;t.a=this.h.e().UserSessionId;this.h.b()&&(t.c=this.h.b().Y(),t.d=this.h.b().B(),t.e=this.h.b().u().length,this.h.b().bd()&&(t.f=_Ewa.bV.a(_Ewa.s.a(),this.h.b().cq())));_Ewa.E.a().a(21,t,!0)}},ba:function(n,t,i){if(this.h.j()){var r={};r.a=this.h.e().UserSessionId;r.b=n;r.c=t;r.d=i;_Ewa.E.a().a(19,r,!0)}},Z:function(){var f=[],e=this.i,i,o,n,t,h,l;for(i in e)if(o={key:i,value:e[i]},n=o.value,this.j.a(n.a())){this.T(f,n);Array.remove(this.k,n.b.a);this.j.g().PresenceType===1&&(t={},t.a=n.a().PresenceType===1?"Editing":"Non-Editing",t.b=this.h.e().UserSessionId,t.c=_Ewa.s.a().a(),_Ewa.E.a().a(18,t,!1));for(var s=n.d(),a=s.length,r=0;r<a;++r)h=s[r],this.n.n(h.u.y,!0)}else for(var c=n.d(),v=c.length,u=0;u<v;++u)l=c[u],this.n.n(l.u.y,!1);Array.clear(this.k);this.k=f;this.C()},T:function(n,t){var r=t.b.a,u,i;if(t.a().PresenceType)Array.add(n,r);else{for(u=n.length,i=0;i<u;i++)if(this.i[n[i].User.UserID].a().PresenceType)break;Array.insert(n,i,r)}},bq:function(){var t=this.i,n,i;for(n in t)i={key:n,value:t[n]},i.value.dispose();this.i={};this.U();this.m={};this.l={};Array.clear(this.k);this.C()},bn:function(n,t){this.bv(t.a)},M:function(n){var u,t,i,r;this.j.a(n.a())&&(this.T(this.k,n),this.C());u=n.b.a.User.UserID;t=this.i;for(i in t)r={key:i,value:t[i]},r.key!==u&&n.x(r.value)},C:function(){this.k.length>0&&this.bu(!0)},bu:function(n){for(var t,o,u,i=0,f=this.k.length;i<f;i++)if(t=this.i[this.k[i].User.UserID],t)if(n)if(this.j.i(t.a())){t.p(!0);for(var e=t.d(),s=e.length,r=0;r<s;++r)o=e[r],this.n.n(o.u.y,!0)}else u=this.j.h(t.a()),u&&t.q(!0,u);else t.p(!1),t.q(!1,null)},bi:function(n){var t={};return t.User={},t.User.UserID=n,t.User.UserName=_Ewa.ClientStringManager.a().c(83),t.UserColor="#AAAAAA",t},V:function(n,t){if(this.Q&&this.x){if(!n||!t){Diag.a.a(42481443,0,15,"userId: [{0}], endTime: [{1}]",n,t);return}if(this.B){this.B.a(n,t,this.p,0);return}var i=this;this.x.CW(function(){i.B=i.x.a();i.V(n,t)})}}};_Ewa.hp=function(n,t){this.E=Function.createDelegate(this,this.Z);this.I=Function.createDelegate(this,this.be);this.J=Function.createDelegate(this,this.bf);this.K=Function.createDelegate(this,this.bg);this.F=Function.createDelegate(this,this.ba);this.B=Function.createDelegate(this,this.V);this.H=Function.createDelegate(this,this.bd);this.D=Function.createDelegate(this,this.Y);this.u=Function.createDelegate(this,this.X);this.C=Function.createDelegate(this,this.W);this.G=Function.createDelegate(this,this.bc);this.y=Function.createDelegate(this,this.bb);this.L=Function.createDelegate(this,this.bh);this.M=Function.createDelegate(this,this.bi);_Ewa.hp.initializeBase(this,[!1]);this.n=n;this.q=_Ewa.c.a(this.n).a();this.w=t;this.n.C(this.M);this.n.F(this.L);this.o={};this.s=new Common.cW(null,null,null,null,null,null,null,null,!1,!1,!1,0,null,0);this.r={};this.r.b=0;this.r.c=0;this.z=new _Ewa.hp.e(this.n)};_Ewa.hp.a=function(){return _Ewa.hp.b||(_Ewa.hp.b={ApplyFilter:1,ApplyPivot:0,ApplyPivotSort:0,ApplyPivotSortByValue:1,ApplyWellKnownPivotFilter:0,RemovePivotFilter:0,SetCustomFilter:1,SetTop10Filter:1,TogglePivotDrill:0,RefreshAll:2})};_Ewa.hp.d=function(n,t){return!!n&&!!n.ObjectId&&!!t&&!!t.ObjectId&&(!n.ObjectType||n.ObjectType===2)&&n.ObjectType===t.ObjectType&&!n.ObjectId.localeCompare(t.ObjectId)};_Ewa.hp.c=function(n,t){return!n.NamedObjectName&&_Ewa.fY.a(n,t)};_Ewa.hp.prototype={n:null,w:null,q:null,p:null,s:null,t:null,r:null,z:null,c:function(n){this.er("presenceChanged",n)},k:function(n){this.es("presenceChanged",n)},b:function(n){this.n.b().P(n)},j:function(n){this.n.b().R(n)},e:function(n){this.er("selectionChanged",n)},m:function(n){this.es("selectionChanged",n)},d:function(n){this.er("presenceDisabled",n)},l:function(n){this.es("presenceDisabled",n)},o:null,g:function(){return this.o},Q:function(){return!this.n.b()||this.n.b().F()},dispose:function(){this.n&&(this.P(),this.n.D(this.M),this.n.H(this.L));this.p&&this.p.i(this.y);System.a.a(this.z);this.p=null;this.n=null;_Ewa.bX.prototype.dispose.call(this)},f:function(n){this.p?this.p.i(this.y):this.R();this.p=n;this.p?(this.p.f(this.y),this.x(!0)):this.P()},R:function(){var i,t,r,n;this.q.h(this.G);_Ewa.c.a(this.n).L(this.C);i=_Ewa.c.a(this.n).g();i.h(this.u);i.d(this.D);this.n.b().h(this.H);this.n.b().bx(this.B);this.w.a(this.F);t=this.n.c().a();t.t(this.K);t.d(this.J);t.c(this.I);r=_Ewa.l.b(_Ewa.ep,this.n.a(),16,74,1,null);n=this;_Ewa.g.a(r,function(t){n.t=t.a();n.t.V(n.E);n.t.U(n.u)},$$sc.f.a,3,null,null)},P:function(){this.q.k(this.G);_Ewa.c.a(this.n).M(this.C);var n=_Ewa.c.a(this.n).g();n.g(this.u);n.c(this.D);this.n.b().i(this.H);this.n.b().bP(this.B);this.w.b(this.F);this.t&&(this.t.bp(this.E),this.t.bo(this.u),this.n.c().a().v(this.K),this.n.c().a().g(this.J),this.n.c().a().f(this.I));this.ep("presenceDisabled",null,null)},a:function(n){return this.i(n)||!!this.h(n)},i:function(n){var f,e,t,i,o,s,r,u;if(this.o.Version===2&&this.o.Object&&n.Version===2&&n.Object&&this.o.Object.length>0&&n.Object.length>0)for(f=this.o.Object.length,e=n.Object.length,t=0;t<f;t++)for(i=0;i<e;i++)if(this.U(this.o.Object[t],n.Object[i]))return!0;if(this.o.SelectedRange&&n.SelectedRange)for(o=this.o.SelectedRange.length,s=n.SelectedRange.length,r=0;r<o;r++)for(u=0;u<s;u++)if(_Ewa.hp.c(this.o.SelectedRange[r],n.SelectedRange[u]))return!0;return!1},h:function(n){var r,u,t,i;if(this.o.Version===2&&this.o.Object&&n.Version===2&&n.Object&&this.o.Object.length>0&&n.Object.length>0)for(r=this.o.Object.length,u=n.Object.length,t=0;t<r;t++)for(i=0;i<u;i++)if(_Ewa.hp.d(this.o.Object[t],n.Object[i]))return this.o.Object[t].ObjectId;return null},U:function(n,t){return!!n&&!!t&&n.ObjectType===t.ObjectType&&(n.ObjectType===1||n.ObjectType===3)&&!!n.ObjectId&&!!t.ObjectId&&!n.ObjectId.localeCompare(t.ObjectId)},T:function(){this.x(!1)},x:function(n){this.q.b().a()?this.N(0,n):this.O(_Ewa.c.a(this.n).g().e()?1:0,n)},N:function(n,t){var u={},r,i,f;if(this.n.B(u),this.q.b().a()){if(r=this.q.b().a().a(),u.FirstColumn=-1,u.FirstRow=-1,u.LastColumn=-1,u.LastRow=-1,u.NamedObjectName=r?r.h():null,this.o.SelectedRange=[u],this.o.PresenceType=0,i=null,r)switch(r.a){case 0:f=this.n.n().bD(r.c);f&&(i={},i.ObjectType=this.v(0),i.ObjectPresenceType=n,i.ObjectId=f.R);break;case 2:r.c&&(i={},i.ObjectType=this.v(9),i.ObjectPresenceType=n,i.ObjectId=r.E)}this.o.Object=[i]}this.ep("selectionChanged",null,null);this.A(t)},O:function(n,t){var u,f,s,r,i;if(!_Ewa.c.a(this.n).m()&&!_Ewa.c.a(this.n).A()){u=this.n.m().b("ModelUpdate","SendRangePresence");u.d();f=_Ewa.h.D(this.q.a().b(),this.n);this.o.SelectedRange=this.w.c(f);this.o.Object=[];for(var o=f,h=o.length,e=0;e<h;++e)s=o[e],r=_Ewa.fY.b(s,this.n,1),r&&(i={},i.ObjectType=this.v(r.Q),i.ObjectPresenceType=0,i.ObjectId=r.R,Array.add(this.o.Object,i));this.o.PresenceType=n;this.ep("selectionChanged",null,null);this.o.SelectedRange||this.o.Object?this.A(t):Diag.a.a(41185635,0,50,"SelectionPresenceManager.SendRangePresence: skip sending range presence since selected range/object are both null.  UserId: [{0}]",this.p.b());u.a()}},A:function(n){if((this.n.b().bC()||!this.n.b().bo()||n)&&(this.Q()||++this.r.b,this.p)){if(this.o.Version=2,this.o.ClientType=1,this.o.ChatThreadId=this.s.u,this.o.ChatThreadDiscoveryUri=this.s.t,this.o.InChat=this.s.v,this.o.Cid=this.s.s,this.o.SupportsChat=!!this.s.q&&this.s.q.a(4),this.o.CollabMode=this.n.b().T()?2:0,this.o.OcsCapable=this.n.b().bI(),this.p.r(this.o),_Ewa.a.b("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&this.n.b()&&this.n.b().Y()){var t=(new Date).getTime(),i=this;_Ewa.g.a(_Ewa.l.b(_Ewa.fB,this.n.a(),435,436,1,null),function(n){var i=n.a();i.e(t)},this.n.g(),3,null,null)}this.Q()||++this.r.c}},W:function(){this.n&&this.N(0,!1)},Y:function(){this.o.PresenceType=1;this.ep("selectionChanged",null,null);this.A(!1)},X:function(){this.x(!1);this.S()},Z:function(){this.q.b().a()?this.N(1,!1):this.O(0,!1)},bb:function(n,t){this.ep("presenceChanged",t,null)},bc:function(){this.O(_Ewa.c.a(this.n).m()?1:0,!1)},bd:function(n,t){_Ewa.nq.a(t)&&(this.o={})},ba:function(){this.T()},bg:function(n,t){var i,e,c,o,h,u,f,r;if(t&&t.b in _Ewa.hp.a()){i=null;e=!1;switch(_Ewa.hp.a()[t.b]){case 0:i=t.c.cell;break;case 1:i=t.c.parameters.Location;break;case 2:c=this.q.a().e();i=_Ewa.h.a(c,this.n);e=!0;break;default:return}if(i.LastColumn=i.FirstColumn,i.LastRow=i.FirstRow,i.NamedObjectName=null,this.o.SelectedRange=[i],this.o.PresenceType=0,e){o=[];for(var l=this.n.n().bW(1),a=l.length,s=0;s<a;++s)h=l[s],u={},u.ObjectType=this.v(h.Q),u.ObjectPresenceType=1,u.ObjectId=h.R,Array.add(o,u);this.o.Object=o}else f=_Ewa.fY.b(i,this.n,1),r=null,f&&(r={},r.ObjectType=this.v(f.Q),r.ObjectPresenceType=0,r.ObjectId=f.R),this.o.Object=[r];this.ep("selectionChanged",null,null);this.A(!1)}},be:function(n,t){t.a.a in _Ewa.hp.a()&&(this.o.Object=[null],this.x(!1))},bf:function(n,t){t.b.a in _Ewa.hp.a()&&(this.o.Object=[null],this.x(!1))},bi:function(n,t){t.b||(this.o={},this.n.j()?this.R():this.P())},bh:function(){this.S()},S:function(){this.n.j()&&(this.r.a=this.n.e().UserSessionId,_Ewa.E.a().a(26,this.r,!0));this.r.b=0;this.r.c=0},v:function(n){switch(n){case 0:return 0;case 1:return 1;case 2:return 3;case 9:return 2;default:return-1}},V:function(){this.T();this.z.c()}};_Ewa.hp.e=function(n){_Ewa.hp.e.initializeBase(this,[!1]);this.a=n;var t=this;this.a.a().c(_Ewa.cb,29,function(n){t.b=n;n.c(t)},null)};_Ewa.hp.e.prototype={a:null,b:null,l:function(n){this.er("OSC",n)},k:function(n){this.es("OSC",n)},c:function(){this.ep("OSC",null,null)},f:function(n,t){if(n==="QueryOcsConnectionStatus")t.Value=this.a.b().T()?_Ewa.ClientStringManager.a().a(859):_Ewa.ClientStringManager.a().a(860);else return!1;return!0},h:function(){return!0},dispose:function(){this.b&&(this.b.b(this),this.b=null);this.a=null;_Ewa.bX.prototype.dispose.call(this)}};_Ewa.Wb=function(n){_Ewa.Wb.initializeBase(this);this.m=n;this.l()};_Ewa.Wb.prototype={m:null,i:null,a:function(){if(this.i)this.k(this.i);else{var n=this;_Ewa.g.a(_Ewa.l.a(_Ewa.mU,this.m.a(),28,this.h(),this.j,null),function(t){n.k(n.i||(n.i=new _Ewa.hp(n.m,t.a())))},this.h(),3,null,null)}}};_Ewa.Wc=function(n,t,i,r,u){this.L=Function.createDelegate(this,this.W);this.G=Function.createDelegate(this,this.V);this.Q=Function.createDelegate(this,this.Z);this.J=Function.createDelegate(this,this.X);this.z=[];_Ewa.Wc.initializeBase(this,[!1]);this.y=n;this.w=t;this.O=n.id;this.A=r;this.K=u;this.E=!1;this.S();this.M=i;this.C=null;this.x={};this.x.FirstColumn=0;this.x.FirstRow=0;this.x.LastColumn=0;this.x.LastRow=0};_Ewa.Wc.prototype={w:null,y:null,B:null,E:!1,I:!1,x:null,C:null,F:null,K:null,D:null,j:function(n){this.er("hidePresenceTooltip",n)},p:function(n){this.es("hidePresenceTooltip",n)},m:function(n){this.er("showPresenceTooltip",n)},r:function(n){this.es("showPresenceTooltip",n)},l:function(n){this.er("showFullPresenceTooltip",n)},q:function(n){this.es("showFullPresenceTooltip",n)},k:function(n){this.er("presenceChanged",n)},s:function(n){this.es("presenceChanged",n)},O:null,a:function(){return this.O},M:null,c:function(){return this.M},A:0,b:function(){return this.A},h:function(){if(!this.y)return null;var t=this.w.n(this.A).y(),u=this.w.d(),f=this.y.offsetWidth;if(!this.C&&f<=4){if(this.x){var n=this.w.s(),i=this.x.FirstRow,r=u?this.x.FirstColumn:this.x.LastColumn;if(n&&!(i>=n.a&&i<=n.d&&r>=n.b&&r<=n.c))return i=i<=n.a?t.a.b:t.a.b+(i>=n.d?t.d():t.d()/2),r=r<=n.b?t.a.a:t.a.a+(r>=n.c?t.c():t.c()/2),this.F=new Sys.UI.Point(r,i)}return this.F}if(this.C){var s=this.y.offsetTop-2,e=parseInt(this.y.style.left),o=0;return u&&(o=parseInt(this.y.parentNode.style.width)-f-e-(this.w.bi().b()&&this.w.bi().c()?_Ewa.be.a():0)),this.F=new Sys.UI.Point((u?o:e)+f+4,s)}return this.F=new Sys.UI.Point(parseInt(u?this.y.style.right:this.y.style.left)+f,this.y.offsetTop)},H:!1,g:function(){return this.H},t:function(n){return this.H=n,n},N:null,i:function(){return _Ewa.h.b(this.x)},dispose:function(){this.ep("hidePresenceTooltip",null,null);this.ep("presenceChanged",null,null);this.R();this.P();System.a.a(this.D);this.w=null;this.y=null;this.N=null;_Ewa.bX.prototype.dispose.call(this)},u:function(n,t){var i=!!n&&!_Ewa.h.b(n).g(_Ewa.h.b(this.x)),r=!!t&&(!this.C||this.C.W()!==t.W());(i||r)&&(this.ep("presenceChanged",null,null),this.R(),this.H=!1,this.x=n,this.C=t,this.F=null)},o:function(n){this.H=!1;this.I=!1;n&&this.ep("hidePresenceTooltip",null,null)},n:function(n){Array.add(this.z,n);this.S();n.k(this.J)},e:function(n,t){if(n){if(this.I=!0,t){var i=this.K.e().ShowTooltipDelayInMs;this.D=_Ewa.cV.a(this.Q,i,_Ewa.o.cX,this.D)}}else this.o(t)},f:function(n){this.N=n},v:function(){if(this.y&&this.I){this.B=_Ewa.b.h(this.y);var n=Math.floor(this.B.x);this.B.x=n===this.B.x?n:n+1;this.B.y=Math.floor(this.B.y)}},d:function(){var n,t,i;return this.x?_Ewa.a.a(887)?(n=this.U(),!n)?!1:this.w.dz(n,this.A):(t=this.w.n(this.A).y(),i=this.w.w(this.i(),this.A,!1,!1),t.i(i)):!1},U:function(){var n,t;return this.i().m()?(n=this.w.b().t(this.i(),this.K.J()),!n)?null:(t=n.g(this.i(),!0,!1),!t)?null:t.d():this.i()},Z:function(){(System.a.a(this.D),this.D=null,this.I)&&(this.d()?this.ep("showPresenceTooltip",null,null):this.o(!0))},R:function(){for(var n=0,t=this.z.length;n<t;n++)this.z[n].s(this.J);Array.clear(this.z);this.P()},S:function(){!this.E&&this.z.length>=1&&(this.E=!0,this.w.b().j(this.G),this.w.b().g(this.G),this.w.i().d(this.L))},P:function(){this.E&&!this.z.length&&(this.E=!1,this.w&&(this.w.b().k(this.G),this.w.b().e(this.G),this.w.i().c(this.L)))},Y:function(n){n.s(this.J);Array.remove(this.z,n);this.P()},X:function(n){var t=n;this.Y(t)},V:function(){this.T()},W:function(){this.T()},T:function(){this.v();for(var n=0,t=this.z.length;n<t;n++)this.z[n].v()}};_Ewa.pr=function(n,t,i){this.r=Function.createDelegate(this,this.J);this.s=Function.createDelegate(this,this.K);this.e=new _Ewa.w(!0);_Ewa.pr.initializeBase(this);this.b=new _Ewa.AR(n);this.y(n);this.f=i;this.n([]);this.c=t;this.c.d().c(this.s);_Ewa.c.a(this.c).W(this.r)};_Ewa.pr.a=function(n,t,i,r,u,f){var e=n===1?37:36;r&&i&&r.a()===i.SheetName?(t.val.b(_Ewa.h.b(i),[e],!0),t.val.bK(e),Diag.a.b(41754975,0,t.val.u.y===u.User.UserID,"UserID and UnitID should match"),f.M(t.val.u.y,n===1)):t.val.bH([e])};_Ewa.pr.prototype={c:null,f:null,i:0,j:0,t:0,a:function(){return this.b.d()},o:function(n){return this.b.e(n),this.w(),n},dispose:function(){this.c&&(this.c.d()&&this.c.d().d(this.s),_Ewa.c.a(this.c).R(this.r));this.A();System.a.b(this.d());System.a.b([this.b]);this.c=null;this.b=null;this.n(null);this.e=null;_Ewa.bhG.prototype.dispose.call(this)},A:function(){if(this.e){for(var n=0;n<this.e.a.length;n++)this.e.a[n].dispose();this.e.f()}},x:function(n){this.a().Version===1?this.E(n):this.F(n)},E:function(n){var r,u,t,i;if(n.a().SelectedRange&&this.a().SelectedRange)for(r=this.a().SelectedRange.length,u=n.a().SelectedRange.length,t=0;t<r;t++)for(i=0;i<u;i++)if(_Ewa.fY.a(this.a().SelectedRange[t],n.a().SelectedRange[i])){this.d()[t].W(n.h(i));return}},F:function(n){var e=0,o=0,p,s,t,i,h,c,r,l,a,w,b,u,f,v,y;if(this.a()&&this.a().Object&&n.a()&&n.a().Object)for(p=this.a().Object.length,s=n.a().Object.length,t=0;t<p;t++)if(this.a().Object[t]&&this.v(this.a().Object[t])){for(e++,i=0;i<s;i++)if(n.a().Object[i]&&this.v(n.a().Object[i])&&(o++,this.D(this.a().Object[t],n.a().Object[i])&&(h=this.h(e),c=n.h(o),h&&c))){h.W(c);return}}else if(this.a().Object[t]&&n.a().Object[t]&&(!this.a().Object[t].ObjectType||this.a().Object[t].ObjectType===2))for(r=0;r<s;r++)if(n.a().Object[r]&&(!n.a().Object[t].ObjectType||n.a().Object[t].ObjectType===2)&&this.a().Object[t].ObjectId===n.a().Object[r].ObjectId&&(l=this.m(this.a().Object[t].ObjectId),a=n.m(this.a().Object[t].ObjectId),l&&a)){l.k(a);return}if(n.a().SelectedRange&&this.a().SelectedRange)for(w=this.a().SelectedRange.length,b=n.a().SelectedRange.length,u=0;u<w;u++)for(f=0;f<b;f++)if(_Ewa.fY.a(this.a().SelectedRange[u],n.a().SelectedRange[f])&&(v=this.h(e+u),y=n.h(o+f),v&&y)){v.W(y);return}},D:function(n,t){return!!n&&!!t&&t.ObjectType===n.ObjectType&&(n.ObjectType===1||n.ObjectType===3)&&!n.ObjectId.localeCompare(t.ObjectId)},h:function(n){return n>=0&&this.d().length>n?this.d()[n]:null},p:function(n){for(var t=0,i=this.d().length;t<i;t++)this.d()[t].bm(n)},m:function(n){return n&&this.e.d(n)?this.e.b[n]||null:null},q:function(n,t){var r,i,u;if(n)r=this.e.b[t]||null,r&&r.j(!0);else for(i=0;i<this.e.a.length;i++)u=this.e.a[i],u&&u.j(!1)},z:function(n){_Ewa.sE.a(this,n)},u:function(n,t){if(n<t)return this.d()[n];if(!this.g()||!this.c||!this.f)return null;var i=new _Ewa.fZ(this.g(),this.c,this.f);return Array.add(this.d(),i),i},L:function(){for(var t,f,e,i,r=this.d().length,u=this.a().SelectedRange?this.a().SelectedRange.length:0,o=this.c.d().a(),n=0;n<u;n++)(t=this.u(n,r),t&&this.a().SelectedRange[n])&&(this.a().SelectedRange[n].NamedObjectName?t.a([37,36]):(t.Y(this.a().SelectedRange[n],this.a().PresenceType),_Ewa.pr.a(this.a().PresenceType,f={val:t},this.a().SelectedRange[n],o,this.g(),this.f),t=f.val));for(e=!!this.b&&!!this.b.b&&this.b.b.PresenceType!==this.b.d().PresenceType,i=e?0:u;i<r;i++)this.d()[i].a([this.b.b.PresenceType===1?37:36])},v:function(n){if(n&&n.ObjectId&&(this.B(n.ObjectType)===1||this.B(n.ObjectType)===2)){var t=this.c.n().bv(n.ObjectId);if(t)return _Ewa.h.W(t)}return null},M:function(){for(var u,f,n,e,o,l,i,t,a,v,s,y,h=this.d().length,r=this.c.d().a(),p=this.a().SelectedRange?this.a().SelectedRange.length:0,w=this.a().Object?this.a().Object.length:0,c=0;c<h;c++)this.d()[c].a([37,36]);for(this.G(),u=0,this.i=0,this.j=0,f=0;f<w;f++)n=this.a().Object[f],e=this.v(n),e&&(o=this.u(u,h),n.ObjectType===1?this.i++:n.ObjectType===3&&this.j++,u++,o.Y(e,n.ObjectPresenceType),_Ewa.pr.a(n.ObjectPresenceType,l={val:o},e,r,this.g(),this.f),o=l.val);for(i=0;i<p;i++)if(this.a()&&this.a().SelectedRange&&(t=this.a().SelectedRange[i],!t.NamedObjectName)){if(a=!!r&&t.SheetName===r.a(),v=!!_Ewa.fY.b(t,this.c,1),a&&v)continue;s=this.u(u+i,h);s.Y(t,this.a().PresenceType);_Ewa.pr.a(this.a().PresenceType,y={val:s},t,r,this.g(),this.f);s=y.val}(this.t=this.C())>0&&Diag.a.a(25190625,0,50,'{{"SetAllFloatingObjectPresenceHighlights":"Success"}')},G:function(){this.C();this.A()},C:function(){var t=0,n,i;if(this.a()&&this.a().Object)for(n=0;n<this.a().Object.length;n++)i=this.a().Object[n],this.N(i)&&t++;return t},H:function(n,t){var r,i;return this.e.d(t)?(r=this.e.b[t]||null,r.a(n),r):!this.g()||!this.c||!this.f?null:(i=new _Ewa.VV(this.g(),this.c,this.f),i.a(n),this.e.c(t,i),i)},N:function(n){var r=!1,t,i;if(n&&n.ObjectId&&(!n.ObjectType||n.ObjectType===2))try{t=this.I(n);t&&(i=this.H(t,n.ObjectId),i.c(t,n.ObjectPresenceType),i.b(),r=!0)}catch(u){Diag.a.a(25190626,0,10,'{{"UpdatedFloatingObjectPresence":"Fail","Exception":"{0}"}',u.stack);throw u;}return r},I:function(n){var t,r,i;return n?(t=null,n.ObjectType===2?t=_Ewa.T.a(this.c).o(n.ObjectId):n.ObjectType||(r=this.c.n(),i=r.bv(n.ObjectId),i&&i.T&&(t=_Ewa.T.a(this.c).I(i.T))),t):null},w:function(){try{this.a().Version===1?(this.L(),Diag.a.a(25031579,0,50,'{{"SetGridHighlightPass":"V1"}')):(this.M(),Diag.a.a(25031580,0,50,'{{"FloatingObjects":"{0}","PivotTables":"{1}","QueryTables":"{2}"}',this.t,this.i,this.j))}catch(n){Diag.a.a(25031581,0,10,'{{"SetGridHighlight Exception":"{0}"}',n.stack);throw n;}},J:function(){this.w()},K:function(){this.w()},B:function(n){switch(n){case 0:return 0;case 1:return 1;case 3:return 2;case 2:return 9;default:return-1}}};_Ewa.AR=function(n){_Ewa.AR.initializeBase(this,[!1]);this.a=n;this.c=null;this.b=null};_Ewa.AR.prototype={c:null,a:null,d:function(){return this.c||{}},e:function(n){return this.b=this.c,this.c=n,this.ep("userPresenceChanged",null,null),n},b:null,dispose:function(){this.ep("userPresenceChanged",null,null);this.ep("userLeft",null,null);this.a=null;this.c=null;this.b=null;_Ewa.bX.prototype.dispose.call(this)}};_Ewa.boa=function(){};_Ewa.boa.b=function(){_Ewa.m.a(function(n){var t,i,r;_Ewa.a.b("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&_Ewa.AP.a(n);t=n.a();t.b(_Ewa.blK.$$(_Ewa.mU),28,new _Ewa.VW(n));t.b(_Ewa.blK.$$(_Ewa.pp),158,new _Ewa.Wb(n));_Ewa.m.a(_Ewa.sG.a);i=_Ewa.l.a(_Ewa.pp,n.a(),158,t.d(),1,null);r=_Ewa.l.a(_Ewa.mU,n.a(),28,t.d(),1,null);_Ewa.g.a(_Ewa.g.b([i,r],t.d(),3),function(){var f=new($$sc.D.$$(Common.ej)),e=t.a(_Ewa.kg,26,!1,null),u;e.f(f.h);u=new _Ewa.pq(n,e,i.a(),r.a(),Common.Utils.b.a(Common.App.CoauthTelemetry.b,Common.Utils.a.a().b(Common.App.CoauthTelemetry.b,null)));_Ewa.fa.a(n.a()).a(u);t.b(_Ewa.blK.$$(Common.eO),159,new _Ewa.sG);_Ewa.g.a(_Ewa.l.a(Common.eO,t,159,t.d(),1,null),function(t){var r=new($$sc.D.$$(Common.hy)),i,e;r.b(u);e=new Common.App.Presence.a((i=new Common.cW,i.n=n.k().ClientId,i),f.a,r.a,t.a(),Common.T.a(),Common.a.a.a("AwayStatusOneMinuteTimeoutIsEnabled")?6e4:Common.a.a.c("AwayCoauthorThresholdMs",9e5),Common.a.c().t,_Ewa.boa.a.b(),!1)},t.d(),3,null,null)},t.d(),3,null,null);Common.Utils.a.a().c(_Ewa.Oh,null).c(Common.dm,null).a().b(function(){return n.b()});Common.Utils.a.a().a(Common.dm,null);Common.Utils.a.a().c(_Ewa.AO,null).c(Common.cd,null).a().b(function(){return new _Ewa.AO(n)});Common.Utils.a.a().a(Common.cd,null)})};_Ewa.boa.a=function(){};_Ewa.boa.a.b=function(){return _Ewa.boa.a.a||(_Ewa.boa.a.a=new _Ewa.boa.a),_Ewa.boa.a.a};_Ewa.boa.a.prototype={a:function(){Diag.a.a(38339419,0,50,"PresenceBootstrapper.AddNotificationBarEntry: User state changed from inactive to active")},b:function(n,t){return new CommonUI.p(n,t)},dispose:function(){}};_Ewa.Wa=function(){};_Ewa.Wa.a=function(n,t,i,r,u,f){var e=n.a(1,f);return _Ewa.k.a(n,"GetNamedSheetViewConversion",e,t,i,r,u,132,null,null)};_Ewa.fY=function(){};_Ewa.fY.c=function(n){var t={};return t.SheetName=n.SheetName,t.FirstColumn=n.FirstColumn,t.FirstRow=n.FirstRow,t.LastRow=n.LastRow,t.LastColumn=n.LastColumn,t.NamedObjectName=n.NamedObjectName,t};_Ewa.fY.a=function(n,t){return!!n&&!!t&&n.SheetName===t.SheetName&&(!!n.NamedObjectName&&n.NamedObjectName===t.NamedObjectName||!n.NamedObjectName&&!t.NamedObjectName&&_Ewa.h.b(n).i(_Ewa.h.b(t)))};_Ewa.fY.b=function(n,t,i){var u,r;if(!t||!t.n())return null;for(u=0;u<t.n().e();u++)if(r=t.n().g(u),r&&r.Q===i&&r.O&&r.O.h(_Ewa.h.b(n))&&_Ewa.f.b(r.P,n.SheetName,!0))return r;return null};_Ewa.AN=function(){};_Ewa.AN.a=function(n,t,i){if(!t)return null;var r=n.x();return new Sys.UI.Point(t.x+r.a*(i?1:-1),t.y+r.b*(i?1:-1))};_Ewa.Uf.registerClass("_Ewa.Uf",_Ewa.bX,_Ewa.mU,Sys.IDisposable);_Ewa.VV.registerClass("_Ewa.VV",null,_Ewa.bnY,Sys.IDisposable);_Ewa.sE.registerClass("_Ewa.sE",_Ewa.bhG);_Ewa.VW.registerClass("_Ewa.VW",_Ewa.sS.$$(_Ewa.mU));_Ewa.gx.registerClass("_Ewa.gx",_Ewa.bX,Common.App.CollabControls.l,Sys.IDisposable);_Ewa.sF.registerClass("_Ewa.sF",_Ewa.bX,_Ewa.bnZ,Sys.IDisposable);_Ewa.AO.registerClass("_Ewa.AO",null,Common.cd,Sys.IDisposable);_Ewa.sG.registerClass("_Ewa.sG",_Ewa.sS.$$(Common.eO));_Ewa.fZ.registerClass("_Ewa.fZ",_Ewa.hh);_Ewa.AP.registerClass("_Ewa.AP",_Ewa.sS.$$(_Ewa.fB));_Ewa.AQ.registerClass("_Ewa.AQ",null,Sys.IDisposable);_Ewa.pq.registerClass("_Ewa.pq",_Ewa.bX,_Ewa.mX,Common.hy);_Ewa.hp.registerClass("_Ewa.hp",_Ewa.bX,_Ewa.pp,Sys.IDisposable);_Ewa.hp.e.registerClass("_Ewa.hp.e",_Ewa.bX,Sys.IDisposable,_Ewa.yK,Common.IRootUser);_Ewa.Wb.registerClass("_Ewa.Wb",_Ewa.sS.$$(_Ewa.pp));_Ewa.Wc.registerClass("_Ewa.Wc",_Ewa.bX,_Ewa.bnZ,Sys.IDisposable);_Ewa.pr.registerClass("_Ewa.pr",_Ewa.sE);_Ewa.AR.registerClass("_Ewa.AR",_Ewa.bX);_Ewa.gx.b=null;_Ewa.fZ.c=[36,37];_Ewa.fZ.a=null;_Ewa.hp.b=null;_Ewa.boa.a.a=null;_Ewa.boa.b();Type.registerNamespace("_Ewa");_Ewa.sH=function(n,t,i){this.g=Function.createDelegate(this,this.i);_Ewa.sH.initializeBase(this,[!1]);this.e=t;this.h=n;this.d=i;this.b=[];i.d(this.g);this.e.a().b(_Ewa.ps,231,this)};_Ewa.sH.a=function(n,t){var i,r,u,f;return!n.length&&!t.length?"":t.length?t.length===1?(i=_Ewa.ClientStringManager.a().c(79),String.format(i,t[0].UserName)):(r=_Ewa.ClientStringManager.a().c(80),String.format(r,t.length)):n.length===1?(u=_Ewa.ClientStringManager.a().c(81),String.format(u,n[0].UserName)):(f=_Ewa.ClientStringManager.a().c(82),String.format(f,n.length))};_Ewa.sH.prototype={e:null,h:null,d:null,b:null,f:null,c:null,a:function(n,t){var i,r,u,f;return this.b=[],this.d.e(n,t,u={val:i},f={val:r}),i=u.val,r=f.val,Array.addRange(this.b,i),Array.addRange(this.b,r),_Ewa.sH.a(i,r)},dispose:function(){this.d.g(this.g);this.c&&(System.a.a(this.c),this.c=null);_Ewa.bhG.prototype.dispose.call(this)},i:function(n,t){var s,h,l,a,f,y,p;if(t.b){var i=[],r=[],u=_Ewa.c.a(this.e).a(),e=!(u.c()===2||u.c()===128),o;o=e?_Ewa.h.D(u.a().b(),this.e):u.b().a().a();s=t.b;for(h in s)l={key:h,value:s[h]},a=l.key,this.d.c(o,e,i,r,a);for(var v=this.b,w=v.length,c=0;c<w;++c)f=v[c],Array.contains(i,f)||Array.contains(r,f)||this.d.c(o,e,i,r,f.UserID);this.b=[];Array.addRange(this.b,i);Array.addRange(this.b,r);this.f&&(System.a.a(this.c),this.c=null,this.f=null);y=_Ewa.sH.a(i,r);this.c=new _Ewa.gr;p=this;this.f=_Ewa.g.a($$sc.a.b(1),function(){p.h.d(y,"polite")},this.c.a(),3,null,null)}}};_Ewa.sH.registerClass("_Ewa.sH",_Ewa.bhG,_Ewa.ps);Type.registerNamespace("_Ewa");_Ewa.Wd=function(){};_Ewa.Wd.b=function(){_Ewa.m.a(_Ewa.Wd.a)};_Ewa.Wd.a=function(n){var t=n.a(),i=_Ewa.l.b(_Ewa.cA,n.a(),211,212,1,null);t.c(_Ewa.mX,25,function(r){_Ewa.g.a(i,function(i){var u=t.a(_Ewa.ps,231,!1,null)||new _Ewa.sH(i.a(),n,r)},t.d(),3,null,null)},null)};_Ewa.Wd.b();Type.registerNamespace("_Ewa");_Ewa.Ba=function(n){this.p=Function.createDelegate(this,this.t);this.n=Function.createDelegate(this,this.v);_Ewa.Ba.initializeBase(this,[!1]);this.l=n;this.l.F(this.n);this.l.b().bl(this.n);var t=this;n.a().c(Common.hB,38,function(n){n.g(t.n)},null)};_Ewa.Ba.a=function(n){n.a().b(_Ewa.kg,26,new _Ewa.Ba(n))};_Ewa.Ba.prototype={l:null,o:null,r:null,b:function(n){this.er("connectionCompleted",n)},c:function(n){this.es("connectionCompleted",n)},h:function(n){this.er("rtcInitialized",n)},d:function(n){this.es("rtcInitialized",n)},g:function(n){this.er("connectionLostEventKey",n)},k:function(n){this.es("connectionLostEventKey",n)},m:null,j:function(){return this.m},q:!1,i:function(){return this.q},dispose:function(){this.m&&this.m.h(this.p);this.l&&this.l.H(this.n);this.l=null;this.m=null;_Ewa.bX.prototype.dispose.call(this)},f:function(n){var t=this;_Ewa.g.a(this.s().a,function(t){n(t.a())},this.et(),3,null,null)},e:function(n,t){this.q=t;this.u(n)},a:function(){this.m&&(this.ep("rtcInitialized",null,null),this.m.g()===2&&this.o&&this.ep("connectionCompleted",new _Ewa.vW(this.m),this.o))},u:function(n){var i,r,t;Diag.a.a(9245249,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice");i=[];i.push(_Ewa.u.b.a(42));i.push(_Ewa.u.b.a(43));i.push(Common.a.bN(_Ewa.u.b.a(10),0));this.l.e().StatusBarEnvironmentNameToUse==="Dev Box"&&Common.k.b(window.location.href,"wdjs",!1)==="local"&&(i[2]="https://localhost:8080/Ewa.Debug.rt.js");r=_Ewa.u.k(i,4,this.l.g(),1,0);t=this;_Ewa.g.a(r,function(){var r,u,i;Diag.a.a(571770433,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice Before RealtimeChannel create. RealtimeChannel = null: {0}",isNullOrUndefined(AppRealtimeChannel.n));_Ewa.a.b("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&(r=(new Date).getTime(),_Ewa.g.a(_Ewa.l.b(_Ewa.fB,t.l.a(),435,436,1,null),function(n){var t=n.a();t.h(r)},t.l.g(),3,null,null));t.m=AppRealtimeChannel.n.c(n,t.l.e().UserSessionId,Common.a.ex,Common.a.e,null,2,_Ewa.E.a().m(),t.l.k().RtcEndpointUrl,null,new AppRealtimeChannel.g,null,null,t.l.k().RtcBootToken);Diag.a.a(571770432,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice RealtimeChannel created");t.s().b(t.m);_Ewa.a.b("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&(u=(new Date).getTime(),_Ewa.g.a(_Ewa.l.b(_Ewa.fB,t.l.a(),435,436,1,null),function(n){var i=n.a();i.g(t.q,u)},t.l.g(),3,null,null));t.ep("rtcInitialized",null,null);Diag.a.a(571770403,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice raise RealTimeChannelInitializedEventKey");i=$$as(AppRealtimeChannel.d,t.m);i&&(Diag.a.a(571770402,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice attach changed handler"),i.e(t.p),i.l())},this.et(),3,null,null)},t:function(n,t){if(t.a===2){if(this.m){if(_Ewa.a.b("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var i=(new Date).getTime(),r=this;_Ewa.g.a(_Ewa.l.b(_Ewa.fB,this.l.a(),435,436,1,null),function(n){var t=n.a();t.f(i)},this.l.g(),3,null,null)}this.ep("connectionCompleted",new _Ewa.vW(this.m),t)}else Diag.a.a(38396034,0,15,"RealTimeChannelController.OnConnectionStateChanged: new state is connected and this.RealTimeChannel is null");this.o=t}else t.b!==2&&t.a||(this.o=null,this.ep("connectionLostEventKey",null,null))},v:function(){if(this.m){var n=$$as(AppRealtimeChannel.d,this.m);n&&(Diag.a.a(36573253,0,50,"RealTimeChannelController.OnWorkbookClosed: disconnecting from RTC"),n.m(),n.h(this.p))}this.m=null},s:function(){return this.r||(this.r=new($$sc.D.$$(Common.ej)))}};_Ewa.Ba.registerClass("_Ewa.Ba",_Ewa.bX,_Ewa.kg,_Ewa.blz);Type.registerNamespace("_Ewa");_Ewa.bov=function(){};_Ewa.bov.a=function(){_Ewa.m.a(_Ewa.Ba.a)};_Ewa.bov.a();Type.registerNamespace("_Ewa");_Ewa.Vv=function(n,t,i,r){this.v=Function.createDelegate(this,this.C);this.t=Function.createDelegate(this,this.A);this.u=Function.createDelegate(this,this.B);_Ewa.Vv.initializeBase(this,[n,null]);var u="<div id='notificationBody'>\r\n<div class='clip16x16' id='notificationUserImage'><img class='{0}' src='{1}' id='singleUserImage'/><img class='{2}' src='{3}' id='multiUserImage'/><\/div>\r\n<span class='ewa-new-user-notification-text' id='notificationText'><\/span>\r\n<div class='clip16x16' id='notificationImage'><img class='{4}' src='{5}' alt='{6}' title='{6}' /><\/div>\r\n<\/div>\r\n";this.d=i;this.j=t;this.o=_Ewa.a.b("OfficeVSO:3862029_NarratorAnnounceEntry");u=String.format(u,"ewaboot_presenceheads",_Ewa.u.a(3),"ewaother_PlaceContacts_16x16x32",_Ewa.u.a(3),"ewaother_ClosePaneGlyph_16x16x32",_Ewa.u.a(3),this.d.a(752));this.cr().innerHTML=u;this.e=_Ewa.b.a(n,"notificationBody");this.b=_Ewa.b.a(n,"notificationText");this.f=_Ewa.b.a(n,"notificationImage");this.c=_Ewa.b.a(n,"notificationUserImage");this.m=_Ewa.b.a(n,"singleUserImage");this.k=_Ewa.b.a(n,"multiUserImage");_Ewa.b.j(this.b,"alert",null,null,null);this.cz().a("click",this.u,!1);this.i=this.cA.a(this.f);this.i.a("click",this.t,!1);this.q=r};_Ewa.Vv.prototype={e:null,b:null,f:null,c:null,m:null,k:null,i:null,n:null,r:null,s:null,a:null,g:!1,j:null,l:null,q:null,d:null,y:!1,o:!1,dispose:function(){System.a.b([this.i,this.l]);this.e=this.b=this.f=null;this.c=null;_Ewa.beQ.prototype.dispose.call(this)},h:function(n){n?this.set_visible(!0):(this.set_visible(!1),this.z())},D:function(n){this.cr().className=n?"ewa-popup-rtl ewa-new-user-notification":"ewa-popup-ltr ewa-new-user-notification";this.cr().dir=n?"rtl":"ltr";n?(this.e.insertBefore(this.b,this.c),this.e.insertBefore(this.f,this.b),this.c.style.marginLeft="10px"):(this.e.insertBefore(this.c,this.b),this.e.insertBefore(this.b,this.f),this.c.style.marginRight="10px")},p:function(n,t){var i;if(n&&n.length){var e=!this.n,r=new($$sc.w.$$(Boolean)),u=new($$sc.w.$$(Boolean)),f=new($$sc.w.$$(Boolean));for(i=0;i<n.length;i++)e?this.w(n[i].User.UserID):this.n.c(n[i].User.UserID)||(this.w(n[i].User.UserID),this.F(n[i],t)&&this.E(n[i])),r.a(n[i].User.UserID,!0),n[i].UserEmail&&u.a(n[i].UserEmail,!0),n[i].User.UserName&&f.a(n[i].User.UserName,!0);this.n=r;this.r=u;this.s=f}},F:function(n,t){return t?(Diag.a.a(37261332,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - UserEmailAvailable: [{0}], UserNameAvailable: [{1}]",!!n.UserEmail,!!n.User.UserName),n.User.UserName&&this.s.c(n.User.UserName))?(Diag.a.a(37261333,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - Notified: [false], Reason: [UserNameKnown]"),!1):n.UserEmail&&this.r.c(n.UserEmail)?(n.UserEmail.length||Diag.a.a(37261334,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - UserEmail is empty"),Diag.a.a(37261335,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - Notified: [false], Reason: [UserEmailKnown]"),!1):(Diag.a.a(37261336,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - Notified: [true], Reason: [UserEmailAndNameNotKnown]"),!0):(Diag.a.a(37261331,0,50,"NewUserNotificationDialog.ShouldNotifyNewUser - Notified: [true], Reason: [DedupDisabled]"),!0)},w:function(n){var t={};t.a=this.q;t.b=n;t.c="JoiningUser";t.d=_Ewa.s.a().a();_Ewa.E.a().a(23,t,!0)},E:function(n){if(this.a){var t=!_Ewa.f.g(this.a.User.UserID,n.User.UserID,!1);t||this.g||(this.g=!0,this.x())}else this.a=n,this.x()},x:function(){var n="",t;if(!this.y){this.g?n=this.d.a(751):this.a&&(n=String.format(this.d.c(6),this.a.User.UserName));n!==""&&this.o&&(t=this,_Ewa.g.a(_Ewa.l.b(_Ewa.cA,this.j.a(),211,212,0,null),function(t){var i=t.a();i.b(!0);i.a(n)},this.j.g(),3,null,null));return}this.g?(n=this.d.a(751),this.c.style.backgroundColor="",_Ewa.b.b(this.m,!1,!0),_Ewa.b.b(this.k,!0,!0)):this.a&&(n=String.format(this.d.c(6),this.a.User.UserName),this.c.style.backgroundColor=this.a.UserColor,_Ewa.b.b(this.m,!0,!0),_Ewa.b.b(this.k,!1,!0));this.b.innerText=n;System.a.a(this.l);this.l=_Ewa.B.a().a(this.v,5e3,_Ewa.o.cw,!0,!1);this.h(!0)},z:function(){this.a=null;this.g=!1},C:function(){this.h(!1)},B:function(n){this.h(!1);_Ewa.J.a(n,!0)},A:function(n){this.h(!1);_Ewa.J.a(n,!0)}};_Ewa.kb=function(n,t,i,r,u,f,e,o){var c,s,l,h;if(this.r=Function.createDelegate(this,this.Q),this.q=Function.createDelegate(this,this.P),_Ewa.kb.initializeBase(this,[n,f,e,o]),this.c=t,this.t=i,this.s=r,this.u=u,this.c.b().P(this.q),this.c.F(this.r),c=document.createElement("div"),_Ewa.c.a(this.c).H().appendChild(c),this.e=new _Ewa.Vv(c,this.c,u,this.c.e().UserSessionId),this.e.h(!1),this.e.D(this.c.t()),s=this.c.b().u(),this.t.i())for(l=s.length,h=0;h<l;h++)if(s[h].User.UserID===t.k().ClientId){this.e.p([s[h]],!0);break}this.e.p(s,!0);this.v=_Ewa.a.b("OfficeVSO:3552310_NoRefreshOnDisposedPeopleWell")};_Ewa.kb.a=function(n){var i=null,t;return n&&(t=n.SelectedRange,i=t&&t.length>0?t[0]:null),i};_Ewa.kb.prototype={e:null,s:null,t:null,u:null,c:null,w:!1,v:!0,dispose:function(){var n=this.c;n&&(n.b().R(this.q),n.H(this.r),this.d.c([]),this.x(),n.h().u(46),_Ewa.sD.a(n));RealtimePresenceUI.b.prototype.dispose.call(this);this.w=!0},J:function(n){return this.bh(n)},K:function(n){return this.bm(n)},I:function(n){return this.bg(n)},E:function(){return this.g?this.g.a():[]},H:function(){},G:function(n,t){var i=_Ewa.kb.a(t),r,u;i&&(r=i.SheetName,r&&(u=_Ewa.h.b(i),this.c.d().p(this.c.d().b(r)),_Ewa.c.a(this.c).J(u,3,_Ewa.F.E,!1,null)))},A:function(n,t){var i=_Ewa.kb.a(t);return!!i&&!i.NamedObjectName},C:function(n,t,i){var o=i,f=_Ewa.kb.a(o),u,l,g,e,a,v,y,tt;if(!f)return"";var r="",p=f.SheetName,h=$$as(_Ewa.N,this.c.i()),w=!h||p!==h.N;w&&(r=String.format("{0}",p));var b="!",k=w?b.toString():"",s=!1;try{if(!(o.Version===1)&&o.Object){for(var d=o.Object,it=d.length,c=0;c<it;++c)if(u=d[c],l=this.O(u),this.M(u)||this.L(u)||l){if(g=this.c.n(),e=g.bv(u.ObjectId),e){r=h&&h.N!==e.P?String.format("{0}{1}",e.P,b):"";r+=l?e.O.toString():e.N;s=!0;break}}else if(this.N(u)&&(a=_Ewa.T.a(this.c).o(u.ObjectId),a)){r=a.a().l;s=!0;break}Diag.a.a(25031572,0,50,"PresenceObject")}!s&&f.NamedObjectName&&o.Version===1&&(v=_Ewa.T.a(this.c).a(f.NamedObjectName,null),v&&(r+=k+v.a().l,s=!0));s||f.NamedObjectName||(y=_Ewa.h.b(f),y.v()&&(r+=k+y))}catch(nt){Diag.a.a(25031575,0,10,'{{"ConvertUserPresenceToStatusString Exception":"{0}"}',nt.stack);throw nt;}return tt=this.u.a(1239),String.format("{0} {1}",tt,r)},x:function(){if(this.v&&this.w){Diag.a.a(50665499,0,50,"EwaPeoplesWellControl.RefreshControlViewImpl: skipping since instance is already disposed.");return}if(_Ewa.n.a()){var n=_Ewa.bP.a(this.c);n&&n.a()&&n.a().l()}else this.s.k(this.b.a.f,!0)},P:function(){var n,r;Diag.a.a(23643289,0,50,"EwaPeoplesWellControl::OnUserListUpdated");this.j();this.e.p(this.c.b().u(),!0);n="";for(var i=this.c.b().u(),u=i.length,t=0;t<u;++t)r=i[t],n+=r.User.UserID+";";_Ewa.f.d(n)||Diag.a.a(25049093,0,50,"EwaPeoplesWellControl.OnUserListUpdated: UserList updated [{0}].",n)},Q:function(){this.c.a().e(Sys.IDisposable,45,null)},M:function(n){return!!n&&!!n.ObjectId&&n.ObjectType===this.n(1)},L:function(n){return!!n&&!!n.ObjectId&&n.ObjectType===this.n(0)},O:function(n){return!!n&&!!n.ObjectId&&n.ObjectType===this.n(2)},N:function(n){return!!n&&!!n.ObjectId&&n.ObjectType===this.n(9)},n:function(n){switch(n){case 0:return 0;case 1:return 1;case 2:return 3;case 9:return 2;default:return-1}}};_Ewa.Vu=function(n,t){this.a=n;this.b=t};_Ewa.Vu.prototype={a:null,b:null,B:function(){return!1},z:function(n,t,i){var u=this.b.b,f=null,r=t.a,e;return Diag.a.a(23643291,0,50,"EwaPeoplesWellControlHandler::ExecuteCommand: {0}",r),r===u.a.b?(e=this,f=_Ewa.g.a($$sc.a.b(0),function(){e.b.bj()},this.a.g(),3,null,null)):r===u.a.d?this.b.J(i):r===u.a.c?this.A(n,"PopulatePeoplesWellControl",i):r===u.a.e?this.b.K(i):r===u.a.g?this.b.j():f=_Ewa.V.a(r),f||$$sc.a.a(Boolean,!0)},y:function(n,t,i){var r=this.b.b,f=!1,u=t.a;return u===r.a.b||u===r.a.g?f=!0:(u===r.a.d||u===r.a.c||u===r.a.e)&&(f=!!i),f},A:function(n,t,i){if(t==="PopulatePeoplesWellControl"){if(this.b.I(i),_Ewa.a.b("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&this.a.b()&&this.a.b().Y()){var r=(new Date).getTime(),u=this;_Ewa.g.a(_Ewa.l.b(_Ewa.fB,this.a.a(),435,436,1,null),function(n){var t=n.a();t.b(r)},this.a.g(),3,null,null)}return!0}return!1},dispose:function(){this.a&&this.a.h()&&this.a.h().h(this);this.a=null}};_Ewa.sD=function(n){this.v=Function.createDelegate(this,this.z);this.s=Function.createDelegate(this,this.y);_Ewa.sD.initializeBase(this,[n])};_Ewa.sD.a=function(n){_Ewa.bg.a(46,new _Ewa.sD(n))};_Ewa.sD.prototype={t:!1,r:null,p:null,dispose:function(){this.p&&this.p.d(this.s);this.t=!1;this.r=null;this.p=null;var n=this.i;n&&n.D(this.v);_Ewa.bg.prototype.dispose.call(this)},m:function(){Diag.a.a(23643293,0,50,"PeoplesWellCommandHandlerFactory::CreateCommandHandlersAsync. SessionAction: {0}, EditMode {1}",this.i.b().a(),this.i.j());this.i.b().a()&&this.i.j()?this.w():this.i.C(this.v)},z:function(n,t){t.a||this.w()},y:function(){var t,r,f;Diag.a.a(38410441,0,50,"PeoplesWellCommandHandlerFactory::OnRealTimeChannelInitialized");this.p.d(this.s);var u=this.r.s(_Ewa.u.a(3),"ewaboot_presenceheads",_Ewa.u.a(3),"ewaboot_presenceheads32",_Ewa.u.a(3),"ewaboot_presenceheadswhite"),i=$$as(AppRealtimeChannel.d,this.p.j()),n=this;Common.Utils.a.a().c(_Ewa.kb,null).c(Common.ei,null).a().b(function(){var t=i,r=i;return new _Ewa.kb(RealtimePresenceUI.a.a(u,n.i.k().ClientId,t.c||(t.c=Function.createDelegate(t,t.n)),r.d||(r.d=Function.createDelegate(r,r.o)),!0),n.i,n.p,n.r,_Ewa.ClientStringManager.a(),Common.Utils.a.a().a(Common.App.People.b,null),Common.Utils.b.a(Common.cd,Common.Utils.a.a().b(Common.cd,null)),Common.Utils.b.a(Common.App.SkypeChat.a,Common.Utils.a.a().b(Common.App.SkypeChat.a,null)))});t=Common.Utils.a.a().a(Common.ei,null);this.i.a().b(Sys.IDisposable,45,t);_Ewa.a.b("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&(r=(new Date).getTime(),f=this,_Ewa.g.a(_Ewa.l.b(_Ewa.fB,this.i.a(),435,436,1,null),function(n){var t=n.a();t.a(r)},this.i.g(),3,null,null));this.n([new _Ewa.Vu(this.i,t)],null)},w:function(){Diag.a.a(23643294,0,50,"PeoplesWellCommandHandlerFactory::InitPeoplesWellControl");var t=this.i.a(),n=this;t.c(_Ewa.kg,26,function(i){t.c(_Ewa.cb,53,function(r){_Ewa.g.a(_Ewa.l.a(Object,t,155,n.h(),n.j,null),function(){n.p=i;n.r=r;n.x()},n.h(),3,null,null)},null)},null)},x:function(){this.t||(Diag.a.a(50469021,0,50,"PeoplesWellCommandHandlerFactory::CreatePeoplesWellControl - attach RealTimeChannelInitialized handler"),this.p.h(this.s),this.t=!0);Diag.a.a(50469022,0,50,"PeoplesWellCommandHandlerFactory::CreatePeoplesWellControl - check connection");this.p.a()}};_Ewa.Vv.registerClass("_Ewa.Vv",_Ewa.beQ);_Ewa.kb.registerClass("_Ewa.kb",RealtimePresenceUI.b);_Ewa.Vu.registerClass("_Ewa.Vu",null,_Ewa.lr,Sys.IDisposable);_Ewa.sD.registerClass("_Ewa.sD",_Ewa.bg);Type.registerNamespace("_Ewa");_Ewa.bnz=function(){};_Ewa.bnz.a=function(){_Ewa.m.a(_Ewa.sD.a)};_Ewa.bnz.a();Type.registerNamespace("_Ewa");_Ewa.Wz=function(n){this.d=n};_Ewa.Wz.prototype={d:null,a:function(n){return n},b:function(n){return _Ewa.lF.a(this.d.c().a(),n.b,n.a,n.c,null,null,null,null)},c:function(n,t){if(!t)return n;if(!n)return Diag.a.b(39913247,0,!!n,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),t;if(t.b!==n.b)return Diag.a.a(39913248,0,15,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Found nonidentical OcsSessionIds. newActionParameter.SeqNum: {0}, aggregatedActionParameter.seqNum: {1}",n.a,t.a),n.a<t.a?n:t;var i=n.a>t.a?n.a:t.a;return new _Ewa.Bb(n.b,i,n.c)}};_Ewa.WA=function(n){this.d=n};_Ewa.WA.prototype={d:null,a:function(n){return n},b:function(n){return _Ewa.lF.b(this.d.c().a(),n.b,n.a,n.c,null,null,null,null)},c:function(n,t){return t?n?(n.a=!!(n.a&t.a),n):(Diag.a.b(40195267,0,!1,"CheckPersistedActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),t):n}};_Ewa.Bb=function(n,t,i){this.b=n;this.a=t;this.c=i};_Ewa.Bb.prototype={b:null,a:0,c:null};_Ewa.WC=function(n,t,i,r,u){this.m=Function.createDelegate(this,this.z);this.n=Function.createDelegate(this,this.D);this.q=Function.createDelegate(this,this.B);this.p=Function.createDelegate(this,this.A);this.r=Function.createDelegate(this,this.E);_Ewa.WC.initializeBase(this,[!1]);this.i=n;this.k=t;this.i.c().d(this.r);this.k.b(this.p);this.k.g(this.q);this.t=i;this.u=r;this.v=u;this.k.a()};_Ewa.WC.prototype={j:null,i:null,k:null,o:!1,t:null,u:null,v:null,e:function(n){this.er("ekcrmrrg",n)},g:function(n){this.es("ekcrmrrg",n)},a:function(n){this.er("ekcrmmcu",n)},c:function(n){this.es("ekcrmmcu",n)},d:function(n){this.er("LabelUpdateEventKey",n)},f:function(n){this.es("LabelUpdateEventKey",n)},s:null,b:function(){return this.s},y:function(){return!!this.j&&this.j.g()===2},h:function(n,t){this.i.b().a()&&(Diag.a.a(39150978,0,50,"ContentRefreshManager.UpdatePresenceUsers: clientIdsToAdd=[{0}] clientIdsToRemove=[{1}]",n?n.join(","):"null",t?t.join(","):"null"),this.v.a(new _Ewa.WG(n,t,null)))},dispose:function(){this.j&&this.j.j(this.n);this.i&&this.i.c().e(this.r);this.k&&(this.k.c(this.p),this.k.k(this.q));this.j=null;this.i=null;_Ewa.bX.prototype.dispose.call(this)},G:function(n){this.j&&this.j.j(this.n);this.j=$$as(AppRealtimeChannel.d,n);this.j.a(this.n)},D:function(n,t){var f,i,s,a,v,y,p,r,h,c,w,b,k,d,e,g,nt,tt,it,o,u,l,rt,ut,ft,et,ot,st,ht,ct;if(this.o=!0,t.a===1){f=$$as(Array,t.b);(!f||this.F(f))&&this.h(f,null);return}if(i=$$as(Object,t.b),i)if(t.a)if(t.a===3){if(_Ewa.a.b("OfficeVSO:4222155_IgnoreKnownUnhandledRtcMessages")){if(!("PresenceType"in i)){Diag.a.a(590751315,13,10,"RTC WetContentUpdate does not specify a type. Ignoring this update.");return}if(r=i.PresenceType,r!==2){r===5||r===6||r===7||r===8||r===9||Diag.a.a(590751313,13,50,"RTC WetContentUpdate of unknown type {0}. Ignoring this update.",r);return}}if(!("GeneratedXluid"in i)||!("CollabMode"in i)||!("ClientType"in i)){Diag.a.a(40154954,13,10,"RTC WetContentUpdate is missing some critical fields. Ignoring this update.");return}if(h=i.ClientType,h!==1||"sessionSiteIdentifier"in i&&"CommandTimeInMs"in i||Diag.a.a(40182808,13,10,"RTC WetContentUpdate was sent from ECS and is missing some expected fields. Has SessionSiteIdentifier: {0}, Has UserOperationTimeInMs: {1}.","sessionSiteIdentifier"in i,"CommandTimeInMs"in i),k=(b=this.l(i,w={val:c}),c=w.val,b),k)return;d=new _Ewa.WE(i.GeneratedXluid,i.CollabMode,h,c,"CommandTimeInMs"in i?i.CommandTimeInMs:0);this.ep("ekcrmrrg",d,this)}else if(t.a===4){if(e=!1,"OnBehalfOfOcs"in i&&(e=i.OnBehalfOfOcs),it=(tt=this.l(i,nt={val:g}),g=nt.val,tt),it)return;if(this.i.b().cs()&&this.x(),this.i.b().T()&&e)return;o=i.Id;!this.i.b().a()||!o||!o.length||this.u.a(new _Ewa.WD(o,e,this.m))}else t.a===8&&(u=i.SessionId,l=i.SeqNum,!this.i.b().a()||!u||!u.length||(_Ewa.a.a(555)?_Ewa.lF.a(this.i.c().a(),u,l,this.m,null,null,null,null):this.t.a(new _Ewa.Bb(u,l,this.m))));else y=(v=this.l(i,a={val:s}),s=a.val,v),y?(this.C(i),"latestStateId"in i&&(p=i.latestStateId,this.i.b().O(p,"ContentRefreshManager.OnUpdateNotificationReceived"),this.w())):Diag.a.a(22905367,0,50,"RTC ContentUpdate session identifier mismatch. Received: {0}. Expected: {1}. Ignoring this update.",s,this.i.b().bt());if(t.a===2){if(i&&(et=(ft=this.l(i,ut={val:rt}),rt=ut.val,ft),et))return;Diag.a.a(42267869,0,50,"RTC : FileNameUpdate received. Now invoking CheckWorkbookFileNameUpdate web method");_Ewa.lF.c(this.i.c().a(),null,null,null,null,null)}else if(_Ewa.a.a(619)&&t.a===12){if(i&&(ct=(ht=this.l(i,st={val:ot}),ot=st.val,ht),ct))return;this.ep("LabelUpdateEventKey",null,null)}},l:function(n,t){t.val="sessionSiteIdentifier"in n?n.sessionSiteIdentifier:null;var i=this.i.b().bt();return i===t.val},z:function(n){var t=n.Errors,i,r;_Ewa.j.e(t)?(t=_Ewa.j.f(t,[1552731907],"ContentRefreshManager"),_Ewa.j.h(t)||this.i.b().p(t)):(i=n.Result,r=n.StateId+1,i&&this.i.b().c()<r&&this.i.b().O(-1,"ContentRefreshManager.OnCheckForUpdateSuccess"))},E:function(){this.y()&&this.o&&this.i.b().bC()&&this.w()},w:function(){this.i.b().bT(Math.max(3e4,this.i.b().bK()))},B:function(){this.o=!1;this.i.b().bT(500);this.s=_Ewa.s.a().a()},A:function(n,t){this.G(t.a)},F:function(n){for(var r,u,i=n,f=i.length,t=0;t<f;++t)if(r=i[t],u=this.i.b().bN(r),!u)return!0;return!1},x:function(){this.i.w(1562177611,-1,0,null)},C:function(n){if("MrgCur"in n&&"MrgNxt"in n){var t,i=(t=new _Ewa.qg,t.Pending=n.MrgNxt,t.Current=n.MrgCur,t.SuspensionStartTimestamp="MrgSusStart"in n?n.MrgSusStart:null,t);this.ep("ekcrmmcu",new _Ewa.Bc(i),this)}}};_Ewa.WD=function(n,t,i){this.b=n;this.a=t;this.c=i};_Ewa.WD.prototype={b:null,a:!1,c:null};_Ewa.WF=function(n){this.d=n};_Ewa.WF.prototype={d:null,a:function(n){return n+5e3},b:function(n){if(!this.d.b().a())return $$sc.a.a(Boolean,!0);var t=this,i=this;return _Ewa.g.ts(_Ewa.g.ts($$sc.a.b(0),function(){return _Ewa.lF.d(t.d.c().a(),n.e(),n.f(),n.d,null,null,null,null)},$$sc.f.a,0,$$sc.c.a),function(){return $$sc.a.b(5e3)},$$sc.f.a,0,$$sc.c.a)},c:function(n,t){return t?n?t.g()?t:n.g()?n:(t.h(n),t):(Diag.a.b(578339170,0,!1,"UpdatePresenceUsersActionAggregationPerformer.AggregateActionParameters: Received null newActionParameter"),t):n}};_Ewa.WG=function(n,t,i){this.b={};this.c={};this.d=i;this.a(n,this.b);this.a(t,this.c)};_Ewa.WG.prototype={e:function(){return $$sc.j.a(this.b)},f:function(){return $$sc.j.a(this.c)},d:null,g:function(){return!this.e().length&&!this.f().length},h:function(n){this.a(n.e(),this.b);this.a(n.f(),this.c)},a:function(n,t){var u;if(n)for(var r=n,f=r.length,i=0;i<f;++i)u=r[i],t[u]=!0}};_Ewa.WB=function(n){var i,r,t;this.y=Function.createDelegate(this,this.K);this.s=Function.createDelegate(this,this.H);this.q=Function.createDelegate(this,this.F);this.r=Function.createDelegate(this,this.G);this.u=Function.createDelegate(this,this.J);this.p=Function.createDelegate(this,this.A);this.t=Function.createDelegate(this,this.I);this.v=Function.createDelegate(this,this.C);this.z=Function.createDelegate(this,this.P);_Ewa.WB.initializeBase(this,[!1]);this.a=n;this.i=_Ewa.c.a(this.a).b();this.j=_Ewa.c.a(this.a).i();this.d=this.a.a().a(_Ewa.hT,292,!1,null);this.g=this.a.T();this.c=new($$sc.v.$$(_Ewa.ue));this.b=new($$sc.s.$$(_Ewa.nT));i=_Ewa.a.a(310)?1e3:3e4;this.f=_Ewa.B.a().b(this.z,i,_Ewa.o.L,!1,!1);this.a.C(this.v);this.a.b().h(this.t);this.a.b().bl(this.p);r=this;this.a.a().c(_Ewa.dC,291,function(n){r.h=n},null);t=this;this.a.a().c(_Ewa.jU,343,function(n){t.w||(t.e=n,t.e.a(t.u),t.e.c())},null);Diag.a.a(571798802,13,50,"ContentLatencyTracker initialized");this.C(this.a,null)};_Ewa.WB.prototype={a:null,i:null,j:null,d:null,g:null,h:null,e:null,k:!1,o:null,f:null,w:!1,n:!1,l:!1,m:!1,c:null,b:null,dispose:function(){this.w=!0;this.f&&(this.f.dispose(),this.f=null);this.d&&(this.D(),this.d=null);this.i&&(this.x(),this.i=null);this.j&&(this.x(),this.j=null);this.g&&(this.g=null);this.a&&(this.a.D(this.v),this.a.b().i(this.t),this.a.b().bQ(this.p),this.a=null);this.e&&(this.e.d(this.u),this.e=null);_Ewa.bhG.prototype.dispose.call(this)},J:function(n,t){this.k!==t.a&&(this.k=t.a,this.o=this.k?null:_Ewa.s.a().a())},C:function(){this.a.j()&&this.N()},I:function(n,t){t.d||this.A(n,t)},A:function(){(this.c.f.length>0||this.b.f>0)&&(Diag.a.a(40154958,13,15,"Dropping {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",this.c.f.length,this.b.f),this.c.h(),this.b=new($$sc.s.$$(_Ewa.nT)));this.f.a();this.D();this.x();this.O()},G:function(n,t){this.L();this.M();var i=new _Ewa.ue;i.Xluid=t.e;i.NotificationReceivedOn=_Ewa.s.a().a().toISOString();i.CurrentPresenceUserCount=this.a.b().u().length;i.OurCollabModeIsUsingOcs=this.a.b().T();i.SenderCollabMode=t.c;i.SenderClientType=t.b;i.SessionSiteIdentifier=t.d;i.CommandTimeInMs=t.a;Diag.a.a(40154959,13,50,"ContentLatencyTracker.OnRemoteRevisionGenerated: RevisionGeneratedNotification: {0}",JSON.stringify(i));this.c.b(i)},N:function(){this.n||(this.d.e(this.r),this.n=!0,this.f.b(-1))},D:function(){this.n&&(this.d.g(this.r),this.n=!1)},L:function(){this.l||(this.i.c(this.q),this.l=!0)},x:function(){this.l&&(this.i.d(this.q),this.l=!1)},M:function(){this.m||(this.j.j(this.s),this.m=!0)},O:function(){this.m&&(this.j.n(this.s),this.m=!1)},F:function(){var n=this.a.b().c();this.B(n,"OnBlockCacheConsistent")},H:function(n,t){var i=$$as(_Ewa.kV,t.a),r;i&&(r=i.p(),this.B(r,"OnRenderedContent"))},B:function(n,t){if(n!==-1&&!this.b.c(n)){var u=_Ewa.s.a().a().toISOString(),i,r=(i=new _Ewa.nT,i.StateId=n,i.DownloadedOn=u,i.IsHidden=this.h?this.h.a():window.document.visibilityState!=="visible",i.DocumentLastUnhidden=this.h&&this.h.h()?this.h.h().toISOString():null,i.LastLostRtcConnection=this.d&&this.d.b()?this.d.b().toISOString():null,i.LastOffline=this.g&&this.g.b()?this.g.b().toISOString():null,i);this.e&&(r.IsPendingMergeBlockedByClient=this.k,this.o&&(r.PendingMergeBlockedByClientLastEnded=this.o.toISOString()));Diag.a.a(41685216,13,50,"ContentLatencyTracker.CreateAndAddstateDownloadedNotifications: {0} - StateDownloadedNotification: {1}",t,JSON.stringify(r));this.b.d(n,r)}},P:function(){var t,n,r,i,u;if(!this.a.b().a()){Diag.a.a(571245763,13,15,"ContentLatencyTracker.UploadLatencyTelemetryPeriodically: session isn't active");return}if(this.c.f.length||this.b.f){if(t=null,this.c.f.length>0&&(t=this.c.g(),this.c.h()),n=null,this.b.f>0){for(n=new Array(this.b.f),r=0,i=this.b.l().$$ge();i.$$mn();)u=i.$$cu(),n[r++]=u;this.b=new($$sc.s.$$(_Ewa.nT))}Diag.a.a(40154963,13,100,"ContentLatencyTracker.UploadLatencyTelemetryPeriodically: Uploading {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",t?t.length:0,n?n.length:0);_Ewa.lF.e(this.a.c().a(),t,n,this.y,null,null,null,null)}},K:function(n){if(n.Result){var t=n.Result;t>0&&this.E()}},E:function(){Common.a.f&&(Common.a.f.HasReceivedInboundReplications=!0)}};_Ewa.bow=function(){};_Ewa.bow.a=function(){_Ewa.m.a(function(n){_Ewa.g.a(_Ewa.l.a(_Ewa.dh,n.a(),12,n.g(),0,null),function(t){var i=t,r=new _Ewa.Wz(n),u=n.a().a(_Ewa.dC,291,!1,null),f=i.a().b(r,r,u,"collabService"),e=new _Ewa.WA(n),o=i.a().b(e,e,u,"persisted"),s=new _Ewa.WF(n),h=i.a().b(s,s,null,"updatePresence");n.a().b(_Ewa.hT,292,new _Ewa.WC(n,n.a().a(_Ewa.kg,26,!1,null),f,o,h));_Ewa.fa.a(n.a()).a(new _Ewa.WB(n));_Ewa.fa.a(n.a()).a(f);_Ewa.fa.a(n.a()).a(o)},n.g(),3,null,null)})};_Ewa.lF=function(){};_Ewa.lF.b=function(n,t,i,r,u,f,e,o){var s=n.a(1,o);return s.Id=t,s.OnBehalfOfOcs=i,_Ewa.k.a(n,"CheckPersistedContentUpdate",s,r,u,f,e,516,null,null)};_Ewa.lF.a=function(n,t,i,r,u,f,e,o){var s=n.a(1,o);return s.OcsSessionId=t,s.SeqNum=i,_Ewa.k.a(n,"CheckCollabServiceContentUpdate",s,r,u,f,e,516,null,null)};_Ewa.lF.d=function(n,t,i,r,u,f,e,o){var s=n.a(1,o);return s.clientIdsToAdd=t,s.clientIdsToRemove=i,_Ewa.k.a(n,"UpdatePresenceUsers",s,r,u,f,e,0,null,null)};_Ewa.lF.c=function(n,t,i,r,u,f){var e=n.a(1,f);return _Ewa.k.a(n,"CheckWorkbookFileNameUpdate",e,t,i,r,u,0,null,null)};_Ewa.lF.e=function(n,t,i,r,u,f,e,o){var s=n.a(1,o);return s.GenerateNotifications=t,s.DownloadNotifications=i,_Ewa.k.a(n,"UploadLatencyTelemetry",s,r,u,f,e,128,null,null)};_Ewa.WC.registerClass("_Ewa.WC",_Ewa.bX,_Ewa.hT);_Ewa.WB.registerClass("_Ewa.WB",_Ewa.bhG);_Ewa.bow.a();